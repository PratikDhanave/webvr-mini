!function(t){function e(a){if(r[a])return r[a].exports;var n=r[a]={exports:{},id:a,loaded:!1};return t[a].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){r(32),t.exports=r(4)},function(t,e){var r={};r.EPSILON=1e-6,r.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,r.RANDOM=Math.random,r.ENABLE_SIMD=!1,r.SIMD_AVAILABLE=r.ARRAY_TYPE===Float32Array&&"SIMD"in this,r.USE_SIMD=r.ENABLE_SIMD&&r.SIMD_AVAILABLE,r.setMatrixArrayType=function(t){r.ARRAY_TYPE=t};var a=Math.PI/180;r.toRadian=function(t){return t*a},r.equals=function(t,e){return Math.abs(t-e)<=r.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},t.exports=r},function(t,e){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),n=function(){function t(e,a,n,o,i){r(this,t),console.log("in LoadPool class"),this.util=a,this.webgl=o,this.glMatrix=n,this.MAX_CACHE=i,this.loadCache=new Array(i),this.waitCache=[],this.waitCt=0,this.loadCt=0,this.ready=!1}return a(t,[{key:"createWaitObj",value:function(t,e,r){this.loadCt++,this.waitCache.push({source:t,attach:e,callback:r})}},{key:"update",value:function(t){var e=this.waitCache,r=e.length;if(r<1)return console.log("all assets loaded for:"+t.prim.name),void(this.ready=!0);this.ready=!1;var a=0,n=this.loadCache,o=n.length,i=e[0];if(t&&t.busy===!1)t.prim=i.attach,t.image.src=i.source,e.shift();else for(a;a<o;a++)if(!n[a]){n[a]=this.createLoadObj(i),e.shift();break}}},{key:"load",value:function(t,e,r,a){this.createWaitObj(t,e,r),this.update()}}]),t}();e.default=n},function(t,e){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),n=function(){function t(e,a,n,o,i){r(this,t),console.log("In Shader class"),this.webgl=o,this.util=a,this.prim=i,this.glMatrix=n,this.pMatrix=this.glMatrix.mat4.create(),this.mvMatrix=this.glMatrix.mat4.create(),this.mvMatrixStack=this.glMatrix.mat4.create(),this.floatp="",this.webgl.stats.highp?this.floatp="precision highp float;":this.floatp="precision mediump float;",this.vertexShaderFile=null,this.fragmentShaderFile=null}return a(t,[{key:"mvPushMatrix",value:function(){var t=this.glMatrix.mat4,e=t.create();t.set(this.mvMatrix,e),mvMatrixStack.push(e)}},{key:"mvPopMatrix",value:function(){if(0==this.mvMatrixStack.length)throw"Invalid popMatrix!";mvMatrix=this.mvMatrixStack.pop()}},{key:"setup",value:function(){var t=null;return t=this.vertexShaderFile&&this.this.fragmentShaderFile?this.webgl.createProgram(this.webgl.fetchVertexShader(this.vertexShaderFile),this.webgl.fetchFragmentShader(this.fragmentShaderFile)):this.webgl.createProgram(this.vsSrc(),this.fsSrc()),[this.webgl.getContext(),this.webgl.getCanvas(),this.glMatrix.mat4,this.glMatrix.mat3,this.glMatrix.vec3,this.glMatrix.mat4.create(),this.glMatrix.mat4.create(),t,{attribute:this.webgl.setAttributeArrays(t.shaderProgram,t.vsVars.attribute),uniform:this.webgl.setUniformLocations(t.shaderProgram,t.vsVars.uniform)},{uniform:this.webgl.setUniformLocations(t.shaderProgram,t.fsVars.uniform)}]}}]),t}();e.default=n},function(t,e,r){(function(t){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.world=e.webvr=e.prim=e.loadVideo=e.loadAudio=e.loadTexture=e.loadModel=e.webgl=e.util=void 0;var n=r(22),o=a(n),i=r(23),u=a(i),s=r(24),l=a(s),c=r(12),f=a(c),h=r(11),d=a(h),m=r(9),M=a(m),g=r(13),v=a(g),x=r(10),p=a(x),b=r(20),y=a(b),S=r(17),I=a(S),D=r(18),w=a(D),E=r(21),T=(a(E),r(19)),F=(a(T),r(16)),R=a(F),P=r(15),A=a(P),_=r(25),O=a(_);console.log("in es6");var L=(t.env.WEBPACK_ENV,r(26));L?console.log("loaded gl-matrix"):console.error("gl-matrix could'nt be loaded...");var C=new o.default,V=null;e.webgl=V=new u.default(!1,L,C);var k=new l.default(!1,C,L,V),z=new d.default(!0,C,L,V),N=new f.default(!0,C,L,V),B=new M.default(!0,C,L,V),j=new v.default(!0,C,L,V),U=(new p.default(!0,C,L,V),new A.default(!0,C,L,V,z,N,B,j)),Y=new y.default(!0,C,L,V,U),q=new I.default(!0,C,L,V,U),X=new w.default(!0,C,L,V,U),G=new R.default(!0,C,L,V,Y,q,X),H=new O.default(V,U,G,Y,q);e.util=C,e.webgl=V,e.loadModel=z,e.loadTexture=N,e.loadAudio=B,e.loadVideo=j,e.prim=U,e.webvr=k,e.world=H}).call(e,r(8))},function(t,e,r){var a=r(1),n={};n.create=function(){var t=new a.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},n.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},n.clone=function(t){var e=new a.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},n.fromValues=function(t,e,r,n,o,i,u,s,l){var c=new a.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=r,c[3]=n,c[4]=o,c[5]=i,c[6]=u,c[7]=s,c[8]=l,c},n.set=function(t,e,r,a,n,o,i,u,s,l){return t[0]=e,t[1]=r,t[2]=a,t[3]=n,t[4]=o,t[5]=i,t[6]=u,t[7]=s,t[8]=l,t},n.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},n.transpose=function(t,e){if(t===e){var r=e[1],a=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=a,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},n.invert=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],u=e[5],s=e[6],l=e[7],c=e[8],f=c*i-u*l,h=-c*o+u*s,d=l*o-i*s,m=r*f+a*h+n*d;return m?(m=1/m,t[0]=f*m,t[1]=(-c*a+n*l)*m,t[2]=(u*a-n*i)*m,t[3]=h*m,t[4]=(c*r-n*s)*m,t[5]=(-u*r+n*o)*m,t[6]=d*m,t[7]=(-l*r+a*s)*m,t[8]=(i*r-a*o)*m,t):null},n.adjoint=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],u=e[5],s=e[6],l=e[7],c=e[8];return t[0]=i*c-u*l,t[1]=n*l-a*c,t[2]=a*u-n*i,t[3]=u*s-o*c,t[4]=r*c-n*s,t[5]=n*o-r*u,t[6]=o*l-i*s,t[7]=a*s-r*l,t[8]=r*i-a*o,t},n.determinant=function(t){var e=t[0],r=t[1],a=t[2],n=t[3],o=t[4],i=t[5],u=t[6],s=t[7],l=t[8];return e*(l*o-i*s)+r*(-l*n+i*u)+a*(s*n-o*u)},n.multiply=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=e[4],s=e[5],l=e[6],c=e[7],f=e[8],h=r[0],d=r[1],m=r[2],M=r[3],g=r[4],v=r[5],x=r[6],p=r[7],b=r[8];return t[0]=h*a+d*i+m*l,t[1]=h*n+d*u+m*c,t[2]=h*o+d*s+m*f,t[3]=M*a+g*i+v*l,t[4]=M*n+g*u+v*c,t[5]=M*o+g*s+v*f,t[6]=x*a+p*i+b*l,t[7]=x*n+p*u+b*c,t[8]=x*o+p*s+b*f,t},n.mul=n.multiply,n.translate=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=e[4],s=e[5],l=e[6],c=e[7],f=e[8],h=r[0],d=r[1];return t[0]=a,t[1]=n,t[2]=o,t[3]=i,t[4]=u,t[5]=s,t[6]=h*a+d*i+l,t[7]=h*n+d*u+c,t[8]=h*o+d*s+f,t},n.rotate=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=e[4],s=e[5],l=e[6],c=e[7],f=e[8],h=Math.sin(r),d=Math.cos(r);return t[0]=d*a+h*i,t[1]=d*n+h*u,t[2]=d*o+h*s,t[3]=d*i-h*a,t[4]=d*u-h*n,t[5]=d*s-h*o,t[6]=l,t[7]=c,t[8]=f,t},n.scale=function(t,e,r){var a=r[0],n=r[1];return t[0]=a*e[0],t[1]=a*e[1],t[2]=a*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},n.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},n.fromRotation=function(t,e){var r=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=r,t[2]=0,t[3]=-r,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},n.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},n.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},n.fromQuat=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=r+r,u=a+a,s=n+n,l=r*i,c=a*i,f=a*u,h=n*i,d=n*u,m=n*s,M=o*i,g=o*u,v=o*s;return t[0]=1-f-m,t[3]=c-v,t[6]=h+g,t[1]=c+v,t[4]=1-l-m,t[7]=d-M,t[2]=h-g,t[5]=d+M,t[8]=1-l-f,t},n.normalFromMat4=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],u=e[5],s=e[6],l=e[7],c=e[8],f=e[9],h=e[10],d=e[11],m=e[12],M=e[13],g=e[14],v=e[15],x=r*u-a*i,p=r*s-n*i,b=r*l-o*i,y=a*s-n*u,S=a*l-o*u,I=n*l-o*s,D=c*M-f*m,w=c*g-h*m,E=c*v-d*m,T=f*g-h*M,F=f*v-d*M,R=h*v-d*g,P=x*R-p*F+b*T+y*E-S*w+I*D;return P?(P=1/P,t[0]=(u*R-s*F+l*T)*P,t[1]=(s*E-i*R-l*w)*P,t[2]=(i*F-u*E+l*D)*P,t[3]=(n*F-a*R-o*T)*P,t[4]=(r*R-n*E+o*w)*P,t[5]=(a*E-r*F-o*D)*P,t[6]=(M*I-g*S+v*y)*P,t[7]=(g*b-m*I-v*p)*P,t[8]=(m*S-M*b+v*x)*P,t):null},n.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},n.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t},n.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t},n.sub=n.subtract,n.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t},n.multiplyScalarAndAdd=function(t,e,r,a){return t[0]=e[0]+r[0]*a,t[1]=e[1]+r[1]*a,t[2]=e[2]+r[2]*a,t[3]=e[3]+r[3]*a,t[4]=e[4]+r[4]*a,t[5]=e[5]+r[5]*a,t[6]=e[6]+r[6]*a,t[7]=e[7]+r[7]*a,t[8]=e[8]+r[8]*a,t},n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},n.equals=function(t,e){var r=t[0],n=t[1],o=t[2],i=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],h=e[0],d=e[1],m=e[2],M=e[3],g=e[4],v=e[5],x=t[6],p=e[7],b=e[8];return Math.abs(r-h)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(n-d)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(o-m)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(i-M)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(u-g)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(s-v)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(l-x)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(x))&&Math.abs(c-p)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(p))&&Math.abs(f-b)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(b))},t.exports=n},function(t,e,r){var a=r(1),n={};n.create=function(){var t=new a.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},n.clone=function(t){var e=new a.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},n.fromValues=function(t,e,r){var n=new a.ARRAY_TYPE(3);return n[0]=t,n[1]=e,n[2]=r,n},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},n.set=function(t,e,r,a){return t[0]=e,t[1]=r,t[2]=a,t},n.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},n.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t},n.sub=n.subtract,n.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t},n.mul=n.multiply,n.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t},n.div=n.divide,n.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},n.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},n.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},n.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},n.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},n.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},n.scaleAndAdd=function(t,e,r,a){return t[0]=e[0]+r[0]*a,t[1]=e[1]+r[1]*a,t[2]=e[2]+r[2]*a,t},n.distance=function(t,e){var r=e[0]-t[0],a=e[1]-t[1],n=e[2]-t[2];return Math.sqrt(r*r+a*a+n*n)},n.dist=n.distance,n.squaredDistance=function(t,e){var r=e[0]-t[0],a=e[1]-t[1],n=e[2]-t[2];return r*r+a*a+n*n},n.sqrDist=n.squaredDistance,n.length=function(t){var e=t[0],r=t[1],a=t[2];return Math.sqrt(e*e+r*r+a*a)},n.len=n.length,n.squaredLength=function(t){var e=t[0],r=t[1],a=t[2];return e*e+r*r+a*a},n.sqrLen=n.squaredLength,n.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},n.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},n.normalize=function(t,e){var r=e[0],a=e[1],n=e[2],o=r*r+a*a+n*n;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},n.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},n.cross=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=r[0],u=r[1],s=r[2];return t[0]=n*s-o*u,t[1]=o*i-a*s,t[2]=a*u-n*i,t},n.lerp=function(t,e,r,a){var n=e[0],o=e[1],i=e[2];return t[0]=n+a*(r[0]-n),t[1]=o+a*(r[1]-o),t[2]=i+a*(r[2]-i),t},n.hermite=function(t,e,r,a,n,o){var i=o*o,u=i*(2*o-3)+1,s=i*(o-2)+o,l=i*(o-1),c=i*(3-2*o);return t[0]=e[0]*u+r[0]*s+a[0]*l+n[0]*c,t[1]=e[1]*u+r[1]*s+a[1]*l+n[1]*c,t[2]=e[2]*u+r[2]*s+a[2]*l+n[2]*c,t},n.bezier=function(t,e,r,a,n,o){var i=1-o,u=i*i,s=o*o,l=u*i,c=3*o*u,f=3*s*i,h=s*o;return t[0]=e[0]*l+r[0]*c+a[0]*f+n[0]*h,t[1]=e[1]*l+r[1]*c+a[1]*f+n[1]*h,t[2]=e[2]*l+r[2]*c+a[2]*f+n[2]*h,t},n.random=function(t,e){e=e||1;var r=2*a.RANDOM()*Math.PI,n=2*a.RANDOM()-1,o=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*o,t[1]=Math.sin(r)*o,t[2]=n*e,t},n.transformMat4=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=r[3]*a+r[7]*n+r[11]*o+r[15];return i=i||1,t[0]=(r[0]*a+r[4]*n+r[8]*o+r[12])/i,t[1]=(r[1]*a+r[5]*n+r[9]*o+r[13])/i,t[2]=(r[2]*a+r[6]*n+r[10]*o+r[14])/i,t},n.transformMat3=function(t,e,r){var a=e[0],n=e[1],o=e[2];return t[0]=a*r[0]+n*r[3]+o*r[6],t[1]=a*r[1]+n*r[4]+o*r[7],t[2]=a*r[2]+n*r[5]+o*r[8],t},n.transformQuat=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=r[0],u=r[1],s=r[2],l=r[3],c=l*a+u*o-s*n,f=l*n+s*a-i*o,h=l*o+i*n-u*a,d=-i*a-u*n-s*o;return t[0]=c*l+d*-i+f*-s-h*-u,t[1]=f*l+d*-u+h*-i-c*-s,t[2]=h*l+d*-s+c*-u-f*-i,t},n.rotateX=function(t,e,r,a){var n=[],o=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],o[0]=n[0],o[1]=n[1]*Math.cos(a)-n[2]*Math.sin(a),o[2]=n[1]*Math.sin(a)+n[2]*Math.cos(a),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},n.rotateY=function(t,e,r,a){var n=[],o=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],o[0]=n[2]*Math.sin(a)+n[0]*Math.cos(a),o[1]=n[1],o[2]=n[2]*Math.cos(a)-n[0]*Math.sin(a),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},n.rotateZ=function(t,e,r,a){var n=[],o=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],o[0]=n[0]*Math.cos(a)-n[1]*Math.sin(a),o[1]=n[0]*Math.sin(a)+n[1]*Math.cos(a),o[2]=n[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},n.forEach=function(){var t=n.create();return function(e,r,a,n,o,i){var u,s;for(r||(r=3),a||(a=0),s=n?Math.min(n*r+a,e.length):e.length,u=a;u<s;u+=r)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],o(t,t,i),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2];return e}}(),n.angle=function(t,e){var r=n.fromValues(t[0],t[1],t[2]),a=n.fromValues(e[0],e[1],e[2]);n.normalize(r,r),n.normalize(a,a);var o=n.dot(r,a);return o>1?0:Math.acos(o)},n.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},n.equals=function(t,e){var r=t[0],n=t[1],o=t[2],i=e[0],u=e[1],s=e[2];return Math.abs(r-i)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-u)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(o-s)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(s))},t.exports=n},function(t,e,r){var a=r(1),n={};n.create=function(){var t=new a.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},n.clone=function(t){var e=new a.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},n.fromValues=function(t,e,r,n){var o=new a.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=r,o[3]=n,o},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},n.set=function(t,e,r,a,n){return t[0]=e,t[1]=r,t[2]=a,t[3]=n,t},n.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},n.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t},n.sub=n.subtract,n.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t},n.mul=n.multiply,n.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t},n.div=n.divide,n.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},n.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},n.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},n.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},n.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},n.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},n.scaleAndAdd=function(t,e,r,a){return t[0]=e[0]+r[0]*a,t[1]=e[1]+r[1]*a,t[2]=e[2]+r[2]*a,t[3]=e[3]+r[3]*a,t},n.distance=function(t,e){var r=e[0]-t[0],a=e[1]-t[1],n=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(r*r+a*a+n*n+o*o)},n.dist=n.distance,n.squaredDistance=function(t,e){var r=e[0]-t[0],a=e[1]-t[1],n=e[2]-t[2],o=e[3]-t[3];return r*r+a*a+n*n+o*o},n.sqrDist=n.squaredDistance,n.length=function(t){var e=t[0],r=t[1],a=t[2],n=t[3];return Math.sqrt(e*e+r*r+a*a+n*n)},n.len=n.length,n.squaredLength=function(t){var e=t[0],r=t[1],a=t[2],n=t[3];return e*e+r*r+a*a+n*n},n.sqrLen=n.squaredLength,n.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},n.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},n.normalize=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=r*r+a*a+n*n+o*o;return i>0&&(i=1/Math.sqrt(i),t[0]=r*i,t[1]=a*i,t[2]=n*i,t[3]=o*i),t},n.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},n.lerp=function(t,e,r,a){var n=e[0],o=e[1],i=e[2],u=e[3];return t[0]=n+a*(r[0]-n),t[1]=o+a*(r[1]-o),t[2]=i+a*(r[2]-i),t[3]=u+a*(r[3]-u),t},n.random=function(t,e){return e=e||1,t[0]=a.RANDOM(),t[1]=a.RANDOM(),t[2]=a.RANDOM(),t[3]=a.RANDOM(),n.normalize(t,t),n.scale(t,t,e),t},n.transformMat4=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3];return t[0]=r[0]*a+r[4]*n+r[8]*o+r[12]*i,t[1]=r[1]*a+r[5]*n+r[9]*o+r[13]*i,t[2]=r[2]*a+r[6]*n+r[10]*o+r[14]*i,t[3]=r[3]*a+r[7]*n+r[11]*o+r[15]*i,t},n.transformQuat=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=r[0],u=r[1],s=r[2],l=r[3],c=l*a+u*o-s*n,f=l*n+s*a-i*o,h=l*o+i*n-u*a,d=-i*a-u*n-s*o;return t[0]=c*l+d*-i+f*-s-h*-u,t[1]=f*l+d*-u+h*-i-c*-s,t[2]=h*l+d*-s+c*-u-f*-i,t[3]=e[3],t},n.forEach=function(){var t=n.create();return function(e,r,a,n,o,i){var u,s;for(r||(r=4),a||(a=0),s=n?Math.min(n*r+a,e.length):e.length,u=a;u<s;u+=r)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],o(t,t,i),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}(),n.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},n.equals=function(t,e){var r=t[0],n=t[1],o=t[2],i=t[3],u=e[0],s=e[1],l=e[2],c=e[3];return Math.abs(r-u)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-s)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(o-l)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(i-c)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))},t.exports=n},function(t,e){function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function n(t){if(c===setTimeout)return setTimeout(t,0);if((c===r||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function o(t){if(f===clearTimeout)return clearTimeout(t);if((f===a||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(t);try{return f(t)}catch(e){try{return f.call(null,t)}catch(e){return f.call(this,t)}}}function i(){M&&d&&(M=!1,d.length?m=d.concat(m):g=-1,m.length&&u())}function u(){if(!M){var t=n(i);M=!0;for(var e=m.length;e;){for(d=m,m=[];++g<e;)d&&d[g].run();g=-1,e=m.length}d=null,M=!1,o(t)}}function s(t,e){this.fun=t,this.array=e}function l(){}var c,f,h=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:r}catch(t){c=r}try{f="function"==typeof clearTimeout?clearTimeout:a}catch(t){f=a}}();var d,m=[],M=!1,g=-1;h.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];m.push(new s(t,e)),1!==m.length||M||n(u)},s.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=l,h.addListener=l,h.once=l,h.off=l,h.removeListener=l,h.removeAllListeners=l,h.emit=l,h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),s=r(2),l=a(s),c=function(t){function e(t,r,a,i){n(this,e),console.log("in LoadAudio class");var u=3,s=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,a,i,u));return s.audioCtx=new(window.AudioContext||window.webkitAudioContext),s.sources={},s}return i(e,t),u(e,[{key:"uploadAudio",value:function(t,e){var r=t.prim.audio,a={audio:t.audio,src:t.src};r.push(a),t.busy=!1,this.update(t)}},{key:"createLoadObj",value:function(t){loadObj={},loadObj.src=t.source,loadObj.audio=this.audioCtx.createBufferSource();var e=new Request(t.source);fetch(e).then(function(t){if(!t.ok)throw Error(t.statusText);return t.arrayBuffer()}).then(function(t){if(!t)throw Error("no audio arrayBuffer");this.audioCtx.decodeAudioData(t,function(t){loadObj.audio.buffer=t,loadObj.audio.connect(this.audioCtx.destination),this.update(loadObj)})}).catch(function(t){console.error(t)})}}]),e}(l.default);e.default=c},function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=r(2),s=a(u),l=function(t){function e(t,r,a,i){n(this,e),console.log("in LoadFont class");var u=3;return o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,a,i,u))}return i(e,t),e}(s.default);e.default=l},function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),s=r(2),l=a(s),c=function(t){function e(t,r,a,i){return n(this,e),console.log("in LoadModel class"),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,a,i))}return i(e,t),u(e,[{key:"init",value:function(){}},{key:"uploadModel",value:function(t,e){var r,a,n,o,i=Sizzle,u=function(t,e){var r=i("input[semantic="+t+"]",e)[0];return i(r.getAttribute("source"),l)[0]},s=function(t){var e=t.textContent.replace(/^\s\s*/,"").replace(/\s\s*$/,"");return e.split(/\s+/).map(parseFloat)},l=i("geometry > mesh",xml)[0],c=(i("triangles",l)[0],i("polylist",l)[0]),f=u("VERTEX",c),h=u("POSITION",f),d=u("NORMAL",c),m=s(i("float_array",d)[0]),M=s(i("p",c)[0]);for(vertices=s(i("float_array",h)[0]),normals=[],indices=[],r=0;r<M.length;r+=6)for(a=0;a<3;a++)n=M[r+2*a],o=M[r+2*a+1],indices.push(n),normals[3*n]=m[3*o],normals[3*n+1]=m[3*o+1],normals[3*n+2]=m[3*o+2];return{vertices:vertices,indices:indices,normals:normals}}},{key:"createLoadObj",value:function(t){var e={};return e.model={},e.callback=t.callback,e.prim=t.attach,e.busy=!0,fetch(t.source).then(function(t){return t.text()}).then(function(r){return uploadModel(e,t.callback)}).then(function(t){return console.log(t)}),this.cacheCt++,e}}]),e}(l.default);e.default=c},function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),s=r(2),l=a(s),c=function(t){function e(t,r,a,i){n(this,e),console.log("in LoadTexture class");var u=3,s=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,a,i,u));return s.MAX_TIMEOUT=10,s.greyPixel=new Uint8Array([.5,.5,.5,1]),s}return i(e,t),u(e,[{key:"init",value:function(){}},{key:"setDefaultTexturePixel",value:function(t,e,r){var a=this.greyPixel;if(r===t.TEXTURE_CUBE_MAP)for(var n=0;n<6;++n)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,a);else r===t.TEXTURE_3D?t.texImage3D(r,0,t.RGBA,1,1,1,0,t.RGBA,t.UNSIGNED_BYTE,a):t.texImage2D(r,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,a)}},{key:"createLoadObj",value:function(t){var e=this,r={};return r.image=new Image,r.image.crossOrigin="anonymous",r.callback=t.callback,r.prim=t.attach,r.busy=!0,r.image.addEventListener("load",function(t){return e.uploadTexture(r,r.callback)}),r.image.addEventListener("error",function(e){return console.log("error loading image:"+t.source)},!1),r.image.src=t.source,this.cacheCt++,r}},{key:"uploadTexture",value:function(t,e){var r=this.webgl.getContext(),a=t.prim.textures;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0);var n={image:t.image,src:t.image.src,texture:r.createTexture()};r.bindTexture(r.TEXTURE_2D,n.texture),n.image?r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n.image):(console.error("no loadObj.image for:"+n.image.src+", using default pixel texture"),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,this.greyPixel)),this.util.isPowerOfTwo(n.image.width)&&this.util.isPowerOfTwo(n.image.height)?(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_NEAREST),r.generateMipmap(r.TEXTURE_2D)):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR)),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.bindTexture(r.TEXTURE_2D,null),a.push(n),t.busy=!1,this.update(t)}},{key:"uploadCubeTexture",value:function(){}},{key:"upload3DTexture",value:function(){}}]),e}(l.default);e.default=c},function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),s=r(2),l=a(s),c=function(t){function e(t,r,a,i){return n(this,e),console.log("in LoadVideo class"),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,a,i))}return i(e,t),u(e,[{key:"init",value:function(){}}]),e}(l.default);e.default=c},function(t,e){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),n=function(){function t(e){r(this,t),console.log("in Map"),this.util=e,this.type={PLANE:"initPlane",RANDOM:"initRandom",DIAMOND:"initDiamond",IMAGE:"initImage"},this.edgeType={NONE:0,WRAP:1,TOZERO:2},this.width=0,this.depth=0,this.low=0,this.high=0,this.map=null,this.squareSize=0,this.max=0,this.canvas=this.ctx=this.imgData=null}return a(t,[{key:"checkParams",value:function(t,e,r,a){return t<1||e<1?(console.error("invalid map width or height, was:"+t+", "+e),!1):r<0||r>1?(console.error("invalid Map roughness (0-1), was:"+r),!1):!(a<0||a>1)||(console.error("invalid Map flatten (0-1.0), was:"+a),!1)}},{key:"getPixel",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(t<0||t>this.width||e<0||e>this.depth)switch(r){case this.edgeType.WRAP:t<0&&(t=this.width-t),t>this.width-1&&(t-=this.width),e<0&&(e=this.depth-e),e>this.depth-1&&(e-=this.depth);break;case this.edgeType.TOZERO:var a=t,n=e;return t<0&&(t=0),t>this.width-1&&(t=this.width-1),e<0&&(e=0),e>this.depth-1&&(e=this.depth-1),
this.map[t+this.squareSize*e]/(Math.abs(a-t)+Math.abs(n-e));default:return console.error("getPixel out of range x:"+t+" z:"+e+" width:"+w+" height:"+h+" max:"+this.max),-1}return this.map[t+this.width*e]}},{key:"setPixel",value:function(t,e,r){return t<0||t>this.max||e<0||e>this.max?(console.error("setPixel out of range x:"+t+" z:"+e+" max:"+this.max),-1):(this.low>r&&(this.low=r),this.high<r&&(this.high=r),void(this.map[t+this.width*e]=r))}},{key:"initPlane",value:function(t,e){this.checkParams(t,e,0,0)?(this.img=this.map=null,this.map=new Float32Array(t*e),this.width=t,this.depth=e,this.squareSize=Math.min(t*e)):console.error("error creating Map using "+this.type.PLANE)}},{key:"initRandom",value:function(t,e,r){if(this.checkParams(t,e,r,0)){this.map=new Float32Array(t*e),this.width=t,this.depth=e,this.squareSize=Math.min(t,e),this.max=this.squareSize-1;for(var a=this.util,n=0,o=this.map.length;n<o;n++)this.map[n]=a.getRand()*r}else console.error("error creating Map using "+this.type.RANDOM)}},{key:"initDiamond",value:function(t,e,r,a){if(this.checkParams(t,e,r,a)){this.img=this.map=null,console.log("starting width:"+t+" height:"+e+" roughness:"+r);var n=Math.pow(2,Math.ceil(Math.log((t+e)/2)/Math.log(2)));console.warn("random map, selecting nearest power of 2 ("+n+" x "+n+")"),this.squareSize=n+1,this.width=this.depth=n,this.map=new Float32Array(this.squareSize*this.squareSize),this.max=this.squareSize-1,this.setPixel(0,0,this.max),this.setPixel(this.max,0,this.max/2),this.setPixel(this.max,this.max,0),this.setPixel(0,this.max,this.max/2),this.divide(this.max,r),this.setPixel(0,0,(this.getPixel(0,1)+this.getPixel(1,0))/2),this.flatten(a/this.squareSize)}else console.error("error creating Map using "+this.type.DIAMOND)}},{key:"initImage",value:function(t,e,r,a){var n=this;this.checkParams(t,e,roughness,flatten),this.canvas||(this.canvas=document.createElement("canvas")),this.ctx||(this.ctx=this.canvas.getContext("2d"));var o=new Image;o.style.display="none",o.onload=function(){n.ctx.drawImage(o,0,0),n.imgData=n.ctx.getImageData(0,0,o.width,o.height),n.width=o.width,n.depth=o.height,n.squareSize=Math.min(t,h),n.max=n.squareSize-1,n.map=new Float32Array(n.squareSize);for(var e=0,r=n.imgData,a=0,i=n.data.length;a<i;a++)n.map[e++]=r[a]+r[a+1]+r[a+2]/3},o.onerror=function(){console.error("image could not be loaded:"+r)},o.src=r,a(this.data)}},{key:"divide",value:function(t,e){var r=void 0,a=void 0,n=t/2,o=e*t,i=this.util;if(!(n<1)){for(a=n;a<this.max;a+=t)for(r=n;r<this.max;r+=t)this.square(r,a,n,i.getRand()*o*2-o);for(a=0;a<=this.max;a+=n)for(r=(a+n)%t;r<=this.max;r+=t)this.diamond(r,a,n,i.getRand()*o*2-o);this.divide(t/2,e)}}},{key:"average",value:function(t){var e=t.filter(function(t){return t!==-1}),r=e.reduce(function(t,e){return t+e},0);return r/e.length}},{key:"square",value:function(t,e,r,a){var n=this.average([this.getPixel(t-r,e-r),this.getPixel(t+r,e-r),this.getPixel(t+r,e+r),this.getPixel(t-r,e+r)]);this.setPixel(t,e,n+a)}},{key:"diamond",value:function(t,e,r,a){var n=this.average([this.getPixel(t,e-r),this.getPixel(t+r,e),this.getPixel(t,e+r),this.getPixel(t-r,e)]);this.setPixel(t,e,n+a)}},{key:"flatten",value:function(t){var e=void 0;if(this.map&&this.map.length)for(var r=this.map,a=0,n=r.length;a<n;a++)r[a]*=t,e=r[a],this.high<e&&(this.high=e),this.low>e&&(this.low=e)}},{key:"roughen",value:function(t){this.map&&this.map.length}},{key:"scale",value:function(t,e){if(this.checkParams(t,e,0,0)){var r=new Float32Array(t*e),a=this.width/t,n=this.depth/e;console.log("original width:"+this.width+" new:"+t+"original height:"+this.depth+" new:"+e),console.log("xScale:"+a+" zScale:"+n);for(var o=0;o<e;o++)for(var i=0;i<t;i++)r[t*o+i]=this.biCubic(i*a,o*n);console.log("WIDTH:"+t+" HEIGHT:"+e),this.map=r,this.width=t,this.depth=e,this.squareSize=Math.min(t,e),this.max=this.squareSize-1}}},{key:"biLinear",value:function(t,e){if(t<0||t>1||e<0||e>1)return console.error("heightmap x index out of range, x:"+t+" z:"+e),null;t*=this.width,e*=this.depth;var r=Math.min(t),a=Math.max(t),n=Math.min(e),o=Math.max(e),i=this.getPixel(r,n)*(t-r)+this.getPixel(r,o)*(1-t-r),u=this.getPixel(n,o)*(t-r)+this.getPixel(a,o)*(1-t-r),s=i*(e-n)+u*(1-e-n);return s}},{key:"biCubicPoint",value:function(t,e,r,a,n,o,i,u,s,l,c,f,h,d,m,M,g,v){var x=e*e,p=t*t,b=t*p,y=o-n-r+a,S=r-a-y,I=n-r,D=y*b+S*p+I*t+a,w=l-s-i+u,E=i-u-w,T=s-i,F=w*b+E*p+T*t+u,R=d-h-c+f,P=c-f-R,A=h-c,_=R*b+P*p+A*t+f,O=v-g-m+M,L=m-M-O,C=g-m,V=O*b+L*p+C*t+M,k=V-_-D+F,z=D-F-k,N=_-D;return k*e*x+z*x+N*e+F}},{key:"biCubic",value:function(t,e){var r=Math.floor(t),a=Math.floor(e),n=r+1,o=a+1,i=this.getPixel(r-1,a-1),u=this.getPixel(r-1,a),s=this.getPixel(r-1,o),l=this.getPixel(r-1,o+1),c=this.getPixel(r,a-1),f=this.getPixel(r,a),h=this.getPixel(r,o),d=this.getPixel(r,o+1),m=this.getPixel(n,a-1),M=this.getPixel(n,a),g=this.getPixel(n,o),v=this.getPixel(n,o+1),x=this.getPixel(n+1,a-1),p=this.getPixel(n+1,a),b=this.getPixel(n+1,o),y=this.getPixel(n+1,o+1);return this.biCubicPoint(t-r,e-a,i,c,m,x,u,f,M,p,s,h,g,b,l,d,v,y)}}]),t}();e.default=n},function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),i=r(14),u=a(i),s=function(){function t(e,r,a,o,i,u,s,l){n(this,t),console.log("in Prim class"),this.util=r,this.webgl=o,this.glMatrix=a,this.loadModel=i,this.loadTexture=u,this.loadAudio=s,this.loadVideo=l,this.objs=[],this.typeList={POINT:"geometryPoint",POINTCLOUD:"geometryPointCloud",LINE:"geometryLine",PLANE:"geometryPlane",CIRCLE:"geometryCircle",POLY:"geometryPoly",CUBE:"geometryCube",SPHERE:"geometrySphere",ICOSOHEDRON:"geometryIcosohedron",CUBESPHERE:"geometryCubeSphere",ICOSPHERE:"geometryIcoSphere",DOME:"geometryDome",TOPDOME:"geometryTopDome",SKYDOME:"geometrySkyDome",BOTTOMDOME:"geometryBottomDome",TOPICODOME:"geometryTopIcoDome",SKYICODOME:"geometrySkyIcoDome",BOTTOMICODOME:"geometryBottomIcoDome",SPINDLE:"geometrySpindle",CONE:"geometryCone",TOPCONE:"geometryTopCone",BOTTOMCONE:"geometryBottomCone",CYLINDER:"geometryCylinder",TORUS:"geometryTorus",MESH:"geometryMesh",TERRAIN:"geometryTerrain"},this.sides={DEFAULT_SIDE:0,FRONT_SIDE:1,BACK_SIDE:2,LEFT_SIDE:3,RIGHT_SIDE:4,TOP_SIDE:5,BOTTOM_SIDE:6},this.draw={FORWARD_SIDE:10,BACKWARD_SIDE:11,BOTH_SIDES:12}}return o(t,[{key:"setId",value:function(){var t=(new Date).getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var r=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?r:3&r|8).toString(16)});return e}},{key:"setVertexData",value:function(t){t=[];this.objs.length;for(var e in this.objs)t=t.concat(this.objs[e].vertices);return t}},{key:"setIndexData",value:function(t){t=[];this.objs.length;for(var e in this.objs)t=t.concat(this.objs[e].indices);return t}},{key:"createBufferObj",value:function(){return{makeBuffers:!0,vertices:{data:[],buffer:null,itemSize:3,numItems:0},indices:{data:[],buffer:null,itemSize:1,numItems:0},normals:{data:[],buffer:null,itemSize:3,numItems:0},tangents:{data:[],buffer:null,itemSize:4,numItems:0},texCoords:{data:[],buffer:null,itemSize:2,numItems:0},colors:{data:[],buffer:null,itemSize:4,numItems:0}}}},{key:"addBufferData",value:function(t,e,r,a,n,o,i){var u=this.util.concatArr;u(t.vertices.data,e),u(t.indices.data,r),u(t.texCoords.data,a),u(t.normals.data,n),u(t.tangents.data,o),u(t.colors.data,i)}},{key:"createBuffers",value:function(t){var e=this.webgl.getContext(),r=void 0;return r=t.vertices,r.data.length||(console.log("no vertices present, creating default"),r.data=new Float32Array([0,0,0])),r.buffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,r.buffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(r.data),e.STATIC_DRAW),r.numItems=r.data.length/r.itemSize,r=t.indices,r.data.length||(console.log("no indices present, creating default"),r.data=new Uint16Array([1])),r.buffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.buffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(r.data),e.STATIC_DRAW),r.numItems=r.data.length/r.itemSize,r=t.normals,r.data.length||(console.log("no normals, present, creating default"),r.data=new Float32Array([0,1,0])),r.buffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,r.buffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(r.data),e.STATIC_DRAW),r.numItems=r.data.length/r.itemSize,r=t.texCoords,r.data.length||(console.warn("no texture present, creating default"),r.data=new Float32Array([0,0])),r.buffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,r.buffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(r.data),e.STATIC_DRAW),r.numItems=r.data.length/r.itemSize,r=t.tangents,r.data.length||(console.warn("no tangents present, creating default"),r.data=new Float32Array([0,0,0,0])),r.buffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,r.buffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(r.data),e.STATIC_DRAW),r.numItems=r.data.length/r.itemSize,r=t.colors,r.data.length||(console.warn("no colors present, creating default color"),r.data=new Float32Array([.2,.5,.2,1])),r.buffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,r.buffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(r.data),e.STATIC_DRAW),r.numItems=r.data.length/r.itemSize,t}},{key:"computeColors",value:function(t,e){for(var r=0,a=t.length;r<a;r+=3)e.push(t[r],t[r+1],t[r+2],1);return e}},{key:"primReadout",value:function(t){console.log("prim:"+t.name+" type:"+t.type+" vertex:("+t.geometry.vertices.itemSize+"), "+t.geometry.vertices.numItems+", texture:("+t.geometry.texCoords.itemSize+"), "+t.geometry.texCoords.numItems+", index:("+t.geometry.indices.itemSize,"), "+t.geometry.indices.numItems+", normals:("+t.geometry.normals.itemSize+"), "+t.geometry.normals.numItems)}},{key:"getStdVec3",value:function(t){switch(t){case"back":return[0,0,-1];case"down":return[0,-1,0];case"forward":return[0,0,1];case"left":return[-1,0,0];case"one":return[1,1,1];case"right":return[1,0,0];case"up":return[0,1,0];case"zero":return[0,0,0]}}},{key:"pointInTriangle",value:function(t,e,r,a){var n=this.glMatrix.vec3,o=void 0,i=void 0,u=void 0,s=void 0,l=void 0,c=void 0,f=void 0,h=void 0;o=n.sub(o,a,e),i=n.sub(i,r,e),u=n.sub(u,t,e),s=n.dot(o,o),l=n.dot(o,i),c=n.dot(o,u),f=n.dot(i,i),h=n.dot(i,u);var d=1/(s*f-l*l),m=(f*c-l*h)*d,M=(s*h-l*c)*d;return m>=0&&M>=0&&m+M<1}},{key:"computeNormals",value:function(t,e,r){var a=0,n=0,o=0,i=0,u=0,s=0,l=0,c=0,f=0,h=0,d=0,m=0,M=0,g=0;for(a=0;a<t.length;a++)r[a]=0;var v=e.length/3;for(a=0;a<v;a++)m=e[3*a],M=e[3*a+1],g=e[3*a+2],n=t[3*m]-t[3*M],o=t[3*m+1]-t[3*M+1],i=t[3*m+2]-t[3*M+2],u=t[3*g]-t[3*M],s=t[3*g+1]-t[3*M+1],l=t[3*g+2]-t[3*M+2],c=o*l-i*s,f=i*u-n*l,h=n*s-o*u,d=Math.sqrt(c*c+f*f+h*h),d=0===d?1:d,c/=d,f/=d,h/=d,r[3*m]+=c,r[3*m+1]+=f,r[3*m+2]+=h,r[3*M]+=c,r[3*M+1]+=f,r[3*M+2]+=h,r[3*g]+=c,r[3*g+1]+=f,r[3*g+2]+=h;for(a=0;a<r.length/3;a++)c=r[3*a],f=-r[3*a+1],h=r[3*a+2],d=Math.sqrt(c*c+f*f+h*h),d=0===d?1:d,c/=d,f/=d,h/=d,r[3*a]=-c,r[3*a+1]=f,r[3*a+2]=-h}},{key:"computeTangents",value:function(t,e,r,a){for(var n=this.glMatrix.vec3,o=new Float32Array(r.length),i=new Float32Array(r.length),u=e.length,s=t.length,l=0;l<u;l+=3){var c=e[l],f=e[l+1],h=e[l+2],d=3*c,m=t[d],M=t[d+1],g=t[d+2],d=3*f,v=t[d],x=t[d+1],p=t[d+2],d=3*h,b=t[d],y=t[d+1],S=t[d+2],I=v-m,D=b-m,w=x-M,E=y-M,T=p-g,F=S-g,d=2*c,R=a[d],P=a[d+1],d=2*f,A=a[d],_=a[d+1],d=2*h,O=a[d],L=a[d+1],C=A-R,V=O-R,k=_-P,z=L-P,N=1/(C*z-V*k),B=(z*I-k*D)*N,j=(z*w-k*E)*N,U=(z*T-k*F)*N,Y=(C*D-V*I)*N,q=(C*E-V*w)*N,X=(C*F-V*T)*N,d=3*c;o[d]+=B,o[d+1]+=j,o[d+2]+=U,i[d]+=Y,i[d+1]+=q,i[d+2]+=X;var d=3*f;o[d]+=B,o[d+1]+=j,o[d+2]+=U,i[d]+=Y,i[d+1]+=q,i[d+2]+=X;var d=3*h;o[d]+=B,o[d+1]+=j,o[d+2]+=U,i[d]+=Y,i[d+1]+=q,i[d+2]+=X}for(var G=new Float32Array(4*s/3),H=0,W=0;W<s;H+=3,W+=4){var K=[r[H],r[H+1],r[H+2]],Z=[o[H],o[H+1],o[H+2]],Q=[i[H],i[H+1],i[H+2]],$=n.sub([0,0,0],Z,n.scale([0,0,0],Z,n.dot(K,Z))),J=$[0]*$[0]+$[1]*$[1]+$[2]*$[2],tt=J>0?n.scale([0,0,0],$,1/Math.sqrt(J)):$,et=n.dot(n.cross([0,0,0],K,Z),Q)<0?-1:1;G[W]=tt[0],G[W+1]=tt[1],G[W+2]=tt[2],G[W+3]=et}return G}},{key:"subdivide",value:function(t){}},{key:"geometryPoint",value:function(t){var e=this.util,r=t.geometry,a=r.vertices.data,n=r.indices.data,o=r.texCoords.data,i=r.normals.data,u=r.tangents.data,s=r.colors.data;return this.computeNormals(a,n,i),this.computeTangents(a,n,i,o),s.length||s.push(e.randomColor(),e.randomColor(),e.randomColor(),1),t.geometry.makeBuffers===!0?this.createBuffers(t.geometry):this.addBufferData(t.geometry,a,n,o,i,u,s)}},{key:"geometryPointCloud",value:function(t){var e=t.geometry,r=e.vertices.data,a=e.indices.data,n=e.texCoords.data,o=e.normals.data,i=e.tangents.data,u=e.colors.data;return this.computeNormals(r,a,o),this.computeTangents(r,a,o,n),u.length||(e.colors.data=this.computeColors(o,u)),t.geometry.makeBuffers===!0?this.createBuffers(t.geometry):this.addBufferData(t.geometry,r,a,n,o,i,u)}},{key:"geometryParticleSystem",value:function(){var t=prim.geometry,e=t.vertices.data,r=t.indices.data,a=t.texCoords.data,n=t.normals.data,o=t.tangents.data,i=t.colors.data;return this.computeNormals(e,r,n),this.computeTangents(e,r,n,a),i.length||(t.colors.data=this.computeColors(n,i)),prim.geometry.makeBuffers===!0?this.createBuffers(prim.geometry):this.addBufferData(prim.geometry,e,r,a,n,o,i)}},{key:"geometryLine",value:function(t){var e=t.geometry,r=e.vertices.data,a=e.indices.data,n=e.texCoords.data,o=e.normals.data,i=e.tangents.data,u=e.colors.data;return u.length||(e.colors.data=this.computeColors(o,u)),t.geometry.makeBuffers===!0?this.createBuffers(t.geometry):this.addBufferData(t.geometry,r,a,n,o,i,u)}},{key:"geometryPlane",value:function(t){for(var e=t.geometry,r=e.vertices.data,a=e.indices.data,n=e.texCoords.data,o=e.normals.data,i=e.tangents.data,u=e.colors.data,s=t.divisions[0],l=t.divisions[2],c=t.dimensions[0]/2,f=t.dimensions[2]/2,h=t.dimensions[0]/t.divisions[0],d=1,m=t.dimensions[2]/t.divisions[2],M=0;M<=s;M++)for(var g=0;g<=l;g++){var v=M,x=0;t.heightMap&&(x=t.heightMap.getPixel(M,g));var p=g,b=M/s,y=1-g/l;r.push(h*v-c,d*x,m*p-f),n.push(b,y),o.push(0,1,0)}for(var S=0;S<l;S++)for(var I=0;I<s;I++){var D=S*(s+1)+I,w=D+s+1;a.push(D+1,w+1,w),a.push(D+1,w,D)}return this.computeNormals(r,a,o),this.computeTangents(r,a,o,n),u.length||(u=e.colors.data=this.computeColors(o,u)),"colored ico"===t.name&&(window.geo=e),t.geometry.makeBuffers===!0?this.createBuffers(t.geometry):this.addBufferData(t.geometry,r,a,n,o,i,u)}},{key:"geometryPoly",value:function(t){var e=t.geometry,r=e.vertices.data,a=e.indices.data,n=e.texCoords.data,o=e.normals.data,i=e.tangents.data,u=e.colors.data;return this.computeNormals(r,a,o),this.computeTangents(r,a,o,n),u.length||(e.colors.data=this.computeColors(o,u)),t.geometry.makeBuffers===!0?this.createBuffers(t.geometry):this.addBufferData(t.geometry,r,a,n,o,i,u)}},{key:"geometryDome",value:function(t){var e=this.typeList,r=this.glMatrix.vec3,a=t.geometry,n=a.vertices.data,o=a.indices.data,i=a.texCoords.data,u=a.normals.data,s=a.tangents.data,l=a.colors.data,c=t.divisions[0],f=t.divisions[1],h=.5*Math.max(t.dimensions[0],t.dimensions[1],t.dimensions[2]),d=0,m=0,M=void 0;M=t.type===e.SPHERE||t.type===e.CYLINDER||t.type===e.SPINDLE?f:f/2;for(var g=void 0,v=void 0,x=void 0,p=void 0,b=void 0,y=d;y<=M;y++)for(var S=y*Math.PI/f,I=Math.sin(S),D=Math.cos(S),w=m;w<=c;w++){var E=2*w*Math.PI/c,T=Math.sin(E),F=Math.cos(E);t.type===e.CYLINDER?(g=F,x=T,v=D,p=1-w/c,b=1-y/f):t.type===e.SPHERE||t.type===e.TOPDOME||t.type===e.DOME||t.type===e.SKYDOME?(g=F*I,x=T*I,v=1.2*D,p=1-w/c,b=1-y/f):t.type===e.BOTTOMDOME?(g=F*I,x=T*I,v=1-D,p=w/c,b=y/f):t.type===e.SPINDLE||t.type===e.CONE||t.type==e.TOPCONE?(g=F*I,x=T*I,v=1-y/f,p=1-w/c,b=1-y/f):t.type===e.BOTTOMCONE&&(g=F*I,x=T*I,v=2*y/f,p=1-w/c,b=1-y/f),g*=t.dimensions[0],v*=t.dimensions[1],x*=t.dimensions[2],t.type!==e.SPINDLE&&t.type!==e.SPHERE,n.push(h*g,h*v,h*x),t.type!==e.BOTTOMDOME&&t.type!==e.BOTTOMCONE&&t.type!==e.SKYDOME||(v=-v),i.push(p,b);var R=r.normalize([0,0,0],[g,v,x]);u.push(R[0],R[1],R[2])}for(var P=0;P<M;P++)for(var A=0;A<c;A++){var _=P*(c+1)+A,O=_+c+1;t.type===e.SKYDOME?(o.push(O,_,O+1),o.push(_,_+1,O+1)):(o.push(_+1,O+1,O),o.push(_+1,O,_))}return t.type===e.SKYDOME&&(a.indices.data=o.reverse()),a.tangents.data=s=this.computeTangents(n,o,u,i),l.length||(a.colors.data=this.computeColors(u,l)),t.geometry.makeBuffers===!0?this.createBuffers(t.geometry):this.addBufferData(t.geometry,n,o,i,u,s,l)}},{key:"geometryTopDome",value:function(t){return this.geometryDome(t)}},{key:"geometrySkyDome",value:function(t){return this.geometryDome(t)}},{key:"geometryBottomDome",value:function(t){return this.geometryDome(t)}},{key:"geometrySphere",value:function(t){return this.geometryDome(t)}},{key:"geometryCylinder",value:function(t){return this.geometryDome(t)}},{key:"geometrySpindle",value:function(t){return this.geometryDome(t)}},{key:"geometryCone",value:function(t){return this.geometryDome(t)}},{key:"geometryTopCone",value:function(t){return this.geometryDome(t)}},{key:"geometryBottomCone",value:function(t){return this.geometryDome(t)}},{key:"geometryCube",value:function(t){function e(t,e,r,a,n,o,i,l,c,f){for(var h=b,d=0;d<=i;d++)for(var m=0;m<=o;m++){var M=x[b]=[0,0,0];M[t]=(-a/2+m*a/o)*c,M[e]=(-n/2+d*n/i)*f,M[r]=l;var g=p[b]=[0,0,0];g[t]=0,g[e]=0,g[r]=l/Math.abs(l),s.push(m/o,1-d/i),++b}for(var d=0;d<i;d++)for(var m=0;m<o;m++){var v=h+d*(o+1)+m;u.push(v,v+o+1,v+o+2),u.push(v,v+o+2,v+1)}}var r=this.glMatrix.vec3,a=this.util.flatten,n=this.typeList,o=t.geometry,i=o.vertices.data,u=o.indices.data,s=o.texCoords.data,l=o.normals.data,c=o.tangents.data,f=o.colors.data,h=t.dimensions[0],d=t.dimensions[1],m=t.dimensions[2],M=t.divisions[0],g=t.divisions[1],v=t.divisions[2],x=[],p=[],b=0;if(e(0,1,2,h,d,M,g,m/2,1,-1),e(0,1,2,h,d,M,g,-m/2,-1,-1),e(2,1,0,m,d,v,g,-h/2,1,-1),e(2,1,0,m,d,v,g,h/2,-1,-1),e(0,2,1,h,m,M,v,d/2,1,1),e(0,2,1,h,m,M,v,-d/2,1,-1),t.type===n.CUBESPHERE)for(var y=[0,0,0],S=t.dimensions[0]/2,I=h/2,D=d/2,w=m/2,E=0;E<x.length;E++){var T=x[E],F=l[E],R=[T[0],T[1],T[2]];T[0]<-I+S?R[0]=-I+S:T[0]>I-S&&(R[0]=I-S),T[1]<-D+S?R[1]=-D+S:T[1]>D-S&&(R[1]=D-S),T[2]<-w+S?R[2]=-w+S:T[2]>w-S&&(R[2]=w-S),F=[T[0],T[1],T[2]],r.sub(F,F,R),r.normalize(F,F),l[E]=F,T=[R[0],R[1],R[2]],y=[F[0],F[1],F[2]],r.scale(y,y,S),r.add(T,T,y),x[E]=T}return i=o.vertices.data=a(x,!1),l=o.normals.data=a(p,!1),f.length||(f=o.colors.data=this.computeColors(l,f)),t.geometry.makeBuffers===!0?this.createBuffers(t.geometry):this.addBufferData(t.geometry,i,u,s,l,c,f)}},{key:"geometryCubeSphere",value:function(t){return this.geometryCube(t)}},{key:"geometryCan",value:function(t){}},{key:"geometryCapsule",value:function(t){}},{key:"geometryIcoSphere",value:function(t){function e(t,e){var r=1;for(D=0;D<t.length;D++){y=t[D],y[0]==r&&(e[D-1][0]=1),r=y[0];var a=[0,0];a[0]=Math.atan2(y[0],y[2])/(-2*Math.PI),a[0]<0&&(a[0]+=1),a[1]=Math.asin(y[1])/Math.PI+.5,e[D]=a}for(e[t.length-4][0]=.125,e[0][0]=.125,e[t.length-3][0]=.375,e[1][0]=.375,e[t.length-2][0]=.625,e[2][0]=.625,e[t.length-1][0]=.875,e[3][0]=.875,D=0;D<v.length;D++)v[D][0]=1-v[D][0]}function r(t,e){for(D=0;D<t.Length;D++)y=t[D],y[1]=0,y=i.normalize([0,0,0],y),tangent=[0,0,0,0],tangent[0]=-y[2],tangent[1]=0,tangent[2]=y[0],tangent[3]=-1,e[D]=tangent;for(e[t.length-4]=[-1,0,1],e[0]=[-1,0,-1],e[t.length-3]=[1,0,-1],e[1]=[1,0,-1],e[t.length-2]=[1,0,1],e[2]=[1,0,1],e[t.length-1]=[-1,0,1],e[3]=[-1,0,1],D=0;D<4;D++)e[t.length-1-D][3]=e[D][3]=-1}function a(t,e,r,a,n){for(var o=1;o<=r;o++)n[a++]=i.lerp([0,0,0],t,e,o/r);return a}function n(t,e,r,a,n){for(var o=1;o<t;o++)n[a++]=r,n[a++]=e-1,n[a++]=e,n[a++]=r++,n[a++]=e++,n[a++]=r;return n[a++]=r,n[a++]=e-1,n[a++]=e,a}function o(t,e,r,a,n){n[a++]=r,n[a++]=e-1,n[a++]=++r;for(var o=1;o<=t;o++)n[a++]=e-1,n[a++]=e,n[a++]=r,n[a++]=r,n[a++]=e++,n[a++]=++r;return a}var i=this.glMatrix.vec3,u=this.util.flatten,s=this.typeList,l=t.divisions[0],c=.5*t.dimensions[0],f=1<<l,h=this.getStdVec3,d=["left","back","right","forward"];console.log("RESOLUTION:"+f);var m=t.geometry,M=m.vertices.data=new Array((f+1)*(f+1)*4-3*(2*f-1)),g=m.indices.data=new Array(3*(1<<2*l+3)),v=m.texCoords.data=new Array(M.length),x=m.normals.data=new Array(M.length),p=m.tangents.data=new Array(M.length),b=m.colors.data,y=0,S=0,I=0,D=void 0,w=void 0,E=void 0,T=h("zero"),F=h("zero");for(D=0;D<4;D++)M[y++]=h("down");for(D=1;D<=f;D++){for(E=D/f,F=i.lerp([0,0,0],h("down"),h("forward"),E),M[y++]=i.copy([0,0,0],F),w=0;w<4;w++)T=i.copy([0,0,0],F),F=i.lerp([0,0,0],h("down"),h(d[w]),E),I=n(D,y,S,I,g),y=a(T,F,D,y,M),S+=D>1?D-1:1;S=y-1-4*D}for(D=f-1;D>=1;D--){for(E=D/f,F=i.lerp([0,0,0],h("up"),h("forward"),E),M[y++]=i.copy([0,0,0],F),w=0;w<4;w++)T=i.copy([0,0,0],F),F=i.lerp([0,0,0],h("up"),h(d[w]),E),I=o(D,y,S,I,g),y=a(T,F,D,y,M),S+=D+1;S=y-1-4*D}for(D=0;D<4;D++)g[I++]=S,g[I++]=y,g[I++]=++S,M[y++]=h("up");for(D=0;D<M.length;D++)t.type===s.ICOSPHERE&&(M[D]=i.normalize([0,0,0],M[D])),x[D]=i.copy([0,0,0],M[D]);if(e(M,v),r(M,p),1!=c)for(D=0;D<M.length;D++)M[D][0]*=c,M[D][1]*=c,M[D][2]*=c;return M=m.vertices.data=u(M,!1),v=m.texCoords.data=u(v,!1),x=m.normals.data=u(x,!1),p=m.tangents.data=u(p,!1),b.length||(m.colors.data=this.computeColors(x,b)),t.geometry.makeBuffers===!0?this.createBuffers(t.geometry):this.addBufferData(t.geometry,M,g,v,x,p,b)}},{key:"geometryIcosohedron",value:function(t){return this.geometryIcoSphere(t,!1)}},{key:"geometryIcoDome",value:function(t){}},{key:"geometryPrism",value:function(t){}},{key:"geometryTorus",value:function(t){for(var e=this.glMatrix.vec3,r=t.geometry,a=r.vertices.data,n=r.indices.data,o=r.texCoords.data,i=r.normals.data,u=r.tangents.data,s=r.colors.data,l=1.5,c=.25,f=36,h=24,d=f+1,m=h+1,M=2*Math.PI/h,g=2*Math.PI/f,v=0,x=0,p=void 0,b=void 0,y=void 0,S=0;S<m;S++){v=M*S;for(var I=0;I<d;I++){x=g*I,p=Math.cos(v)*(l+c*Math.cos(x)),b=Math.sin(v)*(l+c*Math.cos(x)),y=c*Math.sin(x),a.push(p,b,y);var D=e.normalize([0,0,0],[p,b,y]);i.push(D[0],D[1],D[2]);var w=I/d,E=S/m;o.push(w,E)}}for(var T=0;T<h;T++)for(var F=0;F<f;F++){var R=F+T*d,P=F+1+T*d,A=F+(T+1)*d,_=F+1+(T+1)*d;n.push(A,_,P,A,P,R)}return s.length||(s=r.colors.data=this.computeColors(i,s)),t.geometry.makeBuffers===!0?this.createBuffers(t.geometry):this.addBufferData(t.geometry,a,n,o,i,u,s)}},{key:"geometryMesh",value:function(t){var e=t.geometry,r=e.vertices.data,a=e.indices.data,n=e.texCoords.data,o=e.normals.data,i=e.tangents.data,u=e.colors.data;return this.computeNormals(r,a,o),this.computeTangents(r,a,o,n),u.length||(e.colors.data=this.computeColors(o,u)),t.geometry.makeBuffers===!0?this.createBuffers(t.geometry):this.addBufferData(t.geometry,r,a,n,o,i,u)}},{key:"geometryTerrain",value:function(t){t.heightMap||(console.log("adding heightmap for:"+t.name),t.heightMap=new u.default(this.util),t.heightMap[t.heightMap.type.DIAMOND](t.divisions[0],t.divisions[2],.6,1));var e=this.geometryPlane(t);return e}},{key:"geometryPlanet",value:function(){}},{key:"createPrim",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments[3],n=arguments[4],o=arguments[5],i=arguments[6],u=arguments[7],s=arguments[8],l=arguments[9],c=arguments[10],f=this.glMatrix.vec3,h=this.glMatrix.mat4,d={};d.id=this.setId(),d.name=e,d.scale=r,d.dimensions=a||f.fromValues(1,1,1),d.divisions=n||f.fromValues(1,1,1),d.position=o||f.create(),d.acceleration=i||f.create(),d.rotation=u||f.create(),d.angular=s||f.create(),d.orbitRadius=0,d.orbitAngular=0,d.side=this.DEFAULT_SIDE,d.waypoints=[],d.textures=[],d.audio=[],d.video=[];for(var m=0;m<l.length;m++)this.loadTexture.load(l[m],d);return d.material=this.setMaterial(),this.light={direction:[1,1,1],color:[255,255,255]},d.parentNode=null,d.children=[],void 0===a[3]&&(a[4]=a[3]=a[0]/2),d.type=t,d.geometry=this.createBufferObj(),d.dimensions[3]=d.dimensions[4]=.5*d.dimensions[0],d.geometry=this[t](d,c),d.setMV=function(t){var e=d;h.identity(t);var r=-5;return f.add(e.position,e.position,e.acceleration),h.translate(t,t,[e.position[0],e.position[1],r+e.position[2]]),f.add(e.rotation,e.rotation,e.angular),h.rotate(t,t,e.rotation[0],[1,0,0]),h.rotate(t,t,e.rotation[1],[0,1,0]),h.rotate(t,t,e.rotation[2],[0,0,1]),t},d.renderId=-1,this.objs.push(d),this.primReadout(d),d}},{key:"scale",value:function(t,e){for(var r=this.getCenter(t),a=0,n=t.length;a<n;a++)t[a]*=e;this.move(t,r)}},{key:"move",value:function(t,e){for(var r=this.getCenter(t),a=[r[0]-e[0],r[1]-e[1],r[2]=e[2]],n=0,o=t.length;n<o;n+=3)t[n]=a[0],t[n+1]=a[1],t[n+2]=a[2]}},{key:"boundingBox",value:function(t){for(var e=void 0,r=void 0,a=void 0,n=void 0,o=void 0,i=void 0,u=0,s=t.length;u<s;u+=3)e=Math.min(t[u],e),r=Math.min(t[u+1],r),a=Math.min(t[u+2],a),n=Math.max(t[u],n),o=Math.max(t[u+1],o),i=Math.max(t[u+2],i);var l=[];return l}},{key:"getCenter",value:function(t){this.boundingBox(t)}},{key:"setMaterial",value:function(t){return{colorMult:0,diffuse:[1,1,1],specular:[1,1,1,1],shininess:this.util.getRand(500),specularFactor:this.util.getRand(1)}}}]),t}();e.default=s},function(t,e){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function t(e,a,n,o,i,u,s){r(this,t),console.log("In Renderer class"),this.webgl=o,this.util=o.util,this.glmatrix=n,this.shaderTexture=i,this.shaderColor=u,this.shaderDirlightTexture=s,this.init};e.default=a},function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),s=r(3),l=a(s),c=function(t){function e(t,r,a,i,u){n(this,e);var s=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,a,i,u));return console.log("In ShaderColor class"),s}return i(e,t),u(e,[{key:"vsSrc",value:function(){var t=["attribute vec3 aVertexPosition;","attribute vec4 aVertexColor;","uniform mat4 uMVMatrix;","uniform mat4 uPMatrix;","varying lowp vec4 vColor;","void main(void) {","    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);","    vColor = aVertexColor;","}"];return{code:t.join("\n"),varList:this.webgl.createVarList(t)}}},{key:"fsSrc",value:function(){var t=["varying lowp vec4 vColor;","void main(void) {","gl_FragColor = vColor;","}"];return{code:t.join("\n"),varList:this.webgl.createVarList(t)}}},{key:"init",value:function(t){var e=this.setup(),r=e[0],a=e[1],n=e[2],o=(e[3],e[4],e[5]),i=e[6],u=e[7],s=e[8],l=(e[9],u.shaderProgram);return window.vs2Vars=s,u.renderList=t||[],u.update=function(t){t.setMV(i)},u.render=function(){r.useProgram(l),n.perspective(o,.4*Math.PI,a.width/a.height,.1,100);for(var t=0,e=u.renderList.length;t<e;t++){var c=u.renderList[t];u.update(c,i),r.bindBuffer(r.ARRAY_BUFFER,c.geometry.vertices.buffer),r.enableVertexAttribArray(s.attribute.vec3.aVertexPosition),r.vertexAttribPointer(s.attribute.vec3.aVertexPosition,c.geometry.vertices.itemSize,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,c.geometry.colors.buffer),r.enableVertexAttribArray(s.attribute.vec4.aVertexColor),r.vertexAttribPointer(s.attribute.vec4.aVertexColor,c.geometry.colors.itemSize,r.FLOAT,!1,0,0),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,c.geometry.indices.buffer),r.uniformMatrix4fv(s.uniform.mat4.uPMatrix,!1,o),r.uniformMatrix4fv(s.uniform.mat4.uMVMatrix,!1,i),r.drawElements(r.TRIANGLES,c.geometry.indices.numItems,r.UNSIGNED_SHORT,0)}},u}}]),e}(l.default);e.default=c},function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),s=r(3),l=a(s),c=function(t){function e(t,r,a,i,u){n(this,e);var s=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,a,i,u));return console.log("In ShaderTexture class"),s}return i(e,t),u(e,[{key:"vsSrc",value:function(){var t=["attribute vec3 aVertexPosition;","attribute vec3 aVertexNormal;","attribute vec2 aTextureCoord;","uniform mat4 uMVMatrix;","uniform mat4 uPMatrix;","uniform mat3 uNMatrix;","uniform vec3 uAmbientColor;","uniform vec3 uLightingDirection;","uniform vec3 uDirectionalColor;","uniform bool uUseLighting;","varying vec2 vTextureCoord;","varying vec3 vLightWeighting;","void main(void) {","    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);","    vTextureCoord = aTextureCoord;","   if(!uUseLighting) {","       vLightWeighting = vec3(1.0, 1.0, 1.0);","   } else {","       vec3 transformedNormal = uNMatrix * aVertexNormal;","       float directionalLightWeighting = max(dot(transformedNormal, uLightingDirection), 0.0);","       vLightWeighting = uAmbientColor + uDirectionalColor * directionalLightWeighting;","   }","}"];return{code:t.join("\n"),varList:this.webgl.createVarList(t)}}},{key:"fsSrc",value:function(){var t=[this.floatp,"varying vec2 vTextureCoord;","varying vec3 vLightWeighting;","uniform sampler2D uSampler;","void main(void) {","    vec4 textureColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));","    gl_FragColor = vec4(textureColor.rgb * vLightWeighting, textureColor.a);","}"];return{code:t.join("\n"),varList:this.webgl.createVarList(t)}}},{key:"init",value:function(t){var e=this.setup(),r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],u=e[5],s=e[6],l=e[7],c=e[8],f=e[9],h=l.shaderProgram;window.vs3Vars=c;var d=!0,m=[.1,.1,.1],M=[-.25,-.5,-.1],g=[.7,.7,.7],v=o.create(),x=i.create();return l.renderList=t||[],l.update=function(t){t.setMV(s),i.normalize(x,M),i.scale(x,x,-1),o.normalFromMat4(v,s)},l.render=function(){r.useProgram(h),n.perspective(u,.4*Math.PI,a.width/a.height,.1,100);for(var t=0,e=l.renderList.length;t<e;t++){var o=l.renderList[t];o.textures[0]&&o.textures[0].texture&&(l.update(o,s),r.bindBuffer(r.ARRAY_BUFFER,o.geometry.vertices.buffer),r.enableVertexAttribArray(c.attribute.vec3.aVertexPosition),r.vertexAttribPointer(c.attribute.vec3.aVertexPosition,o.geometry.vertices.itemSize,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,o.geometry.normals.buffer),r.enableVertexAttribArray(c.attribute.vec3.aVertexNormal),r.vertexAttribPointer(c.attribute.vec3.aVertexNormal,o.geometry.normals.itemSize,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,o.geometry.texCoords.buffer),r.enableVertexAttribArray(c.attribute.vec2.aTextureCoord),r.vertexAttribPointer(c.attribute.vec2.aTextureCoord,o.geometry.texCoords.itemSize,r.FLOAT,!1,0,0),
r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,null),r.bindTexture(r.TEXTURE_2D,o.textures[0].texture),r.uniform1i(f.uniform.sampler2D.uSampler,0),r.uniform1i(c.uniform.bool.uUseLighting,d),d&&(r.uniform3f(c.uniform.vec3.uAmbientColor,m[0],m[1],m[2]),r.uniform3fv(c.uniform.vec3.uLightingDirection,x),r.uniform3f(c.uniform.vec3.uDirectionalColor,g[0],g[1],g[2])),r.uniformMatrix3fv(c.uniform.mat3.uNMatrix,!1,v),r.uniformMatrix4fv(c.uniform.mat4.uPMatrix,!1,u),r.uniformMatrix4fv(c.uniform.mat4.uMVMatrix,!1,s),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,o.geometry.indices.buffer),r.drawElements(r.TRIANGLES,o.geometry.indices.numItems,r.UNSIGNED_SHORT,0))}},l}}]),e}(l.default);e.default=c},function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=r(3),s=a(u),l=function(t){function e(t,r,a,i,u){n(this,e);var s=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,a,i,u));return console.log("In ShaderMetal class"),s}return i(e,t),e}(s.default);e.default=l},function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),s=r(3),l=a(s),c=function(t){function e(t,r,a,i,u){n(this,e);var s=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,a,i,u));return console.log("In ShaderTexture class"),s}return i(e,t),u(e,[{key:"vsSrc",value:function(){var t=["attribute vec3 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat4 uMVMatrix;","uniform mat4 uPMatrix;","varying vec2 vTextureCoord;","void main(void) {","    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);","    vTextureCoord = aTextureCoord;","}"];return{code:t.join("\n"),varList:this.webgl.createVarList(t)}}},{key:"fsSrc",value:function(){var t=[this.floatp,"varying vec2 vTextureCoord;","uniform sampler2D uSampler;","void main(void) {","    gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));","}"];return{code:t.join("\n"),varList:this.webgl.createVarList(t)}}},{key:"init",value:function(t){var e=this.setup(),r=e[0],a=e[1],n=e[2],o=(e[3],e[4],e[5]),i=e[6],u=e[7],s=e[8],l=e[9],c=u.shaderProgram;return window.vs1Vars=s,u.renderList=t||[],u.update=function(t){t.setMV(i)},u.render=function(){r.useProgram(c),n.perspective(o,.4*Math.PI,a.width/a.height,.1,100);for(var t=0,e=u.renderList.length;t<e;t++){var f=u.renderList[t];f.textures[0]&&f.textures[0].texture&&(u.update(f,i),r.bindBuffer(r.ARRAY_BUFFER,f.geometry.vertices.buffer),r.enableVertexAttribArray(s.attribute.vec3.aVertexPosition),r.vertexAttribPointer(s.attribute.vec3.aVertexPosition,f.geometry.vertices.itemSize,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,f.geometry.texCoords.buffer),r.enableVertexAttribArray(s.attribute.vec2.aTextureCoord),r.vertexAttribPointer(s.attribute.vec2.aTextureCoord,f.geometry.texCoords.itemSize,r.FLOAT,!1,0,0),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,null),r.bindTexture(r.TEXTURE_2D,f.textures[0].texture),r.uniform1i(l.uniform.sampler2D.uSampler,0),r.uniformMatrix4fv(s.uniform.mat4.uPMatrix,!1,o),r.uniformMatrix4fv(s.uniform.mat4.uMVMatrix,!1,i),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,f.geometry.indices.buffer),r.drawElements(r.TRIANGLES,f.geometry.indices.numItems,r.UNSIGNED_SHORT,0))}},u}}]),e}(l.default);e.default=c},function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=r(3),s=a(u),l=function(t){function e(t,r,a,i,u){n(this,e);var s=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,a,i,u));return console.log("In ShaderWater class"),s}return i(e,t),e}(s.default);e.default=l},function(t,e){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),n=function(){function t(){r(this,t),console.log("in Util"),this.setPerformance()}return a(t,[{key:"setPerformance",value:function(){!1 in window&&(window.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},!1 in window.performance&&!function(){var t=Date.now();performance.timing&&performance.timing.navigationStart&&(t=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-t}}()}},{key:"isString",value:function(t){return"string"==typeof t||isObjectLike(t)&&objToString.call(t)==stringTag||!1}},{key:"isIFrame",value:function(){try{return window.self!==window.top}catch(t){return!0}return!1}},{key:"isPowerOfTwo",value:function(t){return 0===(t&t-1)}},{key:"degToRad",value:function(t){return t*Math.PI/180}},{key:"getArr",value:function(t,e,r){if(!t||e<0||r<1)return console.error("getArr() invalid params, arr:"+t+", index:"+e+" size:"+r),-1;for(var a=[],n=2;n<r;n++)a.push(t[e*r+n]);return a}},{key:"setArr",value:function(t,e){var r=arguments.length;if(r<3)return console.error("no value or index specified"),-1;for(var a=r-2,n=2;n<r;n++)t[idx*a+n]-arguments[n];return idx}},{key:"flatten",value:function(t,e){e!==!0&&e!==!1&&(e=!1);for(var r=e&&t||t.slice(),a=[],n=r.shift();void 0!==n;n=r.shift())Array.isArray(n)?r.unshift.apply(r,n):a.push(n);return a}},{key:"concatArr",value:function(t,e){var r=null;if(t.type){var a=t.length;switch(t.type){case"Float32Array":r=new Float32Array(a+second.length),e.type!==t.type&&(e=Float32Array.from(e));break;case"Uint16Array":r=new Uint16Array(a+second.length),e.type!==t.type&&(e=Uint16Array.from(e))}r.set(t),r.set(e,a)}else if(e.type){for(var n=0;n<e.length;n++)t.push(e[n]);r=t}else r=t.concat(e);return r}},{key:"getSeed",value:function(){var t=void 0;try{if(Uint32Array&&window.crypto&&window.crypto.getRandomValues){var e=new Uint32Array(1);window.crypto.getRandomValues(e),t=e.length?e[0]+"":null}}catch(t){}finally{t||(t=Math.floor(1e9*Math.random()).toString()+(new Date).getTime())}return t}},{key:"getRand",value:function(t,e){return void 0!==t&&void 0!==e||(e=1,t=0),t+(Math.random()+1/(1+this.getSeed()))%1*(e-t)}},{key:"getRandInt",value:function(t){return Math.floor(Math.random()*t)}},{key:"randomColor",value:function(){return[Math.abs(Math.random()),Math.abs(Math.random()),Math.abs(Math.random())]}},{key:"getFileExtension",value:function(t){return t.slice((t.lastIndexOf(".")-1>>>0)+2).toLowerCase()}}]),t}();e.default=n},function(t,e){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),n=function(){function t(e,a,n,o){r(this,t),console.log("in webGL class"),this.gl=null,this.contextCount=0,this.glVers=0,this.glMatrix=a,this.util=n,e===!0&&this.init(canvas),o&&(this.debug=o)}return a(t,[{key:"clearTextures",value:function(){for(var t=this.gl,e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),r=0;r<e;r++)t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,null),t.bindTexture(t.TEXTURE_CUBE_MAP,null);t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null)}},{key:"init",value:function(t,e,r){var a=this;if(t?t=this.util.isString(t)?document.getElementById(t):t:(t=document.createElement("canvas"),t.width=480,t.height=320,document.body.appendChild(t)),t){var n=t.getBoundingClientRect();if(t.width=n.width,t.height=n.height,this.gl=this.createContext(t),this.gl){var o=this.gl;if(t.addEventListener("webglcontextlost",function(t){console.error("error: webglcontextlost event, context count:"+a.contextCount),e&&(a.gl=null,e(t)),t.preventDefault()},!1),t.addEventListener("webglcontextrestored",function(t){console.error("error: webglcontextrestored event, context count:"+a.contextCount),r&&r(t),t.preventDefault()},!1),o.viewportWidth=t.width,o.viewportHeight=t.height,window.addEventListener("resize",function(t){a.resizeCanvas(),t.preventDefault()},!1),o.getParameter&&o.getShaderPrecisionFormat){this.stats={};var i=this.stats;i.highp=o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_FLOAT).precision,i.maxTexSize=o.getParameter(o.MAX_TEXTURE_SIZE),i.maxCubeSize=o.getParameter(o.MAX_CUBE_MAP_TEXTURE_SIZE),i.maxRenderbufferSize=o.getParameter(o.MAX_RENDERBUFFER_SIZE),i.combinedUnits=o.getParameter(o.MAX_COMBINED_TEXTURE_IMAGE_UNITS),i.maxVSattribs=o.getParameter(o.MAX_VERTEX_ATTRIBS),i.maxVertexShader=o.getParameter(o.MAX_VERTEX_UNIFORM_VECTORS),i.maxFragmentShader=o.getParameter(o.MAX_FRAGMENT_UNIFORM_VECTORS)}else this.stats=!1;return this.clearTextures(),o.enable(o.DEPTH_TEST),o.enable(o.CULL_FACE),o.clearDepth(1),o.depthFunc(o.LEQUAL),o.enable(o.BLEND),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),o.clearColor(.1,.1,.1,1),this.gl}}return null}},{key:"stats",value:function(){}},{key:"getCanvas",value:function(){return this.gl?this.gl.canvas:null}},{key:"resizeCanvas",value:function(){if(this.ready()){var t=Math.max(window.devicePixelRatio,1),e=this.getContext(),r=this.getCanvas(),a=r.clientWidth*t|0,n=r.clientHeight*t|0;if(r.width!==a||r.height!==n)return r.width=a,r.height=n,e.viewportWidth=r.width,e.viewportHeight=r.height,e.viewport(0,0,e.viewportWidth,e.viewportHeight),!0}return!1}},{key:"createContext",value:function(t){if(!window.WebGLRenderingContext)return console.error("this browser does not support webgl"),null;var e=null;e&&this.contextCount>0&&(console.warn("killing context"),this.killContext(),this.contextCount--,this.gl=null);for(var r=["webgl2","experimental-webgl2","webgl","experimental-webgl"],a=0;a<r.length;){try{if(this.debug){if(e=this.debug.makeDebugContext(t.getContext(r[a]))){console.warn("using debug context"),"function"!==e.getParameter&&(e=t.getContext(r[a]),console.warn("unable to use debug context, trying release:"+r[a]," getParameter:"+e.getParameter));break}}else if(e=t.getContext(r[a])){console.warn("using release context mode:"+r[a]);break}}catch(t){console.warn("failed to load context:"+r[a])}a++}if(e&&"function"==typeof e.getParameter)switch(this.contextCount++,this.gl=e,this.glVers=e.getParameter(e.VERSION).toLowerCase(),1!=a&&3!=a||console.warn("experimental context, .getParameter() may not work"),console.log("version:"+e.getParameter(e.VERSION)),a){case 0:case 1:this.glVers=2;break;case 2:case 3:this.glVers=1,this.addVertexBufferSupport(e)}return this.gl}},{key:"getContext",value:function(){return this.gl||console.warn("warning webgl context not initialized"),this.gl}},{key:"killContext",value:function(){console.log("in killcontext, count:"+this.contextCount),this.contextCount&&(console.log("killing WebGL context, count before:"+this.contextCount),this.gl.getExtension("WEBGL_lose_context").loseContext(),this.contextCount--)}},{key:"ready",value:function(){this.gl;return!(!this.gl||!this.glMatrix)}},{key:"clear",value:function(){var t=this.gl;t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)}},{key:"addVertexBufferSupport",value:function(t){var e=t.getExtension("OES_vertex_array_object");e&&(t.createVertexArray=function(){return e.createVertexArrayOES()},t.deleteVertexArray=function(t){e.deleteVertexArrayOES(t)},t.isVertexArray=function(t){return e.isVertexArrayOES(t)},t.bindVertexArray=function(t){e.bindVertexArrayOES(t)},t.VERTEX_ARRAY_BINDING=e.VERTEX_ARRAY_BINDING_OES)}},{key:"createShader",value:function(t,e){var r=null;if(t&&e){if(this.ready()){var a=this.gl;e.replace(/^[ \t]*\n/,""),t===a.VERTEX_SHADER?r=a.createShader(t):t===a.FRAGMENT_SHADER?r=a.createShader(t):console.error("createShader: type not recognized:"+t),a.shaderSource(r,e),a.compileShader(r),a.getShaderParameter(r,a.COMPILE_STATUS)||(console.error("createShader:"+a.getShaderInfoLog(r)),r=null)}}else console.error("createShader: invalid params, type:"+t+" source:"+e);return r}},{key:"createVertexShader",value:function(t){return this.createShader(this.gl.VERTEX_SHADER,t)}},{key:"createFragmentShader",value:function(t){return this.createShader(this.gl.FRAGMENT_SHADER,t)}},{key:"fetchShader",value:function(t,e){var r=this;return fetch(e,{method:"POST",mode:"cors",redirect:"follow",headers:new Headers({"Content-Type":"text/plain"})}).then(function(t){return console.log(text),!!t.ok&&t.text()}).then(function(e){if(e)return r.createShader(t,e)}),null}},{key:"fetchVertexShader",value:function(t){return this.fetchShader(this.gl.VERTEX_SHADER,t)}},{key:"fetchFragmentShader",value:function(t){return this.fetchShader(this.gl.FRAGMENT_SHADER,t)}},{key:"createShaderFromTag",value:function(t){if(this.util.isString(t)&&(t=document.getElementById(t)),!t)return console.error("createShaderFromTag: not found ("+t+")"),!1;var e=null;if("x-shader/x-vertex"==t.type)e=this.gl.VERTEX_SHADER;else{if("x-shader/x-fragment"!=t.type)return console.error("createShaderFromTag: type not found:("+t.type+")"),null;e=this.gl.FRAGMENT_SHADER}for(var r="",a=t.firstChild;a;)3==a.nodeType&&(r+=a.textContent),a=a.nextSibling;return this.createShader(e,r)}},{key:"createProgram",value:function(t,e){if(!t||!e)return console.error("createProgram: parameter error, vs:"+t+" fs:"+e),null;var r={};if(this.ready()){var a=this.gl,n=this.createVertexShader(t.code),o=this.createFragmentShader(e.code),i=a.createProgram();a.attachShader(i,n),a.attachShader(i,o),a.linkProgram(i),a.getProgramParameter(i,a.LINK_STATUS)?(r.shaderProgram=i,r.vsVars=t.varList,r.fsVars=e.varList):(console.error("createProgram:"+a.getProgramInfoLog(i)),this.checkShaders(t,e,i))}return r}},{key:"createVarList",value:function(t){var e=t.length,r=" ",a={},n=["attribute","uniform","varying"];if(e)for(var o=0;o<e;o++){var i=t[o];if(i.indexOf("void main")!==-1)break;for(var u=0;u<n.length;u++){var s=n[u];if(a[s]||(a[s]={}),i.indexOf(s)>-1){i=i.replace(/;\s*$/,""),i=i.split(r);var l=i.shift();a[l]||(a[l]={});var c=i.shift();a[l][c]||(a[l][c]={});var f=i.shift();a[l][c][f]||(a[l][c][f]="empty")}}}return a}},{key:"setAttributeArrays",value:function(t,e){var r=this.gl;for(var a in e){var n=e[a];for(var o in n)n[o]=r.getAttribLocation(t,o)}return e}},{key:"setUniformLocations",value:function(t,e){var r=this.gl;for(var a in e){var n=e[a];for(var o in n)n[o]=r.getUniformLocation(t,o)}return e}},{key:"bindAttributeLocations",value:function(t,e){var r=this.gl;if(e)for(var a in e)console.log("binding attribute:"+a+" to:"+e[a]),r.bindAttribLocation(t,e[a],a);else console.warn("webgl.bindAttributes: no attributes supplied")}},{key:"getAttributes",value:function(t){for(var e=this.gl,r={},a=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),n=0;n<a;n++){var o=e.getActiveAttrib(t,n);r[o.name]=e.getAttribLocation(t,o.name)}return r.count=a,r}},{key:"getUniforms",value:function(t){for(var e=this.gl,r={},a=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n="",o=0;o<a;o++){var i=e.getActiveUniform(t,o);n=i.name.replace("[0]",""),console.log("adding uniform:"+n),r[n]=e.getUniformLocation(t,n)}return r.count=a,r}},{key:"getVarying",value:function(t){}},{key:"checkShaders",value:function(t,e,r){var a=this.gl;return!!a.getProgramParameter(r,a.LINK_STATUS)||(t&&!a.getShaderParameter(t,a.COMPILE_STATUS)?console.error("error creating the vertex shader, "+a.getShaderInfoLog(t)):e&&!a.getShaderParameter(e,a.COMPILE_STATUS)?console.error("error creating the fragment shader, "+a.getShaderInfoLog(e)):console.error("error in gl program linking"),a.deleteProgram(r),!1)}},{key:"checkBufferObjects",value:function(t){return t&&t instanceof ArrayBuffer}}]),t}();e.default=n},function(t,e){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),n=function(){function t(e,a,n,o){r(this,t),console.log("in webVR class"),this.util=a,this.glMatrix=n,this.webgl=o,this.init===!0}return a(t,[{key:"init",value:function(){}}]),t}();e.default=n},function(t,e){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),n=function(){function t(e,a,n){r(this,t),console.log("in World class"),this.webgl=e,this.util=e.util,this.prim=a,this.renderer=n,this.canvas=e.getCanvas(),this.glMatrix=e.glMatrix,this.pMatrix=this.glMatrix.mat4.create(),this.mvMatrix=this.glMatrix.mat4.create(),this.last=performance.now(),this.counter=0,this.render=this.render.bind(this)}return a(t,[{key:"resize",value:function(t,e,r){}},{key:"init",value:function(){var t=this.glMatrix.vec3,e=this.glMatrix.vec4,r=this.util;this.textureObjList=[],this.textureObjList.push(this.prim.createPrim(this.prim.typeList.CUBE,"first cube",1,t.fromValues(2,2,2),t.fromValues(10,10,10),t.fromValues(0,0,0),t.fromValues(0,0,0),t.fromValues(r.degToRad(0),r.degToRad(0),r.degToRad(0)),t.fromValues(r.degToRad(1),r.degToRad(1),r.degToRad(1)),["img/crate.png","img/webvr-logo1.png"],e.fromValues(.5,1,.2,1))),this.textureObjList.push(this.prim.createPrim(this.prim.typeList.CUBE,"toji cube",1,t.fromValues(1,1,1),t.fromValues(1,1,1),t.fromValues(5,1,-3),t.fromValues(0,0,0),t.fromValues(r.degToRad(40),r.degToRad(0),r.degToRad(0)),t.fromValues(r.degToRad(0),r.degToRad(1),r.degToRad(0)),["img/webvr-logo2.png"],e.fromValues(.5,1,.2,1))),this.textureObjList.push(this.prim.createPrim(this.prim.typeList.SKYDOME,"SkyDome",1,t.fromValues(2,2,2),t.fromValues(10,10,10),t.fromValues(-4,1.5,-.5),t.fromValues(0,0,0),t.fromValues(r.degToRad(0),r.degToRad(0),r.degToRad(0)),t.fromValues(r.degToRad(.2),r.degToRad(.5),r.degToRad(0)),["img/mozvr-logo2.png"],e.fromValues(.5,1,.2,1))),this.textureObjList.push(this.prim.createPrim(this.prim.typeList.TORUS,"torus",1,t.fromValues(1,1,1),t.fromValues(9,9,9),t.fromValues(-1.8,3,-3.5),t.fromValues(0,0,0),t.fromValues(r.degToRad(20),r.degToRad(0),r.degToRad(0)),t.fromValues(r.degToRad(0),r.degToRad(1),r.degToRad(0)),["img/uv-test.png"],e.fromValues(.5,1,.2,1))),this.vs1=this.renderer.shaderTexture.init(this.textureObjList),this.colorObjList=[],this.colorObjList.push(this.prim.createPrim(this.prim.typeList.CUBE,"colored cube",1,t.fromValues(1,1,1),t.fromValues(3,3,3),t.fromValues(-1,3,-3),t.fromValues(0,0,0),t.fromValues(r.degToRad(20),r.degToRad(0),r.degToRad(0)),t.fromValues(r.degToRad(0),r.degToRad(1),r.degToRad(0)),["img/webvr-logo3.png"],e.fromValues(.5,1,.2,1))),this.vs2=this.renderer.shaderColor.init(this.colorObjList),this.dirlightTextureObjList=[],this.dirlightTextureObjList.push(this.prim.createPrim(this.prim.typeList.CUBE,"lit cube",1,t.fromValues(1,1,1),t.fromValues(1,1,1),t.fromValues(-3,-2,-3),t.fromValues(0,0,0),t.fromValues(r.degToRad(20),r.degToRad(0),r.degToRad(0)),t.fromValues(r.degToRad(0),r.degToRad(1),r.degToRad(0)),["img/webvr-logo4.png"],e.fromValues(.5,1,.2,1))),this.dirlightTextureObjList.push(this.prim.createPrim(this.prim.typeList.TERRAIN,"terrain",1,t.fromValues(2,2,2),t.fromValues(130,5,130),t.fromValues(1.5,-1.5,2),t.fromValues(0,0,0),t.fromValues(r.degToRad(0),r.degToRad(0),r.degToRad(0)),t.fromValues(r.degToRad(1),r.degToRad(0),r.degToRad(0)),["img/mozvr-logo1.png"],e.fromValues(.5,1,.2,1),null)),this.dirlightTextureObjList.push(this.prim.createPrim(this.prim.typeList.PLANE,"a plane",1,t.fromValues(2,2,2),t.fromValues(50,0,50),t.fromValues(0,-2,0),t.fromValues(0,0,0),t.fromValues(r.degToRad(0),r.degToRad(0),r.degToRad(0)),t.fromValues(r.degToRad(.5),r.degToRad(0),r.degToRad(0)),["img/webvr-logo2.png"],e.fromValues(.5,1,.2,1))),this.dirlightTextureObjList.push(this.prim.createPrim(this.prim.typeList.SPHERE,"texsphere",1,t.fromValues(1.5,1.5,1.5),t.fromValues(30,30,30),t.fromValues(-5,-.3,-2),t.fromValues(0,0,0),t.fromValues(r.degToRad(0),r.degToRad(0),r.degToRad(0)),t.fromValues(r.degToRad(0),r.degToRad(.5),r.degToRad(0)),["img/mozvr-logo1.png"],e.fromValues(.5,1,.2,1))),this.dirlightTextureObjList.push(this.prim.createPrim(this.prim.typeList.CUBESPHERE,"cubesphere",1,t.fromValues(3,3,3),t.fromValues(10,10,10),t.fromValues(2.5,-1.5,-2),t.fromValues(0,0,0),t.fromValues(r.degToRad(10),r.degToRad(0),r.degToRad(0)),t.fromValues(r.degToRad(0),r.degToRad(.5),r.degToRad(0)),["img/mozvr-logo1.png"],e.fromValues(.5,1,.2,1))),this.dirlightTextureObjList.push(this.prim.createPrim(this.prim.typeList.ICOSOHEDRON,"icophere",1,t.fromValues(3,3,3),t.fromValues(4,4,4),t.fromValues(-2.5,1.5,-1),t.fromValues(0,0,0),t.fromValues(r.degToRad(0),r.degToRad(0),r.degToRad(0)),t.fromValues(r.degToRad(0),r.degToRad(.5),r.degToRad(0)),["img/mozvr-logo2.png"],e.fromValues(.5,1,.2,1))),this.dirlightTextureObjList.push(this.prim.createPrim(this.prim.typeList.BOTTOMDOME,"TestDome",1,t.fromValues(1,1,1),t.fromValues(10,10,10),t.fromValues(-4,1.5,-.5),t.fromValues(0,0,0),t.fromValues(r.degToRad(0),r.degToRad(0),r.degToRad(0)),t.fromValues(r.degToRad(.2),r.degToRad(.5),r.degToRad(0)),["img/mozvr-logo2.png"],e.fromValues(.5,1,.2,1))),this.dirlightTextureObjList.push(this.prim.createPrim(this.prim.typeList.ICOSPHERE,"icophere",1,t.fromValues(3,3,3),t.fromValues(4,4,4),t.fromValues(1.5,2.5,-1),t.fromValues(0,0,0),t.fromValues(r.degToRad(0),r.degToRad(0),r.degToRad(0)),t.fromValues(r.degToRad(0),r.degToRad(.5),r.degToRad(0)),["img/mozvr-logo2.png"],e.fromValues(.5,1,.2,1))),this.textureObjList.push(this.prim.createPrim(this.prim.typeList.ICOSPHERE,"icoUnity",1,t.fromValues(3,3,3),t.fromValues(4,4,4),t.fromValues(4.5,3.5,-2),t.fromValues(0,0,0),t.fromValues(r.degToRad(0),r.degToRad(0),r.degToRad(0)),t.fromValues(r.degToRad(0),r.degToRad(.5),r.degToRad(0)),["img/uv-test.png"],e.fromValues(.5,1,.2,1))),this.vs3=this.renderer.shaderDirlightTexture.init(this.dirlightTextureObjList),this.render()}},{key:"create",value:function(){}},{key:"update",value:function(){var t=performance.now();t-this.last;this.last=t,this.counter++,this.counter>300&&(this.counter=0)}},{key:"render",value:function(){this.update(),this.webgl.clear(),this.vs3.render(),this.vs2.render(),this.vs1.render(),requestAnimationFrame(this.render)}}]),t}();e.default=n},function(t,e,r){e.glMatrix=r(1),e.mat2=r(27),e.mat2d=r(28),e.mat3=r(5),e.mat4=r(29),e.quat=r(30),e.vec2=r(31),e.vec3=r(6),e.vec4=r(7)},function(t,e,r){var a=r(1),n={};n.create=function(){var t=new a.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},n.clone=function(t){var e=new a.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},n.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},n.fromValues=function(t,e,r,n){var o=new a.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=r,o[3]=n,o},n.set=function(t,e,r,a,n){return t[0]=e,t[1]=r,t[2]=a,t[3]=n,t},n.transpose=function(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},n.invert=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=r*o-n*a;return i?(i=1/i,t[0]=o*i,t[1]=-a*i,t[2]=-n*i,t[3]=r*i,t):null},n.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},n.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},n.multiply=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=r[0],s=r[1],l=r[2],c=r[3];return t[0]=a*u+o*s,t[1]=n*u+i*s,t[2]=a*l+o*c,t[3]=n*l+i*c,t},n.mul=n.multiply,n.rotate=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=a*s+o*u,t[1]=n*s+i*u,t[2]=a*-u+o*s,t[3]=n*-u+i*s,t},n.scale=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=r[0],s=r[1];return t[0]=a*u,t[1]=n*u,t[2]=o*s,t[3]=i*s,t},n.fromRotation=function(t,e){var r=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=r,t[2]=-r,t[3]=a,t},n.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},n.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},n.LDU=function(t,e,r,a){return t[2]=a[2]/a[0],r[0]=a[0],r[1]=a[1],r[3]=a[3]-t[2]*r[1],[t,e,r]},n.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},n.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t},n.sub=n.subtract,n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},n.equals=function(t,e){var r=t[0],n=t[1],o=t[2],i=t[3],u=e[0],s=e[1],l=e[2],c=e[3];return Math.abs(r-u)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-s)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(o-l)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(i-c)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))},n.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},n.multiplyScalarAndAdd=function(t,e,r,a){return t[0]=e[0]+r[0]*a,t[1]=e[1]+r[1]*a,t[2]=e[2]+r[2]*a,t[3]=e[3]+r[3]*a,t},t.exports=n},function(t,e,r){var a=r(1),n={};n.create=function(){var t=new a.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},n.clone=function(t){var e=new a.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},n.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},n.fromValues=function(t,e,r,n,o,i){var u=new a.ARRAY_TYPE(6);return u[0]=t,u[1]=e,u[2]=r,u[3]=n,u[4]=o,u[5]=i,u},n.set=function(t,e,r,a,n,o,i){return t[0]=e,t[1]=r,t[2]=a,t[3]=n,t[4]=o,t[5]=i,t},n.invert=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],u=e[5],s=r*o-a*n;return s?(s=1/s,t[0]=o*s,t[1]=-a*s,t[2]=-n*s,t[3]=r*s,t[4]=(n*u-o*i)*s,t[5]=(a*i-r*u)*s,t):null},n.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},n.multiply=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=e[4],s=e[5],l=r[0],c=r[1],f=r[2],h=r[3],d=r[4],m=r[5];return t[0]=a*l+o*c,t[1]=n*l+i*c,t[2]=a*f+o*h,t[3]=n*f+i*h,t[4]=a*d+o*m+u,t[5]=n*d+i*m+s,t},n.mul=n.multiply,n.rotate=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=e[4],s=e[5],l=Math.sin(r),c=Math.cos(r);return t[0]=a*c+o*l,t[1]=n*c+i*l,t[2]=a*-l+o*c,t[3]=n*-l+i*c,t[4]=u,t[5]=s,t},n.scale=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=e[4],s=e[5],l=r[0],c=r[1];return t[0]=a*l,t[1]=n*l,t[2]=o*c,t[3]=i*c,t[4]=u,t[5]=s,t},n.translate=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=e[4],s=e[5],l=r[0],c=r[1];return t[0]=a,t[1]=n,t[2]=o,t[3]=i,t[4]=a*l+o*c+u,t[5]=n*l+i*c+s,t},n.fromRotation=function(t,e){var r=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=r,t[2]=-r,t[3]=a,t[4]=0,t[5]=0,t},n.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},n.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},n.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},n.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t},n.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t},n.sub=n.subtract,n.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t},n.multiplyScalarAndAdd=function(t,e,r,a){return t[0]=e[0]+r[0]*a,t[1]=e[1]+r[1]*a,t[2]=e[2]+r[2]*a,t[3]=e[3]+r[3]*a,t[4]=e[4]+r[4]*a,t[5]=e[5]+r[5]*a,t},n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},n.equals=function(t,e){var r=t[0],n=t[1],o=t[2],i=t[3],u=t[4],s=t[5],l=e[0],c=e[1],f=e[2],h=e[3],d=e[4],m=e[5];return Math.abs(r-l)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(n-c)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(o-f)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(i-h)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(u-d)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(d))&&Math.abs(s-m)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))},t.exports=n},function(t,e,r){var a=r(1),n={scalar:{},SIMD:{}};n.create=function(){var t=new a.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.clone=function(t){var e=new a.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},n.fromValues=function(t,e,r,n,o,i,u,s,l,c,f,h,d,m,M,g){var v=new a.ARRAY_TYPE(16);return v[0]=t,v[1]=e,v[2]=r,v[3]=n,v[4]=o,v[5]=i,v[6]=u,v[7]=s,v[8]=l,v[9]=c,v[10]=f,v[11]=h,v[12]=d,v[13]=m,v[14]=M,v[15]=g,v},n.set=function(t,e,r,a,n,o,i,u,s,l,c,f,h,d,m,M,g){return t[0]=e,t[1]=r,t[2]=a,t[3]=n,t[4]=o,t[5]=i,t[6]=u,t[7]=s,t[8]=l,t[9]=c,t[10]=f,t[11]=h,t[12]=d,t[13]=m,t[14]=M,t[15]=g,t},n.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.scalar.transpose=function(t,e){if(t===e){var r=e[1],a=e[2],n=e[3],o=e[6],i=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=a,t[9]=o,t[11]=e[14],t[12]=n,t[13]=i,t[14]=u}else t[0]=e[0],
t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},n.SIMD.transpose=function(t,e){var r,a,n,o,i,u,s,l,c,f;return r=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),n=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),i=SIMD.Float32x4.shuffle(r,a,0,1,4,5),u=SIMD.Float32x4.shuffle(n,o,0,1,4,5),s=SIMD.Float32x4.shuffle(i,u,0,2,4,6),l=SIMD.Float32x4.shuffle(i,u,1,3,5,7),SIMD.Float32x4.store(t,0,s),SIMD.Float32x4.store(t,4,l),i=SIMD.Float32x4.shuffle(r,a,2,3,6,7),u=SIMD.Float32x4.shuffle(n,o,2,3,6,7),c=SIMD.Float32x4.shuffle(i,u,0,2,4,6),f=SIMD.Float32x4.shuffle(i,u,1,3,5,7),SIMD.Float32x4.store(t,8,c),SIMD.Float32x4.store(t,12,f),t},n.transpose=a.USE_SIMD?n.SIMD.transpose:n.scalar.transpose,n.scalar.invert=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],u=e[5],s=e[6],l=e[7],c=e[8],f=e[9],h=e[10],d=e[11],m=e[12],M=e[13],g=e[14],v=e[15],x=r*u-a*i,p=r*s-n*i,b=r*l-o*i,y=a*s-n*u,S=a*l-o*u,I=n*l-o*s,D=c*M-f*m,w=c*g-h*m,E=c*v-d*m,T=f*g-h*M,F=f*v-d*M,R=h*v-d*g,P=x*R-p*F+b*T+y*E-S*w+I*D;return P?(P=1/P,t[0]=(u*R-s*F+l*T)*P,t[1]=(n*F-a*R-o*T)*P,t[2]=(M*I-g*S+v*y)*P,t[3]=(h*S-f*I-d*y)*P,t[4]=(s*E-i*R-l*w)*P,t[5]=(r*R-n*E+o*w)*P,t[6]=(g*b-m*I-v*p)*P,t[7]=(c*I-h*b+d*p)*P,t[8]=(i*F-u*E+l*D)*P,t[9]=(a*E-r*F-o*D)*P,t[10]=(m*S-M*b+v*x)*P,t[11]=(f*b-c*S-d*x)*P,t[12]=(u*w-i*T-s*D)*P,t[13]=(r*T-a*w+n*D)*P,t[14]=(M*p-m*y-g*x)*P,t[15]=(c*y-f*p+h*x)*P,t):null},n.SIMD.invert=function(t,e){var r,a,n,o,i,u,s,l,c,f,h=SIMD.Float32x4.load(e,0),d=SIMD.Float32x4.load(e,4),m=SIMD.Float32x4.load(e,8),M=SIMD.Float32x4.load(e,12);return i=SIMD.Float32x4.shuffle(h,d,0,1,4,5),a=SIMD.Float32x4.shuffle(m,M,0,1,4,5),r=SIMD.Float32x4.shuffle(i,a,0,2,4,6),a=SIMD.Float32x4.shuffle(a,i,1,3,5,7),i=SIMD.Float32x4.shuffle(h,d,2,3,6,7),o=SIMD.Float32x4.shuffle(m,M,2,3,6,7),n=SIMD.Float32x4.shuffle(i,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,i,1,3,5,7),i=SIMD.Float32x4.mul(n,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),u=SIMD.Float32x4.mul(a,i),s=SIMD.Float32x4.mul(r,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),u),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),i=SIMD.Float32x4.mul(a,n),i=SIMD.Float32x4.swizzle(i,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),u),c=SIMD.Float32x4.mul(r,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(o,i)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),i=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,2,3,0,1),o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),n=SIMD.Float32x4.swizzle(n,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,i),u),l=SIMD.Float32x4.mul(r,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(n,i)),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),i=SIMD.Float32x4.mul(r,a),i=SIMD.Float32x4.swizzle(i,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),l),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,i),c),i=SIMD.Float32x4.swizzle(i,2,3,0,1),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,i),l),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(n,i)),i=SIMD.Float32x4.mul(r,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(n,i)),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),l),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,i),s),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(a,i)),i=SIMD.Float32x4.mul(r,n),i=SIMD.Float32x4.swizzle(i,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),s),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(a,i)),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(o,i)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),c),f=SIMD.Float32x4.mul(r,u),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,2,3,0,1),f),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,1,0,3,2),f),i=SIMD.Float32x4.reciprocalApproximation(f),f=SIMD.Float32x4.sub(SIMD.Float32x4.add(i,i),SIMD.Float32x4.mul(f,SIMD.Float32x4.mul(i,i))),(f=SIMD.Float32x4.swizzle(f,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(f,u)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(f,s)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(f,l)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(f,c)),t):null},n.invert=a.USE_SIMD?n.SIMD.invert:n.scalar.invert,n.scalar.adjoint=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],u=e[5],s=e[6],l=e[7],c=e[8],f=e[9],h=e[10],d=e[11],m=e[12],M=e[13],g=e[14],v=e[15];return t[0]=u*(h*v-d*g)-f*(s*v-l*g)+M*(s*d-l*h),t[1]=-(a*(h*v-d*g)-f*(n*v-o*g)+M*(n*d-o*h)),t[2]=a*(s*v-l*g)-u*(n*v-o*g)+M*(n*l-o*s),t[3]=-(a*(s*d-l*h)-u*(n*d-o*h)+f*(n*l-o*s)),t[4]=-(i*(h*v-d*g)-c*(s*v-l*g)+m*(s*d-l*h)),t[5]=r*(h*v-d*g)-c*(n*v-o*g)+m*(n*d-o*h),t[6]=-(r*(s*v-l*g)-i*(n*v-o*g)+m*(n*l-o*s)),t[7]=r*(s*d-l*h)-i*(n*d-o*h)+c*(n*l-o*s),t[8]=i*(f*v-d*M)-c*(u*v-l*M)+m*(u*d-l*f),t[9]=-(r*(f*v-d*M)-c*(a*v-o*M)+m*(a*d-o*f)),t[10]=r*(u*v-l*M)-i*(a*v-o*M)+m*(a*l-o*u),t[11]=-(r*(u*d-l*f)-i*(a*d-o*f)+c*(a*l-o*u)),t[12]=-(i*(f*g-h*M)-c*(u*g-s*M)+m*(u*h-s*f)),t[13]=r*(f*g-h*M)-c*(a*g-n*M)+m*(a*h-n*f),t[14]=-(r*(u*g-s*M)-i*(a*g-n*M)+m*(a*s-n*u)),t[15]=r*(u*h-s*f)-i*(a*h-n*f)+c*(a*s-n*u),t},n.SIMD.adjoint=function(t,e){var r,a,n,o,i,u,s,l,c,f,h,d,m,r=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),n=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12);return c=SIMD.Float32x4.shuffle(r,a,0,1,4,5),u=SIMD.Float32x4.shuffle(n,o,0,1,4,5),i=SIMD.Float32x4.shuffle(c,u,0,2,4,6),u=SIMD.Float32x4.shuffle(u,c,1,3,5,7),c=SIMD.Float32x4.shuffle(r,a,2,3,6,7),l=SIMD.Float32x4.shuffle(n,o,2,3,6,7),s=SIMD.Float32x4.shuffle(c,l,0,2,4,6),l=SIMD.Float32x4.shuffle(l,c,1,3,5,7),c=SIMD.Float32x4.mul(s,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.mul(u,c),h=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,c),f),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),c=SIMD.Float32x4.mul(u,s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),f),m=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(l,c)),m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),m),m=SIMD.Float32x4.swizzle(m,2,3,0,1),c=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,3,0,1),l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),s=SIMD.Float32x4.swizzle(s,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),f),d=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(s,c)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),c=SIMD.Float32x4.mul(i,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),d),m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),m),c=SIMD.Float32x4.swizzle(c,2,3,0,1),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,c),d),m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(s,c)),c=SIMD.Float32x4.mul(i,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(s,c)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),d),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),h),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(u,c)),c=SIMD.Float32x4.mul(i,s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),h),m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(u,c)),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(l,c)),m=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),m),SIMD.Float32x4.store(t,0,f),SIMD.Float32x4.store(t,4,h),SIMD.Float32x4.store(t,8,d),SIMD.Float32x4.store(t,12,m),t},n.adjoint=a.USE_SIMD?n.SIMD.adjoint:n.scalar.adjoint,n.determinant=function(t){var e=t[0],r=t[1],a=t[2],n=t[3],o=t[4],i=t[5],u=t[6],s=t[7],l=t[8],c=t[9],f=t[10],h=t[11],d=t[12],m=t[13],M=t[14],g=t[15],v=e*i-r*o,x=e*u-a*o,p=e*s-n*o,b=r*u-a*i,y=r*s-n*i,S=a*s-n*u,I=l*m-c*d,D=l*M-f*d,w=l*g-h*d,E=c*M-f*m,T=c*g-h*m,F=f*g-h*M;return v*F-x*T+p*E+b*w-y*D+S*I},n.SIMD.multiply=function(t,e,r){var a=SIMD.Float32x4.load(e,0),n=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),u=SIMD.Float32x4.load(r,0),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,3,3,3,3),i))));SIMD.Float32x4.store(t,0,s);var l=SIMD.Float32x4.load(r,4),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,3,3,3,3),i))));SIMD.Float32x4.store(t,4,c);var f=SIMD.Float32x4.load(r,8),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),i))));SIMD.Float32x4.store(t,8,h);var d=SIMD.Float32x4.load(r,12),m=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,0,0,0,0),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,3,3,3,3),i))));return SIMD.Float32x4.store(t,12,m),t},n.scalar.multiply=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=e[4],s=e[5],l=e[6],c=e[7],f=e[8],h=e[9],d=e[10],m=e[11],M=e[12],g=e[13],v=e[14],x=e[15],p=r[0],b=r[1],y=r[2],S=r[3];return t[0]=p*a+b*u+y*f+S*M,t[1]=p*n+b*s+y*h+S*g,t[2]=p*o+b*l+y*d+S*v,t[3]=p*i+b*c+y*m+S*x,p=r[4],b=r[5],y=r[6],S=r[7],t[4]=p*a+b*u+y*f+S*M,t[5]=p*n+b*s+y*h+S*g,t[6]=p*o+b*l+y*d+S*v,t[7]=p*i+b*c+y*m+S*x,p=r[8],b=r[9],y=r[10],S=r[11],t[8]=p*a+b*u+y*f+S*M,t[9]=p*n+b*s+y*h+S*g,t[10]=p*o+b*l+y*d+S*v,t[11]=p*i+b*c+y*m+S*x,p=r[12],b=r[13],y=r[14],S=r[15],t[12]=p*a+b*u+y*f+S*M,t[13]=p*n+b*s+y*h+S*g,t[14]=p*o+b*l+y*d+S*v,t[15]=p*i+b*c+y*m+S*x,t},n.multiply=a.USE_SIMD?n.SIMD.multiply:n.scalar.multiply,n.mul=n.multiply,n.scalar.translate=function(t,e,r){var a,n,o,i,u,s,l,c,f,h,d,m,M=r[0],g=r[1],v=r[2];return e===t?(t[12]=e[0]*M+e[4]*g+e[8]*v+e[12],t[13]=e[1]*M+e[5]*g+e[9]*v+e[13],t[14]=e[2]*M+e[6]*g+e[10]*v+e[14],t[15]=e[3]*M+e[7]*g+e[11]*v+e[15]):(a=e[0],n=e[1],o=e[2],i=e[3],u=e[4],s=e[5],l=e[6],c=e[7],f=e[8],h=e[9],d=e[10],m=e[11],t[0]=a,t[1]=n,t[2]=o,t[3]=i,t[4]=u,t[5]=s,t[6]=l,t[7]=c,t[8]=f,t[9]=h,t[10]=d,t[11]=m,t[12]=a*M+u*g+f*v+e[12],t[13]=n*M+s*g+h*v+e[13],t[14]=o*M+l*g+d*v+e[14],t[15]=i*M+c*g+m*v+e[15]),t},n.SIMD.translate=function(t,e,r){var a=SIMD.Float32x4.load(e,0),n=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),u=SIMD.Float32x4(r[0],r[1],r[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(u,0,0,0,0)),n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(u,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(u,2,2,2,2));var s=SIMD.Float32x4.add(a,SIMD.Float32x4.add(n,SIMD.Float32x4.add(o,i)));return SIMD.Float32x4.store(t,12,s),t},n.translate=a.USE_SIMD?n.SIMD.translate:n.scalar.translate,n.scalar.scale=function(t,e,r){var a=r[0],n=r[1],o=r[2];return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},n.SIMD.scale=function(t,e,r){var a,n,o,i=SIMD.Float32x4(r[0],r[1],r[2],0);return a=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(i,0,0,0,0))),n=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(i,1,1,1,1))),o=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(i,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},n.scale=a.USE_SIMD?n.SIMD.scale:n.scalar.scale,n.rotate=function(t,e,r,n){var o,i,u,s,l,c,f,h,d,m,M,g,v,x,p,b,y,S,I,D,w,E,T,F,R=n[0],P=n[1],A=n[2],_=Math.sqrt(R*R+P*P+A*A);return Math.abs(_)<a.EPSILON?null:(_=1/_,R*=_,P*=_,A*=_,o=Math.sin(r),i=Math.cos(r),u=1-i,s=e[0],l=e[1],c=e[2],f=e[3],h=e[4],d=e[5],m=e[6],M=e[7],g=e[8],v=e[9],x=e[10],p=e[11],b=R*R*u+i,y=P*R*u+A*o,S=A*R*u-P*o,I=R*P*u-A*o,D=P*P*u+i,w=A*P*u+R*o,E=R*A*u+P*o,T=P*A*u-R*o,F=A*A*u+i,t[0]=s*b+h*y+g*S,t[1]=l*b+d*y+v*S,t[2]=c*b+m*y+x*S,t[3]=f*b+M*y+p*S,t[4]=s*I+h*D+g*w,t[5]=l*I+d*D+v*w,t[6]=c*I+m*D+x*w,t[7]=f*I+M*D+p*w,t[8]=s*E+h*T+g*F,t[9]=l*E+d*T+v*F,t[10]=c*E+m*T+x*F,t[11]=f*E+M*T+p*F,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},n.scalar.rotateX=function(t,e,r){var a=Math.sin(r),n=Math.cos(r),o=e[4],i=e[5],u=e[6],s=e[7],l=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*n+l*a,t[5]=i*n+c*a,t[6]=u*n+f*a,t[7]=s*n+h*a,t[8]=l*n-o*a,t[9]=c*n-i*a,t[10]=f*n-u*a,t[11]=h*n-s*a,t},n.SIMD.rotateX=function(t,e,r){var a=SIMD.Float32x4.splat(Math.sin(r)),n=SIMD.Float32x4.splat(Math.cos(r));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(i,a))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,n),SIMD.Float32x4.mul(o,a))),t},n.rotateX=a.USE_SIMD?n.SIMD.rotateX:n.scalar.rotateX,n.scalar.rotateY=function(t,e,r){var a=Math.sin(r),n=Math.cos(r),o=e[0],i=e[1],u=e[2],s=e[3],l=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n-l*a,t[1]=i*n-c*a,t[2]=u*n-f*a,t[3]=s*n-h*a,t[8]=o*a+l*n,t[9]=i*a+c*n,t[10]=u*a+f*n,t[11]=s*a+h*n,t},n.SIMD.rotateY=function(t,e,r){var a=SIMD.Float32x4.splat(Math.sin(r)),n=SIMD.Float32x4.splat(Math.cos(r));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(i,a))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,n))),t},n.rotateY=a.USE_SIMD?n.SIMD.rotateY:n.scalar.rotateY,n.scalar.rotateZ=function(t,e,r){var a=Math.sin(r),n=Math.cos(r),o=e[0],i=e[1],u=e[2],s=e[3],l=e[4],c=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n+l*a,t[1]=i*n+c*a,t[2]=u*n+f*a,t[3]=s*n+h*a,t[4]=l*n-o*a,t[5]=c*n-i*a,t[6]=f*n-u*a,t[7]=h*n-s*a,t},n.SIMD.rotateZ=function(t,e,r){var a=SIMD.Float32x4.splat(Math.sin(r)),n=SIMD.Float32x4.splat(Math.cos(r));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(i,a))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,n),SIMD.Float32x4.mul(o,a))),t},n.rotateZ=a.USE_SIMD?n.SIMD.rotateZ:n.scalar.rotateZ,n.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},n.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromRotation=function(t,e,r){var n,o,i,u=r[0],s=r[1],l=r[2],c=Math.sqrt(u*u+s*s+l*l);return Math.abs(c)<a.EPSILON?null:(c=1/c,u*=c,s*=c,l*=c,n=Math.sin(e),o=Math.cos(e),i=1-o,t[0]=u*u*i+o,t[1]=s*u*i+l*n,t[2]=l*u*i-s*n,t[3]=0,t[4]=u*s*i-l*n,t[5]=s*s*i+o,t[6]=l*s*i+u*n,t[7]=0,t[8]=u*l*i+s*n,t[9]=s*l*i-u*n,t[10]=l*l*i+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},n.fromXRotation=function(t,e){var r=Math.sin(e),a=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromYRotation=function(t,e){var r=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromZRotation=function(t,e){var r=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromRotationTranslation=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=a+a,s=n+n,l=o+o,c=a*u,f=a*s,h=a*l,d=n*s,m=n*l,M=o*l,g=i*u,v=i*s,x=i*l;return t[0]=1-(d+M),t[1]=f+x,t[2]=h-v,t[3]=0,t[4]=f-x,t[5]=1-(c+M),t[6]=m+g,t[7]=0,t[8]=h+v,t[9]=m-g,t[10]=1-(c+d),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},n.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},n.getRotation=function(t,e){var r=e[0]+e[5]+e[10],a=0;return r>0?(a=2*Math.sqrt(r+1),t[3]=.25*a,t[0]=(e[6]-e[9])/a,t[1]=(e[8]-e[2])/a,t[2]=(e[1]-e[4])/a):e[0]>e[5]&e[0]>e[10]?(a=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/a,t[0]=.25*a,t[1]=(e[1]+e[4])/a,t[2]=(e[8]+e[2])/a):e[5]>e[10]?(a=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/a,t[0]=(e[1]+e[4])/a,t[1]=.25*a,t[2]=(e[6]+e[9])/a):(a=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/a,t[0]=(e[8]+e[2])/a,t[1]=(e[6]+e[9])/a,t[2]=.25*a),t},n.fromRotationTranslationScale=function(t,e,r,a){var n=e[0],o=e[1],i=e[2],u=e[3],s=n+n,l=o+o,c=i+i,f=n*s,h=n*l,d=n*c,m=o*l,M=o*c,g=i*c,v=u*s,x=u*l,p=u*c,b=a[0],y=a[1],S=a[2];return t[0]=(1-(m+g))*b,t[1]=(h+p)*b,t[2]=(d-x)*b,t[3]=0,t[4]=(h-p)*y,t[5]=(1-(f+g))*y,t[6]=(M+v)*y,t[7]=0,t[8]=(d+x)*S,t[9]=(M-v)*S,t[10]=(1-(f+m))*S,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},n.fromRotationTranslationScaleOrigin=function(t,e,r,a,n){var o=e[0],i=e[1],u=e[2],s=e[3],l=o+o,c=i+i,f=u+u,h=o*l,d=o*c,m=o*f,M=i*c,g=i*f,v=u*f,x=s*l,p=s*c,b=s*f,y=a[0],S=a[1],I=a[2],D=n[0],w=n[1],E=n[2];return t[0]=(1-(M+v))*y,t[1]=(d+b)*y,t[2]=(m-p)*y,t[3]=0,t[4]=(d-b)*S,t[5]=(1-(h+v))*S,t[6]=(g+x)*S,t[7]=0,t[8]=(m+p)*I,t[9]=(g-x)*I,t[10]=(1-(h+M))*I,t[11]=0,t[12]=r[0]+D-(t[0]*D+t[4]*w+t[8]*E),t[13]=r[1]+w-(t[1]*D+t[5]*w+t[9]*E),t[14]=r[2]+E-(t[2]*D+t[6]*w+t[10]*E),t[15]=1,t},n.fromQuat=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=r+r,u=a+a,s=n+n,l=r*i,c=a*i,f=a*u,h=n*i,d=n*u,m=n*s,M=o*i,g=o*u,v=o*s;return t[0]=1-f-m,t[1]=c+v,t[2]=h-g,t[3]=0,t[4]=c-v,t[5]=1-l-m,t[6]=d+M,t[7]=0,t[8]=h+g,t[9]=d-M,t[10]=1-l-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.frustum=function(t,e,r,a,n,o,i){var u=1/(r-e),s=1/(n-a),l=1/(o-i);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*s,t[6]=0,t[7]=0,t[8]=(r+e)*u,t[9]=(n+a)*s,t[10]=(i+o)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*o*2*l,t[15]=0,t},n.perspective=function(t,e,r,a,n){var o=1/Math.tan(e/2),i=1/(a-n);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(n+a)*i,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*n*a*i,t[15]=0,t},n.perspectiveFromFieldOfView=function(t,e,r,a){var n=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),s=2/(i+u),l=2/(n+o);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-((i-u)*s*.5),t[9]=(n-o)*l*.5,t[10]=a/(r-a),t[11]=-1,t[12]=0,t[13]=0,t[14]=a*r/(r-a),t[15]=0,t},n.ortho=function(t,e,r,a,n,o,i){var u=1/(e-r),s=1/(a-n),l=1/(o-i);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+r)*u,t[13]=(n+a)*s,t[14]=(i+o)*l,t[15]=1,t},n.lookAt=function(t,e,r,o){var i,u,s,l,c,f,h,d,m,M,g=e[0],v=e[1],x=e[2],p=o[0],b=o[1],y=o[2],S=r[0],I=r[1],D=r[2];return Math.abs(g-S)<a.EPSILON&&Math.abs(v-I)<a.EPSILON&&Math.abs(x-D)<a.EPSILON?n.identity(t):(h=g-S,d=v-I,m=x-D,M=1/Math.sqrt(h*h+d*d+m*m),h*=M,d*=M,m*=M,i=b*m-y*d,u=y*h-p*m,s=p*d-b*h,M=Math.sqrt(i*i+u*u+s*s),M?(M=1/M,i*=M,u*=M,s*=M):(i=0,u=0,s=0),l=d*s-m*u,c=m*i-h*s,f=h*u-d*i,M=Math.sqrt(l*l+c*c+f*f),M?(M=1/M,l*=M,c*=M,f*=M):(l=0,c=0,f=0),t[0]=i,t[1]=l,t[2]=h,t[3]=0,t[4]=u,t[5]=c,t[6]=d,t[7]=0,t[8]=s,t[9]=f,t[10]=m,t[11]=0,t[12]=-(i*g+u*v+s*x),t[13]=-(l*g+c*v+f*x),t[14]=-(h*g+d*v+m*x),t[15]=1,t)},n.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},n.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t},n.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t},n.sub=n.subtract,n.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t},n.multiplyScalarAndAdd=function(t,e,r,a){return t[0]=e[0]+r[0]*a,t[1]=e[1]+r[1]*a,t[2]=e[2]+r[2]*a,t[3]=e[3]+r[3]*a,t[4]=e[4]+r[4]*a,t[5]=e[5]+r[5]*a,t[6]=e[6]+r[6]*a,t[7]=e[7]+r[7]*a,t[8]=e[8]+r[8]*a,t[9]=e[9]+r[9]*a,t[10]=e[10]+r[10]*a,t[11]=e[11]+r[11]*a,t[12]=e[12]+r[12]*a,t[13]=e[13]+r[13]*a,t[14]=e[14]+r[14]*a,t[15]=e[15]+r[15]*a,t},n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},n.equals=function(t,e){var r=t[0],n=t[1],o=t[2],i=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],h=t[9],d=t[10],m=t[11],M=t[12],g=t[13],v=t[14],x=t[15],p=e[0],b=e[1],y=e[2],S=e[3],I=e[4],D=e[5],w=e[6],E=e[7],T=e[8],F=e[9],R=e[10],P=e[11],A=e[12],_=e[13],O=e[14],L=e[15];return Math.abs(r-p)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(n-b)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(o-y)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(i-S)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(S))&&Math.abs(u-I)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(I))&&Math.abs(s-D)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(D))&&Math.abs(l-w)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(c-E)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(f-T)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(T))&&Math.abs(h-F)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(F))&&Math.abs(d-R)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(m-P)<=a.EPSILON*Math.max(1,Math.abs(m),Math.abs(P))&&Math.abs(M-A)<=a.EPSILON*Math.max(1,Math.abs(M),Math.abs(A))&&Math.abs(g-_)<=a.EPSILON*Math.max(1,Math.abs(g),Math.abs(_))&&Math.abs(v-O)<=a.EPSILON*Math.max(1,Math.abs(v),Math.abs(O))&&Math.abs(x-L)<=a.EPSILON*Math.max(1,Math.abs(x),Math.abs(L))},t.exports=n},function(t,e,r){var a=r(1),n=r(5),o=r(6),i=r(7),u={};u.create=function(){var t=new a.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),r=o.fromValues(0,1,0);return function(a,n,i){var s=o.dot(n,i);return s<-.999999?(o.cross(t,e,n),o.length(t)<1e-6&&o.cross(t,r,n),o.normalize(t,t),u.setAxisAngle(a,t,Math.PI),a):s>.999999?(a[0]=0,a[1]=0,a[2]=0,a[3]=1,a):(o.cross(t,n,i),a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=1+s,u.normalize(a,a))}}(),u.setAxes=function(){var t=n.create();return function(e,r,a,n){return t[0]=a[0],t[3]=a[1],t[6]=a[2],t[1]=n[0],t[4]=n[1],t[7]=n[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],u.normalize(e,u.fromMat3(e,t))}}(),u.clone=i.clone,u.fromValues=i.fromValues,u.copy=i.copy,u.set=i.set,u.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.setAxisAngle=function(t,e,r){r*=.5;var a=Math.sin(r);return t[0]=a*e[0],t[1]=a*e[1],t[2]=a*e[2],t[3]=Math.cos(r),t},u.getAxisAngle=function(t,e){var r=2*Math.acos(e[3]),a=Math.sin(r/2);return 0!=a?(t[0]=e[0]/a,t[1]=e[1]/a,t[2]=e[2]/a):(t[0]=1,t[1]=0,t[2]=0),r},u.add=i.add,u.multiply=function(t,e,r){var a=e[0],n=e[1],o=e[2],i=e[3],u=r[0],s=r[1],l=r[2],c=r[3];return t[0]=a*c+i*u+n*l-o*s,t[1]=n*c+i*s+o*u-a*l,t[2]=o*c+i*l+a*s-n*u,t[3]=i*c-a*u-n*s-o*l,t},u.mul=u.multiply,u.scale=i.scale,u.rotateX=function(t,e,r){r*=.5;var a=e[0],n=e[1],o=e[2],i=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=a*s+i*u,t[1]=n*s+o*u,t[2]=o*s-n*u,t[3]=i*s-a*u,t},u.rotateY=function(t,e,r){r*=.5;var a=e[0],n=e[1],o=e[2],i=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=a*s-o*u,t[1]=n*s+i*u,t[2]=o*s+a*u,t[3]=i*s-n*u,t},u.rotateZ=function(t,e,r){r*=.5;var a=e[0],n=e[1],o=e[2],i=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=a*s+n*u,t[1]=n*s-a*u,t[2]=o*s+i*u,t[3]=i*s-o*u,t},u.calculateW=function(t,e){var r=e[0],a=e[1],n=e[2];return t[0]=r,t[1]=a,t[2]=n,t[3]=Math.sqrt(Math.abs(1-r*r-a*a-n*n)),t},u.dot=i.dot,u.lerp=i.lerp,u.slerp=function(t,e,r,a){var n,o,i,u,s,l=e[0],c=e[1],f=e[2],h=e[3],d=r[0],m=r[1],M=r[2],g=r[3];return o=l*d+c*m+f*M+h*g,o<0&&(o=-o,d=-d,m=-m,M=-M,g=-g),1-o>1e-6?(n=Math.acos(o),i=Math.sin(n),u=Math.sin((1-a)*n)/i,s=Math.sin(a*n)/i):(u=1-a,s=a),t[0]=u*l+s*d,t[1]=u*c+s*m,t[2]=u*f+s*M,t[3]=u*h+s*g,t},u.sqlerp=function(){var t=u.create(),e=u.create();return function(r,a,n,o,i,s){return u.slerp(t,a,i,s),u.slerp(e,n,o,s),u.slerp(r,t,e,2*s*(1-s)),r}}(),u.invert=function(t,e){var r=e[0],a=e[1],n=e[2],o=e[3],i=r*r+a*a+n*n+o*o,u=i?1/i:0;return t[0]=-r*u,t[1]=-a*u,t[2]=-n*u,t[3]=o*u,t},u.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},u.length=i.length,u.len=u.length,u.squaredLength=i.squaredLength,u.sqrLen=u.squaredLength,u.normalize=i.normalize,u.fromMat3=function(t,e){var r,a=e[0]+e[4]+e[8];if(a>0)r=Math.sqrt(a+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);var o=(n+1)%3,i=(n+2)%3;r=Math.sqrt(e[3*n+n]-e[3*o+o]-e[3*i+i]+1),t[n]=.5*r,r=.5/r,t[3]=(e[3*o+i]-e[3*i+o])*r,t[o]=(e[3*o+n]+e[3*n+o])*r,t[i]=(e[3*i+n]+e[3*n+i])*r}return t},u.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},u.exactEquals=i.exactEquals,u.equals=i.equals,t.exports=u},function(t,e,r){var a=r(1),n={};n.create=function(){var t=new a.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},n.clone=function(t){var e=new a.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},n.fromValues=function(t,e){var r=new a.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},n.set=function(t,e,r){return t[0]=e,t[1]=r,t},n.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},n.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t},n.sub=n.subtract,n.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t},n.mul=n.multiply,n.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t},n.div=n.divide,n.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},n.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},n.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},n.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},n.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},n.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},n.scaleAndAdd=function(t,e,r,a){return t[0]=e[0]+r[0]*a,t[1]=e[1]+r[1]*a,t},n.distance=function(t,e){var r=e[0]-t[0],a=e[1]-t[1];return Math.sqrt(r*r+a*a)},n.dist=n.distance,n.squaredDistance=function(t,e){var r=e[0]-t[0],a=e[1]-t[1];return r*r+a*a},n.sqrDist=n.squaredDistance,n.length=function(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)},n.len=n.length,n.squaredLength=function(t){var e=t[0],r=t[1];return e*e+r*r},n.sqrLen=n.squaredLength,n.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},n.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},n.normalize=function(t,e){var r=e[0],a=e[1],n=r*r+a*a;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n),t},n.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},n.cross=function(t,e,r){var a=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=a,t},n.lerp=function(t,e,r,a){var n=e[0],o=e[1];return t[0]=n+a*(r[0]-n),t[1]=o+a*(r[1]-o),t},n.random=function(t,e){e=e||1;var r=2*a.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},n.transformMat2=function(t,e,r){var a=e[0],n=e[1];return t[0]=r[0]*a+r[2]*n,t[1]=r[1]*a+r[3]*n,t},n.transformMat2d=function(t,e,r){var a=e[0],n=e[1];return t[0]=r[0]*a+r[2]*n+r[4],t[1]=r[1]*a+r[3]*n+r[5],t},n.transformMat3=function(t,e,r){var a=e[0],n=e[1];return t[0]=r[0]*a+r[3]*n+r[6],t[1]=r[1]*a+r[4]*n+r[7],t},n.transformMat4=function(t,e,r){var a=e[0],n=e[1];return t[0]=r[0]*a+r[4]*n+r[12],t[1]=r[1]*a+r[5]*n+r[13],t},n.forEach=function(){var t=n.create();return function(e,r,a,n,o,i){var u,s;for(r||(r=2),a||(a=0),s=n?Math.min(n*r+a,e.length):e.length,u=a;u<s;u+=r)t[0]=e[u],t[1]=e[u+1],o(t,t,i),e[u]=t[0],e[u+1]=t[1];return e}}(),n.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},n.equals=function(t,e){var r=t[0],n=t[1],o=e[0],i=e[1];return Math.abs(r-o)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-i)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(i))},t.exports=n},function(t,e,r){(function(t){console.log("in app.js");var e=(t.env.WEBPACK_ENV,r(4));for(var a in e)console.log(a+":"+e[a]);console.warn("in release mode"),window.vrmini=e,console.log("Window.vrmini:"+e)}).call(e,r(8))}]);