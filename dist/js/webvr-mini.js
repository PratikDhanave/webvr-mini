!function(e){function t(i){if(r[i])return r[i].exports;var n=r[i]={exports:{},id:i,loaded:!1};return e[i].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){e.exports=r(17)},function(e,t){var r={};r.EPSILON=1e-6,r.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,r.RANDOM=Math.random,r.ENABLE_SIMD=!1,r.SIMD_AVAILABLE=r.ARRAY_TYPE===Float32Array&&"SIMD"in this,r.USE_SIMD=r.ENABLE_SIMD&&r.SIMD_AVAILABLE,r.setMatrixArrayType=function(e){r.ARRAY_TYPE=e};var i=Math.PI/180;r.toRadian=function(e){return e*i},r.equals=function(e,t){return Math.abs(e-t)<=r.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))},e.exports=r},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=function(){function e(t){r(this,e),this.util=t,this.emitter=t.emitter,this.MIN_WAIT_TIME=100,this.MAX_TRIES=6,this.NOT_IN_LIST=this.util.NOT_IN_LIST,this.keyList=[]}return i(e,[{key:"pathInList",value:function(e){if(e)for(var t in this.keyList){var r=this.keyList[t];if(r.path===e)return r}return null}},{key:"assetInList",value:function(e){if(e){if(this.keyList[e])return this.keyList[e]}else console.error("AssetPool::assetInlist(): undefined key");return null}},{key:"nameInList",value:function(e){if(e)for(var t in this.keyList){var r=this.keyList[t];if(r.name)return r}return null}},{key:"findByObj",value:function(e){if(e)for(var t in this.keyList){var r=this.keyList[t];if(r===e)return r}return null}},{key:"addAsset",value:function(e,t){if(e)if(t){if(e.key=t,this.keyList[t]){if(this.keyList[t]===e)return console.warn("AssetPool::addAsset(): asset "+t+" already added to pool"),e;console.warn("AssetPool::addAsset(): replacing asset at key:"+t)}}else e.key=this.util.computeId(),console.log("^^ adding obj:"+e.key+" path:"+e.path),this.keyList[e.key]=e;return e}},{key:"removeAsset",value:function(e){var t=null;return this.keyList[e]?(t=this.keyList[e],t&&delete this.keyList[e]):console.warn("AssetPool::removeAsset(): key not found in assetList"),t}},{key:"getWrappedPromise",value:function(){var e={},t=new Promise(function(t,r){e.resolve=t,e.reject=r});return e.then=t.then.bind(t),e.catch=t.catch.bind(t),e.promise=t,e}},{key:"getWrappedFetch",value:function(e,t,r,i){var n=this,a=this.getWrappedPromise(),o=new Request(e,t);return a.url=e,a.params=t,a.tries=r,a.pos=i,a.timeoutId=setTimeout(function(){console.warn("AssetPool::getWrappedFetch(): TIMEOUT for "+(n.MIN_WAIT_TIME*a.tries+1)+"msec "+a.url),a.catch(0)},this.MIN_WAIT_TIME*a.tries),fetch(o).then(function(e){if(e.ok)return e;throw new Error("Network response was not ok for "+a.url)}).then(function(e){return clearTimeout(a.timeoutId),a.resolve(e)},function(e){return console.warn("AssetPool::getWrappedFetch(): NOT OK, REJECT "+a.url),clearTimeout(a.timeoutId),a.reject(e)}).catch(function(e){return console.warn("AssetPool::getWrappedFetch(): NOT OK, CATCH "+a.url),clearTimeout(a.timeoutId),a.catch(e)}),a}},{key:"doRequest",value:function(e,t,r){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"text/plain",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=new Headers({"Content-Type":a}),u=this.getWrappedFetch(i?e+"?"+(new Date).getTime():e,{method:"get",mode:"cors",redirect:"follow",headers:s},o,t);return u.promise.then(function(e){var t=null;return 200===e.status||0===e.status?(t="application/json"===a?e.json():a.indexOf("text")!==n.util.NOT_IN_LIST?e.text():"application/xml"===a?e.formData():a.indexOf("image")!==n.util.NOT_IN_LIST?e.blob():e.blob(),Promise.resolve(t)):Promise.reject(e)},function(o){return u.tries++,u.tries<n.MAX_TRIES&&(console.warn("AssetPool::doRequest(): ft.promise .then error, TRYING AGAIN:"+o+" for "+u.url),n.doRequest(e,t,r,i=!0,a,u.tries)),Promise.resolve(o)}).then(function(i){r(i instanceof Error?{pos:t,path:e,data:null,error:i}:{pos:t,path:e,data:i,error:!1})},function(e){return Promise.reject(0)})}}]),e}();t.default=n},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=function(){function e(t,i,n,a,o,s,u){r(this,e),console.log("In Shader class"),this.name=s,this.util=i,this.glMatrix=n,this.webgl=a,this.vr=o,this.pMatrix=this.glMatrix.mat4.create(),this.mvMatrix=this.glMatrix.mat4.create(),this.mvMatrixStack=this.glMatrix.mat4.create(),this.floatp="",this.webgl.stats.highp?this.floatp="precision highp float;":this.floatp="precision mediump float;",u&&(console.log("ADDING LIGHT TO SHADER:"+this.name),this.lights=u),this.required={buffer:{vertices:!0,indices:!1,texCoords:!1,texCoords1:!1,texCoords2:!1,texCoords3:!1,texCoords4:!1,texCoords5:!1},bumpMap:!1,colors:!1,normals:!1,tangents:!1,lights:0,textures:0},this.vertexShaderFile=null,this.fragmentShaderFile=null,this.NOT_IN_LIST=i.NOT_IN_LIST,this.createProgram()}return i(e,[{key:"primInList",value:function(e){var t=this.program.renderList,r=t.indexOf(e);return r}},{key:"addPrim",value:function(e){this.checkPrim(e)&&(this.primInList(e)===this.NOT_IN_LIST?(console.warn(e.name+" added to Shader::"+this.name),e.shader&&e.shader!==this&&e.shader.removePrim(e),e.shader=this,this.program.renderList.push(e),this.util.emitter.emit(this.util.emitter.events.PRIM_ADDED_TO_SHADER,e)):console.warn(e.name+" already added to Shader::"+this.name))}},{key:"removePrim",value:function(e){var t=this.primInList(e);t!==this.NOT_IN_LIST?(this.shader=null,this.program.renderList.splice(t,1),this.util.emitter.emit(this.util.emitter.events.PRIM_REMOVED_FROM_SHADER,e)):console.warn(e.name+" not found in Shader::"+this.name)}},{key:"checkPrimBuffers",value:function(e){var t=this.required.buffer,r=e.geometry;for(var i in t)if(t[i]&&r[i]&&!r[i].buffer)return!1;return!0}},{key:"checkPrimMaterial",value:function(e){return console.log("Shader::checkPrimMaterial(): event MATERIAL_READY fired"),!0}},{key:"checkPrimTextures",value:function(e){if(e.textures.length<this.required.textures)return!1;for(var t=0;t<e.textures.length;t++)if(!e.textures[t]||!e.textures[t].texture)return!1;return!0}},{key:"checkPrim",value:function(e){return!(e.shader!==this||!this.checkPrimTextures(e)||!this.checkPrimBuffers(e))}},{key:"createProgram",value:function(){var e=null;return e=this.vertexShaderFile&&this.fragmentShaderFile?this.webgl.createProgram(this.webgl.fetchVertexShader(this.vertexShaderFile),this.webgl.fetchFragmentShader(this.fragmentShaderFile)):this.webgl.createProgram(this.vsSrc(),this.fsSrc()),e||console.error("error creating WebGL program using Shader "+this.constructor.name),this.program=e}},{key:"getProgram",value:function(){return this.program}},{key:"setup",value:function(){var e=this.program,t=this.glMatrix,r=t.mat4;this.pMatrix=t.mat4.create(),this.mvMatrix=t.mat4.create();var i=this.pMatrix,n=this.mvMatrix,a=this.webgl.getCanvas(),o=this.webgl.getContext(),s=this.webgl.near,u=this.webgl.far;return e.renderMono=function(){r.identity(n),r.perspective(i,.4*Math.PI,a.width/a.height,s,u),e.render(i,n)},e.renderVR=function(t,i,s){r.identity(n),o.viewport(0,0,.5*a.width,a.height),t.getStandingViewMatrix(n,s.leftViewMatrix,s.pose),e.render(s.leftProjectionMatrix,n),r.identity(n),o.viewport(.5*a.width,0,.5*a.width,a.height),t.getStandingViewMatrix(n,s.rightViewMatrix,s.pose),e.render(s.rightProjectionMatrix,n)},[o,a,this.glMatrix.mat4,this.glMatrix.mat3,this.glMatrix.vec3,this.pMatrix,this.mvMatrix,e,{attribute:this.webgl.setAttributeArrays(e.shaderProgram,e.vsVars.attribute),uniform:this.webgl.setUniformLocations(e.shaderProgram,e.vsVars.uniform)},{uniform:this.webgl.setUniformLocations(e.shaderProgram,e.fsVars.uniform)},this.webgl.stats,this.webgl.near,this.webgl.far,this.vr]}},{key:"getpMatrix",value:function(){return this.pMatrix}},{key:"getmvMatrix",value:function(){return this.mvMatrix}},{key:"mvPushMatrix",value:function(){var e=this.glMatrix.mat4,t=e.create();e.set(this.mvMatrix,t),mvMatrixStack.push(t)}},{key:"mvPopMatrix",value:function(){if(0==this.mvMatrixStack.length)throw"Invalid popMatrix!";mvMatrix=this.mvMatrixStack.pop()}}]),e}();t.default=n},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[.1,.1,.1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[-.25,-.5,-.1],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[.7,.7,.7];r(this,e),this.glMatrix=t,this.lightTypes={LIGHT_0:"light0",LIGHT_1:"light1",LIGHT_2:"light2",LIGHT_3:"light3"},this.lightList=[],this.lightList[this.lightTypes.LIGHT_0]={ambient:i,lightingDirection:n,directionalColor:a}}return i(e,[{key:"getLight",value:function(e){return window.lightList=this.lightList,this.lightList[e]}},{key:"setPos",value:function(e,t,r,i){}},{key:"setPolar",value:function(e,t,r){}}]),e}();t.default=n},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),u=r(2),l=i(u),c=function(e){function t(e,r,i,o,s){n(this,t),console.log("in ModelPool");var u=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r));return u.util=r,u.webgl=i,u.texturePool=o,u.materialPool=s,u.modelMimeTypes={obj:"text/plain",mtl:"text/plain",html:"text/html",x3d:"model/x3d+xml",x3dv:"model/x3d-vrml"},u}return o(t,e),s(t,[{key:"computeObj3d",value:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,n=e.match(/^(-?\d+(\.\d+)?)\s*(-?\d+(\.\d+)?)\s*(-?\d+(\.\d+)?)/);return!!n&&(3===i?t.push(parseFloat(n[1]),parseFloat(n[3]),parseFloat(n[5])):2===i&&t.push(parseFloat(n[1]),parseFloat(n[3])),!0)}},{key:"computeObj2d",value:function(e,t,r){var i=e.match(/^(-?\d+(\.\d+)?)\s+(-?\d+(\.\d+)?)$/);return!!i&&(t.push(parseFloat(i[1]),parseFloat(i[3])),!0)}},{key:"computeFan",value:function(e){if(e.length){for(var t=[],r=1;r<e.length-1;r++)t.push(e[0],e[r],e[r+1]);return t}return e}},{key:"computeObjIndices",value:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=e.match(/[^\s]+/g),o=void 0,s=void 0,u=void 0,l=void 0,c=this.NOT_IN_LIST,h=[];a.map(function(e){e.indexOf("//")!==c?(o=e.split("//"),s=parseInt(o[0])-1,l=parseInt(o[1])-1):e.indexOf("/")!==c?(o=e.split("/"),s=parseInt(o[0])-1,u=parseFloat(s[1])-1,l=parseFloat(s[2])-1):s=parseInt(e)-1,Number.isFinite(s)&&h.push(s),Number.isFinite(u)&&i.push(u),Number.isFinite(l)&&n.push(l)}),h.length>3&&(h=this.computeFan(h)),Array.prototype.push.apply(t,h)}},{key:"computeObjMesh",value:function(e,t,r){var i=this;console.log("ModelPool::computeObjMesh(): loading a new file:"+r+" for "+t.name);var n=this.util.isWhitespace,a=[],o=[],s=[],u=[],l=this.util.getFilePath(r),c=0,h=e.split("\n"),M=[],d=[],f=(this.util.DEFAULT_KEY,[]),m=[],g=[],y=[];return h.forEach(function(e){var r=e.split(" ")[0].trim(),h=e.substr(r.length).trim();switch(r){case"o":t.name||(t.name=h,t.objects[h]=a.length);break;case"v":i.computeObj3d(h,a,c);break;case"f":i.computeObjIndices(h,o,c,M,d);break;case"vn":i.computeObj3d(h,u,c);break;case"vt":i.computeObj2d(h,s,c)||i.computeObj3d(h,s,c,2);break;case"mtllib":for(var f=h.split(" "),L=0;L<f.length;L++)i.materialPool.getMaterials(t,[l+h],!0);break;case"usemtl":console.log("::::::::::::GOTTA USEMTL in OBJ file: "+h),y[h]=a.length;break;case"g":m[h]=a.length;break;case"s":g[h]=a.length;break;case"maplib":case"usemap":case"#":case"vp":case"p":case"l":case"curv":case"surf":case"parm":case"trim":case"hole":case"scrv":case"sp":case"end":case"con":case"mg":case"bevel":case"c_interp":case"d_interp":case"lod":case"shadow_obj":case"trace_obj":case"ctech":case"stech":case"mtllib":console.warn("ModelPool::computeObjMesh(): OBJ data type: "+r+" in .obj file not supported");break;default:n(h)||console.error("ModelPool::computeObjMesh(): unknown line data: "+e+" in .obj file at line:"+c)}c++}),console.log("ModelPool::computeObjMesh(): v:"+a.length/3+" i:"+o.length/3+" t:"+s.length/2+" n:"+u.length/3),{vertices:a,indices:o,texCoords:s,normals:u,options:{objects:f,groups:m,smoothingGroups:g,materials:y}}}},{key:"addModel",value:function(e,t,r,i,n,a){if(void 0===i)return console.error("ModelPool::addModel(): undefined pos"),null;var o=this.util.getFileExtension(r),s=null,u="";switch(o){case"obj":s=this.computeObjMesh(t,e,r),s.tangents=[],s.colors=[],u=this.util.emitter.events.GEOMETRY_READY;break;case"html":break;case"x3d":break;case"x3dv":break;default:console.warn("ModelPool::addModel(): unknown model file:"+r+" MIME type:"+n)}return s?(s.type=a,s.path=r,s.emits=u):console.warn("TexturePool::addTexture(): no texture returned by createTexture() + "+n+" function"),this.addAsset(s)}},{key:"getModels",value:function(e,t){for(var r=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=function(n){var a=t[n];if(a){var o=r.pathInList(a);if(o)e.models.push(o);else{var s=r.modelMimeTypes[r.util.getFileExtension(a)];s?r.doRequest(a,n,function(t){if(t.data){var i=r.addModel(e,t.data,t.path,t.pos,s,e.type);i?r.util.emitter.emit(i.emits,e,i.key,i.pos):console.error("TexturePool::getModels(): file:"+a+" could not be parsed")}else console.error("ModelPool::getModels(): no data found for:"+t.path)},i,s,0):console.error('ModelPool::getModels(): file type "'+r.util.getFileExtension(a)+'" in:'+a+" not supported, not loading")}}else console.warn("ModelPool::getModels(): no path supplied for position "+n)},a=0;a<t.length;a++)n(a)}}]),t}(l.default);t.default=c},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=r(2),u=i(s),l=function(e){function t(e,r,i){n(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,i));return o}return o(t,e),t}(u.default);t.default=l},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=r(8),s=i(o),l=r(9),c=i(l),h=r(11),M=(i(h),r(5)),d=(i(M),function(){function e(t,r,i,a,o){n(this,e),console.log("in GeometryPool class"),this.util=r,this.glMatrix=i,this.webgl=a,this.modelPool=o,this.typeList={POINT:"geometryPointCloud",POINTCLOUD:"geometryPointCloud",LINE:"geometryLine",PLANE:"geometryOuterPlane",OUTERPLANE:"geometryOuterPlane",INNERPLANE:"geometryInnerPlane",CURVEDPLANE:"geometryCurvedOuterPlane",CURVEDOUTERPLANE:"geometryCurvedOuterPlane",CURVEDINNERPLANE:"geometryCurvedInnerPlane",TERRAIN:"geometryTerrain",CIRCLE:"geometryCircle",CUBE:"geometryCube",CUBESPHERE:"geometryCubeSphere",SPHERE:"geometrySphere",DISC:"geometryCap",CAP:"geometryCap",DOME:"geometryDome",TOPDOME:"geometryTopDome",SKYDOME:"geometrySkyDome",BOTTOMDOME:"geometryBottomDome",CONE:"geometryCone",TOPCONE:"geometryTopCone",BOTTOMCONE:"geometryBottomCone",SPINDLE:"geometrySpindle",TEARDROP:"geometryTeardrop",CYLINDER:"geometryCylinder",CAPSULE:"geometryCapsule",PRISM:"geometryPrism",ICOSOHEDRON:"geometryIcosohedron",PYRAMID:"geometryPyramid",REGULARTETRAHEDRON:"geometryRegularTetrahedron",ICOSPHERE:"geometryIcoSphere",TOPICODOME:"geometryTopIcoDome",SKYICODOME:"geometrySkyIcoDome",BOTTOMICODOME:"geometryBottomIcoDome",OCTAHEDRON:"geometryOctahedron",DODECAHEDRON:"geometryDodecahedron",TORUS:"geometryTorus",MESH:"geometryMesh"},this.directions={DEFAULT:"up",FORWARD:"forward",FRONT:"forward",BACK:"back",LEFT:"left",RIGHT:"right",UP:"up",TOP:"up",DOWN:"down",BOTTOM:"down"},this.OUTSIDE=100,this.INSIDE=101,this.INVISIBLE=102,this.TWO_PI=2*Math.PI}return a(e,[{key:"checkType",value:function(e){return this[e]instanceof Function}},{key:"getStdVecs",value:function(e){var t=this.directions;switch(e){case t.BACK:return[0,0,-1];case t.DOWN:return[0,-1,0];case t.FORWARD:return[0,0,1];case t.LEFT:return[-1,0,0];case t.RIGHT:return[1,0,0];case t.UP:return[0,1,0];case t.ONE:return[1,1,1];case t.ZERO:return[0,0,0]}}},{key:"vec5",value:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return[e,t,r,i,n]}},{key:"computePointInTriangle",value:function(e,t,r,i){this.computeBaryCentric(e,t,r,i);return u>=0&&v>=0&&u+v<1}},{key:"computeAngle2d",value:function(e,t,r){var i=void 0,n=void 0;switch(r){case 0:i=t[0]-e[0],n=t[2]-e[2];break;case 1:i=t[0]-e[0],n=t[1]-e[1];break;case 2:i=t[1]-e[1],n=t[2]-e[2];break;default:console.error("invalid 2d angle choice, "+r)}return Math.atan2(n,i)}},{key:"computeAngle3d",value:function(e,t,r){var i=[t[0]-e[0],t[1]-e[1],t[2]-e[2]],n=[r[0]-t[0],r[1]-t[1],r[2]-t[2]],a=Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]),o=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]),s=[i[0]/a,i[1]/a,i[2]/a],u=[n[0]/o,n[1]/o,n[2]/o];return Math.acos(s[0]*u[0]+s[1]*u[1]+s[2]*u[2])}},{key:"computeCentroid",value:function(e){for(var t=[0,0,0],r=e.length,i=0;i<r;i++){var n=e[i];t[0]+=n[0],t[1]+=n[1],t[2]+=n[2]}return t[0]/=r,t[1]/=r,t[2]/=r,t}},{key:"computeMassCentroid",value:function(e){for(var t=this.glMatrix.vec3,r=[0,0,0],i=0,n=e[0],a=e[1],o=2;o<e.length;o++){var s=e[o],u=t.subtract([0,0,0],s,n),l=t.subtract([0,0,0],s,a),c=t.cross([0,0,0],u,l),h=t.length(c)/2;r[0]+=h*(n[0]+a[0]+s[0])/3,r[1]+=h*(n[1]+a[1]+s[1])/3,r[2]+=h*(n[2]+a[2]+s[2])/3,i+=h,a=t.copy([0,0,0],s)}return[r[0]/i,r[1]/i,r[2]/i]}},{key:"computeBarycentric",value:function(e,t,r,i){var n=this.glMatrix.vec3,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,h=void 0,M=void 0;a=n.sub(a,i,t),o=n.sub(o,r,t),s=n.sub(s,e,t),u=n.dot(a,a),l=n.dot(a,o),c=n.dot(a,s),h=n.dot(o,o),M=n.dot(o,s);var d=1/(u*h-l*l),f=(h*c-l*M)*d,m=(u*M-l*c)*d;return[f,m]}},{key:"computeBoundingBox",value:function(e){for(var t=this.glMatrix.vec3,r={},i=0,n=0,a=0,o=0,s=0,u=0,l=0;l<e.length;l++){var c=e[l];i=Math.min(i,c[0]),n=Math.min(n,c[1]),a=Math.min(a,c[2]),o=Math.max(o,c[0]),s=Math.max(s,c[1]),u=Math.max(u,c[2])}return r.vertices=[i,n,u,o,n,u,o,s,u,i,s,u,i,n,a,i,s,a,o,s,a,o,n,a,i,s,a,i,s,u,o,s,u,o,s,a,i,n,a,o,n,a,o,n,u,i,n,u,o,n,a,o,s,a,o,s,u,o,n,u,i,n,a,i,n,u,i,s,u,i,s,a],r.indices=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],r.topLeft=[i,n,a],r.bottomRight=[o,s,u],r.dimensions=t.subtract([0,0,0],r.bottomRight,r.topLeft),r}},{key:"computeBoundingSphere",value:function(e){var t={},r=e.topLeft,i=e.bottomRight,n=Math.abs(i[0]-r[0]),a=Math.abs(i[1]-r[1]),o=Math.abs(i[2]-r[2]),s=Math.max(n,a,o)/2;t.radius=s;var u=this.computeCentroid(vertices);return t.center=u,t}},{key:"computeSphericalCoords",value:function(e){var t=Math.atan2(e[0],e[2])/this.TWO_PI,r=Math.asin(e[1])/Math.PI+.5;return t<0&&(t+=1),[t,r]}},{key:"computeInflateToSphere",value:function(e,t){for(var r=this.computeSphere(t),i=[],n=[],a=r.center[0],o=r.center[1],s=r.center[2],u=r.radius,l=0;l<e.length;l+=3){var c=e[l],h=e[l+1],M=e[l+2],d=Math.sqrt(a*c+o*h+s*M),f=d/u;i.push(c*f,h*f,M*f);var m=this.computeSphericalCoords([c,h,M]);n.push(m.u,m.v)}return{vertices:e,texCoords:texCoords}}},{key:"computeNormals",value:function(e,t,r,i){var n=0,a=0,o=0,s=0,u=0,l=0,c=0,h=0,M=0,d=0,f=0,m=0,g=0,y=0;r=new Float32Array(e.length);var L=t.length/3;for(n=0;n<L;n++)m=t[3*n],g=t[3*n+1],y=t[3*n+2],a=e[3*m]-e[3*g],o=e[3*m+1]-e[3*g+1],s=e[3*m+2]-e[3*g+2],u=e[3*y]-e[3*g],l=e[3*y+1]-e[3*g+1],c=e[3*y+2]-e[3*g+2],h=o*c-s*l,M=s*u-a*c,d=a*l-o*u,f=Math.sqrt(h*h+M*M+d*d),f=0===f?1:f,h/=f,M/=f,d/=f,r[3*m]+=h,r[3*m+1]+=M,r[3*m+2]+=d,r[3*g]+=h,r[3*g+1]+=M,r[3*g+2]+=d,r[3*y]+=h,r[3*y+1]+=M,r[3*y+2]+=d;for(n=0;n<r.length/3;n++)h=r[3*n],M=-r[3*n+1],d=r[3*n+2],f=Math.sqrt(h*h+M*M+d*d),f=0===f?1:f,h/=f,M/=f,d/=f,r[3*n]=-h,r[3*n+1]=M,r[3*n+2]=-d;return r}},{key:"computeTangents",value:function(e,t,r,i,n){var a=this.glMatrix.vec3,o=new Float32Array(r.length),s=new Float32Array(r.length),u=t.length,l=e.length;n=new Float32Array(4*l/3);for(var c=0;c<u;c+=3){var h=t[c],M=t[c+1],d=t[c+2],f=3*h,m=e[f],g=e[f+1],y=e[f+2];f=3*M;var L=e[f],v=e[f+1],I=e[f+2];f=3*d;var x=e[f],T=e[f+1],p=e[f+2],w=L-m,S=x-m,D=v-g,b=T-g,N=I-y,E=p-y;f=2*h;var j=i[f],A=i[f+1];f=2*M;var z=i[f],P=i[f+1];f=2*d;var C=i[f],O=i[f+1],R=z-j,F=C-j,k=P-A,_=O-A,U=1/(R*_-F*k),Y=(_*w-k*S)*U,B=(_*D-k*b)*U,V=(_*N-k*E)*U,G=(R*S-F*w)*U,W=(R*b-F*D)*U,Z=(R*E-F*N)*U;f=3*h,o[f]+=Y,o[f+1]+=B,o[f+2]+=V,s[f]+=G,s[f+1]+=W,s[f+2]+=Z,f=3*M,o[f]+=Y,o[f+1]+=B,o[f+2]+=V,s[f]+=G,s[f+1]+=W,s[f+2]+=Z,f=3*d,o[f]+=Y,o[f+1]+=B,o[f+2]+=V,s[f]+=G,s[f+1]+=W,s[f+2]+=Z}for(var H=0,Q=0;Q<l;H+=3,Q+=4){var X=[r[H],r[H+1],r[H+2]],J=[o[H],o[H+1],o[H+2]],q=[s[H],s[H+1],s[H+2]],K=a.sub([0,0,0],J,a.scale([0,0,0],J,a.dot(X,J))),$=K[0]*K[0]+K[1]*K[1]+K[2]*K[2],ee=$>0?a.scale([0,0,0],K,1/Math.sqrt($)):K,te=a.dot(a.cross([0,0,0],X,J),q)<0?-1:1;n[Q]=ee[0],n[Q+1]=ee[1],n[Q+2]=ee[2],n[Q+3]=te}return n}},{key:"computeTexCoords",value:function(e){for(var t=[],r=0;r<e.length;r+=3){var i=this.computeSphericalCoords([e[r],e[r+1],e[r+2]]);t.push(i[0],i[1])}return t}},{key:"computeTexCoords2",value:function(e,t){function r(e,t,r,i,n){var a=o.dot([0,0,0],e,t);return a>i&&{ret:r,maxDot:a}}function i(e){var t,i=m.Up,n=Number.NegativeInfinity;return r(e,s.RIGHT,m.Right,n,i)||(t=r(e,s.LEFT,m.Right,n,i),i=t.ret,n=t.maxDot),r(e,s.FORWARD,m.Forward,n,i)||(t=r(e,s.BACK,m.Forward,n,i),i=t.ret,n=t.maxDot),r(e,s.UP,m.Up,n,i)||(t=r(e,s.DOWN,m.Up,n,i),i=t.ret,n=t.maxDot),i}function n(e,t,r){return[e/r,t/r]}for(var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=(this.util,this.glMatrix.vec3),s=this.directions,u=void 0,l=void 0,c=void 0,h=void 0,M=void 0,d=void 0,f=void 0,m={Up:0,Forward:1,Right:2},g=new Array(2*e.length/3),y=0;y<t.length;y+=3){var L=y,v=y+1,I=y+2;switch(u=this.util.getArr(e,L,3),l=this.util.getArr(e,v,3),c=this.util.getArr(e,I,3),h=o.sub([0,0,0],l,u),M=o.sub([0,0,0],c,u),d=o.cross([0,0,0],h,M),f=i(d)){case m.Forward:g[L]=n(u[0],u[1],a),g[v]=n(l[0],l[1],a),g[I]=n(c[0],c[1],a);break;case m.up:g[L]=n(u[1],u[2],a),g[v]=n(l[1],l[2],a),g[I]=n(c[1],c[2],a);break;case m.right:g[L]=n(u[2],u[1],a),g[v]=n(l[2],l[1],a),g[I]=n(c[2],c[1],a)}}return g}},{key:"computeColors",value:function(e,t){var r=[];if(4===t.length)for(var i=0;i<e.length;i+=3)r.push(t[0],t[1],t[2],t[3]);for(var n=0;n<e.length;n+=3)r.push(e[n],e[n+1],e[n+2],1);return r}},{key:"computeFan",value:function(e,t){for(var r=(this.glMatrix.vec3,[]),i=0;i<t.length;i++)r.push(e[t[i]]);var n=this.computeCentroid(r);r.push(n);for(var a=r.length-1,o=[],s=[],u=[],l=r.length,c=1;c<l;c++){var h=c-1,M=c;c===l-1&&(M=0);r[h],r[M];u.push(h,M,a),s.push(n[0],n[1],n[2]),o.push(Math.cos(this.TWO_PI*M/(l-1))/2+.5,Math.sin(this.TWO_PI*M/(l-1))/2+.5)}return o.push(.5,.5),s.push(n[0],n[1],n[2]),{vertices:r,indices:u,texCoords:o,normals:s,tangents:[],colors:[]}}},{key:"computeScale",value:function(e,t){for(var r=this.getCenter(e),i=0;i<e.length;i++)e[i]*=t;this.moveTo(r)}},{key:"computeMove",value:function(e,t){for(var r=this.computeCentroid(e),i=[r[0]-t[0],r[1]-t[1],r[2]-t[2]],n=0;n<e.length;n+=3)e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2]}},{key:"geometryPointCloud",value:function(e){var t=(this.typeList,this.glMatrix.vec3,e.geometry,e.dimensions[0]),r=e.dimensions[1],i=e.dimensions[2],n=(e.dimensions[3],e.dimensions[4]||1,e.divisions[0]||1),a=[],o=[],s=[],u=[],l=[];if(!e.spaceMap){console.log("GeometryPool::geometryPointCloud(): adding spaceMap for:"+e.name),e.sphereMap=new c.default(this.util),e.sphereMap.initRandom(t,r,i,n);for(var h=e.sphereMap.map,M=0;M<h.length;M+=3)h[M]*=t,h[M+1]*=r,h[M+2]*=i,o.push[M]}return{vertices:a,indices:o,normals:u,texCoords:s,tangents:l}}},{key:"geometryLine",value:function(e){var t=(this.glMatrix.vec3,e.geometry,e.dimensions[0]),r=e.dimensions[1],i=e.dimensions[2],n=e.dimensions[3],a=(e.dimensions[4]||1,e.divisions[0]||1,[]),o=[],s=[],u=[],l=[];return a.push(t-n,r-n,i-n,t+n,r+n,i+n),o.push(0,3),{vertices:a,indices:o,normals:u,texCoords:s,tangents:l}}},{key:"geometrySphere",value:function(e){var t=this.typeList,r=this.glMatrix.vec3,i=e.geometry,n=[],a=[],o=[],s=[],u=[],l=e.divisions[0],c=e.divisions[1],h=e.dimensions[0],M=e.dimensions[1],d=e.dimensions[2],f=e.dimensions[3]||0,m=e.dimensions[4]||1,g=0,y=0,L=void 0;L=e.type===t.SPHERE||e.type===t.CYLINDER||e.type===t.SPINDLE||e.type===t.CONE||e.type===t.TEARDROP?c:e.type===t.CAP?1:c/2;var v=void 0,I=void 0;for(v=g;v<=L;v++){var x=v*Math.PI/c,T=Math.sin(x),p=Math.cos(x);for(I=y;I<=l;I++){var w=I*this.TWO_PI/l,S=Math.sin(w),D=Math.cos(w),b=void 0,N=void 0,E=void 0,j=void 0,A=void 0,z=void 0,P=v/L;z=P/2;var C=I/l;switch(j=1-C,A=1-P,b=D*T/2,E=S*T/2,e.type){case t.CAP:b=D/4,E=S/4,N=0;break;case t.CYLINDER:f>0&&P<=f?N=1-f:1!==m&&P>=m?N=1-m:(N=1-P,b=D/2,E=S/2),N-=.5;break;case t.SPHERE:N=p/2;break;case t.TOPDOME:case t.DOME:N=p/2;break;case t.SKYDOME:N=p/2,j=C;break;case t.BOTTOMDOME:N=(1-p)/2-.5,j=C,A=P;break;case t.SPINDLE:P<=.4?(b=D*P,E=S*P):(b=D*(1-P+1/L),E=S*(1-P+1/L)),N=1-P-.5;break;case t.TEARDROP:P<.5?N=p/4:(b=2*D*(.5-z),E=2*S*(.5-z),N=p/2);break;case t.CONE:P<=f?(N=1-f,b=D*z,E=S*z):P>m?(N=1-m,b=D*T/2,E=S*T/2):(N=1-P,b=D*z,E=S*z),N-=.5;break;case t.TOPCONE:b=D*z,E=S*z,N=.5-z;break;case t.BOTTOMCONE:b=D*(.5-z),E=S*(.5-z),N=0-z}s.push(j,A);var O=r.normalize([0,0,0],[b,N,E]);if(o.push(O[0],O[1],O[2]),n.push(b*h,N*M,E*d),e.type!==t.BOTTOMDOME&&e.type!==t.BOTTOMCONE&&e.type!==t.SKYDOME||(N=-N),v!==L&&I!==l){var R=v*(l+1)+I,F=R+l+1;a.push(R+1,F+1,F),a.push(R,R+1,F)}}}return e.type===t.SKYDOME&&(i.indices.data=a.reverse()),{vertices:n,indices:a,normals:o,texCoords:s,tangents:u}}},{key:"geometryCap",value:function(e){return this.geometrySphere(e)}},{key:"geometryDome",value:function(e){return this.geometrySphere(e)}},{key:"geometryTopDome",value:function(e){return this.geometrySphere(e)}},{key:"geometrySkyDome",value:function(e){return e.visibleFrom=this.INSIDE,this.geometrySphere(e)}},{key:"geometryBottomDome",value:function(e){return this.geometrySphere(e)}},{key:"geometryCylinder",value:function(e){return this.geometrySphere(e)}},{key:"geometryCone",value:function(e){return this.geometrySphere(e)}},{key:"geometryTopCone",value:function(e){return this.geometrySphere(e)}},{key:"geometryBottomCone",value:function(e){return this.geometrySphere(e)}},{key:"geometrySpindle",value:function(e){return this.geometrySphere(e)}},{key:"geometryTeardrop",value:function(e){return this.geometrySphere(e)}},{key:"geometryCapsule",value:function(e){function t(e,t,n,s){for(var c=1/(e-1),h=0;h<e;h++){var M=Math.cos(r*h*c)*t,d=Math.sin(r*h*c)*t;i.push(u*M,u*n+l*s,u*d),a.push(M,n,d);var f=1-h*c,m=.5+(u*n+l*s)/(2*u+l);o.push(f,m)}}for(var r=this.TWO_PI,i=(this.typeList,this.glMatrix.vec3,this.util,e.geometry,[]),n=[],a=[],o=[],s=[],u=e.dimensions[0]||.5,l=e.dimensions[1]||1,c=e.divisions[0]||12,h=e.divisions[1]||12,M=c+1,d=c+M,f=1/(M-1),m=1/(c-1),g=0;g<c/2;g++)t(h,Math.sin(Math.PI*g*m),Math.sin(Math.PI*(g*m-.5)),-.5);for(var y=0;y<M;y++)t(h,1,0,y*f-.5);for(var L=c/2;L<c;L++)t(h,Math.sin(Math.PI*L*m),Math.sin(Math.PI*(L*m-.5)),.5);for(var v=0;v<d-1;v++)for(var I=0;I<h-1;I++)n.push(v*h+(I+1),v*h+(I+0),(v+1)*h+(I+1)),n.push((v+1)*h+(I+0),(v+1)*h+(I+1),v*h+I);return{vertices:i,indices:n,normals:a,texCoords:o,tangents:s}}},{key:"geometryCube",value:function(e){function t(t,r,i,n,a,o,u,c,h,M,d){for(var f=v,m=0;m<=u;m++)for(var g=0;g<=o;g++){var I=y[v]=[0,0,0];I[t]=(-n/2+g*n/o)*h,I[r]=(-a/2+m*a/u)*M,I[i]=c,e.heightMap&&(I[i]=e.heightMap.getPixel(g,m)),l.push(g/o,1-m/u),++v}for(var x=[],T=0;T<u;T++)for(var p=0;p<o;p++){var w=f+T*(o+1)+p;s.push(w,w+o+1,w+o+2),s.push(w,w+o+2,w+1),x.push(w,w+o+1,w+o+2),x.push(w,w+o+2,w+1)}L[d]=x}var r=this.glMatrix.vec3,i=this.util.flatten,n=this.typeList,a=this.directions,o=(e.geometry,[]),s=[],u=[],l=[],c=[],h=e.dimensions[0],M=e.dimensions[1],d=e.dimensions[2],f=e.divisions[0],m=e.divisions[1],g=e.divisions[2],y=[],L=[],v=0;switch(e.type){case n.CUBE:case n.CUBESPHERE:t(0,1,2,h,M,f,m,d/2,1,-1,a.FRONT),t(0,1,2,h,M,f,m,-d/2,-1,-1,a.BACK),t(2,1,0,d,M,g,m,-h/2,1,-1,a.LEFT),t(2,1,0,d,M,g,m,h/2,-1,-1,a.RIGHT),t(0,2,1,h,d,f,g,M/2,1,1,a.TOP),t(0,2,1,h,d,f,g,-M/2,1,-1,a.BOTTOM);break;case n.PLANE:case n.CURVEDOUTERPLANE:case n.CURVEDINNERPLANE:case n.TERRAIN:switch(e.dimensions[3]){case a.FRONT:t(0,1,2,h,M,f,m,d/2,1,-1,a.FRONT);break;case a.BACK:t(0,1,2,h,M,f,m,-d/2,-1,-1,a.BACK);break;case a.LEFT:t(2,1,0,h,M,g,m,-h/2,1,-1,a.LEFT);break;case a.RIGHT:t(2,1,0,h,M,g,m,h/2,-1,-1,a.RIGHT);break;case a.TOP:t(0,2,1,h,M,f,g,M/2,1,1,a.TOP);break;case a.BOTTOM:t(0,2,1,h,-M,f,g,-M/2,1,-1,a.BOTTOM)}}if(e.type!==n.CUBE&&e.type!==n.CUBESPHERE||0===e.divisions[3]){if((e.type===n.CURVEDOUTERPLANE||e.type===n.CURVEDINNERPLANE)&&e.dimensions[4]&&0!==e.dimensions[4]){var I=1;switch(e.dimensions[3]){case a.FRONT:e.type!==n.CURVEDINNERPLANE&&e.type!=n.INNERPLANE||(I=-1);break;case a.BACK:e.type!==n.CURVEDOUTERPLANE&&e.type!==n.OUTERPLANE||(I=-1);break;case a.LEFT:e.type!==n.CURVEDOUTERPLANE&&e.type!==n.OUTERPLANE||(I=-1);break;case a.RIGHT:e.type!==n.CURVEDINNERPLANE&&e.type!==n.INNERPLANE||(I=-1);break;case a.TOP:e.type!==n.CURVEDOUTERPLANE&&e.type!==n.OUTERPLANE||(I=-1);break;case a.BOTTOM:e.type!==n.CURVEDINNERPLANE&&e.type!==n.INNERPLANE||(I=-1)}for(var x=0;x<y.length;x++)switch(e.dimensions[3]){case a.FRONT:y[x][2]=I*Math.cos(y[x][0])*e.dimensions[4];break;case a.BACK:y[x][2]=I*Math.cos(y[x][0])*e.dimensions[4];break;case a.LEFT:y[x][0]=I*Math.cos(y[x][2])*e.dimensions[4];break;case a.RIGHT:y[x][0]=I*Math.cos(y[x][2])*e.dimensions[4];break;case a.TOP:y[x][1]=I*Math.cos(y[x][0])*e.dimensions[4];break;case a.BOTTOM:y[x][1]=-Math.cos(y[x][0])*e.dimensions[4];
}}}else for(var T=[0,0,0],p=e.divisions[3],w=h/2,S=M/2,D=d/2,b=0;b<y.length;b++){var N=y[b],E=u[b],j=[N[0],N[1],N[2]];N[0]<-w+p?j[0]=-w+p:N[0]>w-p&&(j[0]=w-p),N[1]<-S+p?j[1]=-S+p:N[1]>S-p&&(j[1]=S-p),N[2]<-D+p?j[2]=-D+p:N[2]>D-p&&(j[2]=D-p),E=[N[0],N[1],N[2]],r.sub(E,E,j),r.normalize(E,E),N=[j[0],j[1],j[2]],T=[E[0],E[1],E[2]],r.scale(T,T,p),r.add(N,N,T),y[b]=N}return o=i(y,!1),{vertices:o,indices:s,normals:u,texCoords:l,tangents:c}}},{key:"geometryOuterPlane",value:function(e){return this.geometryCube(e)}},{key:"geometryInnerPlane",value:function(e){return this.geometryCube(e)}},{key:"geometryCurvedOuterPlane",value:function(e){return this.geometryCube(e)}},{key:"geometryCurvedInnerPlane",value:function(e){return this.geometryCube(e)}},{key:"geometryTerrain",value:function(e){return e.heightMap||(console.log("Prim::geometryTerrain(): adding heightmap for:"+e.name),e.heightMap=new s.default(this.util),e.heightMap[e.heightMap.type.DIAMOND](e.divisions[0],e.divisions[2],.6,1)),this.geometryOuterPlane(e)}},{key:"geometryHexTerrain",value:function(e){}},{key:"geometryOctTerrain",value:function(e){}},{key:"geometryCubeSphere",value:function(e){return e.divisions[3]=e.dimensions[0]/2,this.geometryCube(e)}},{key:"geometryIcoSphere",value:function(e,t,r){function i(e,t){var r=1;for(b=0;b<e.length;b++){w=e[b],w[0]==r&&(t[b-1][0]=1),r=w[0];var i=[0,0];i[0]=Math.atan2(w[0],w[2])/-l,i[0]<0&&(i[0]+=1),i[1]=Math.asin(w[1])/Math.PI+.5,t[b]=i}for(t[e.length-4][0]=.125,t[0][0]=.125,t[e.length-3][0]=.375,t[1][0]=.375,t[e.length-2][0]=.625,t[2][0]=.625,t[e.length-1][0]=.875,t[3][0]=.875,b=0;b<x.length;b++)x[b][0]=1-x[b][0]}function n(e,t){for(b=0;b<e.length;b++){var r=e[b],i=c.normalize([0,0,0],[r[0],0,r[2]]),n=[0,0,0,0];n[0]=-i[2],n[1]=0,n[2]=i[0],n[3]=-1,t[b]=n}for(t[e.length-4]=[-1,0,1],t[0]=[-1,0,-1],t[e.length-3]=[1,0,-1],t[1]=[1,0,-1],t[e.length-2]=[1,0,1],t[2]=[1,0,1],t[e.length-1]=[-1,0,1],t[3]=[-1,0,1],b=0;b<4;b++)t[e.length-1-b][3]=t[b][3]=-1}function a(e,t,r,i,n){for(var a=1;a<=r;a++)n[i++]=c.lerp([0,0,0],e,t,a/r);return i}function o(e,t,r,i,n){for(var a=1;a<e;a++)n[i++]=r,n[i++]=t-1,n[i++]=t,n[i++]=r++,n[i++]=t++,n[i++]=r;return n[i++]=r,n[i++]=t-1,n[i++]=t,i}function s(e,t,r,i,n){n[i++]=r,n[i++]=t-1,n[i++]=++r;for(var a=1;a<=e;a++)n[i++]=t-1,n[i++]=t,n[i++]=r,n[i++]=r,n[i++]=t++,n[i++]=++r;return i}function u(e,t,r,i,n){n[i++]=r,n[i++]=++r,n[i++]=t-1;for(var a=1;a<=e;a++)n[i++]=t,n[i++]=t-1,n[i++]=r,n[i++]=r,n[i++]=++r,n[i++]=t++;return i}var l=this.TWO_PI,c=this.glMatrix.vec3,h=this.util.flatten,M=this.typeList,d=this.directions,f=void 0;f=e.divisions[0],f=e.type===M.REGULARTETRAHEDRON?1:e.type===M.ICOSOHEDRON?2:e.divisions[0];var m=.5*e.dimensions[0],g=f,y=this.getStdVecs.bind(this),L=[d.LEFT,d.BACK,d.RIGHT,d.FORWARD],v=(e.geometry,new Array((g+1)*(g+1)*4-3*(2*g-1))),I=new Array(v.length),x=new Array(v.length),T=new Array(v.length),p=new Array(v.length),w=0,S=0,D=0,b=void 0,N=void 0,E=void 0,j=void 0,A=void 0;for(b=0;b<4;b++)v[w++]=y(d.DOWN);for(b=1;b<=g;b++){for(E=b/g,A=c.lerp([0,0,0],y(d.DOWN),y(d.FORWARD),E),v[w++]=c.copy([0,0,0],A),N=0;N<4;N++)j=c.copy([0,0,0],A),A=c.lerp([0,0,0],y(d.DOWN),y(L[N]),E),t!==this.directions.TOP&&(D=o(b,w,S,D,I)),w=a(j,A,b,w,v),S+=b>1?b-1:1;S=w-1-4*b}for(b=g-1;b>=1;b--){for(E=b/g,A=c.lerp([0,0,0],y(d.UP),y(d.FORWARD),E),v[w++]=c.copy([0,0,0],A),N=0;N<4;N++)j=c.copy([0,0,0],A),A=c.lerp([0,0,0],y(d.UP),y(L[N]),E),t!==this.directions.BOTTOM&&(D=r===this.INSIDE?u(b,w,S,D,I):s(b,w,S,D,I)),w=a(j,A,b,w,v),S+=b+1;S=w-1-4*b}for(b=0;b<4;b++)I[D++]=S,I[D++]=w,I[D++]=++S,v[w++]=y(d.UP);for(b=0;b<v.length;b++)e.type!==M.OCTAHEDRON&&(v[b]=c.normalize([0,0,0],v[b])),T[b]=c.copy([0,0,0],v[b]);if(i(v,x),console.log(" ICOSPHERE VERTICES: "+v.length+" texCoords:"+x.length),1!=m)for(b=0;b<v.length;b++)v[b][0]*=m,v[b][1]*=e.dimensions[1]/2,v[b][2]*=e.dimensions[2]/2;return n(v,p),v=h(v,!1),x=h(x,!1),T=h(T,!1),p=h(p,!1),console.log("ICOSPHERE: vertices:"+v.length+" TANGENTS:"+p.length),{vertices:v,indices:I,normals:T,texCoords:x,tangents:p}}},{key:"geometryRegularTetrahedron",value:function(e){return this.geometryIcoSphere(e)}},{key:"geometryIcosohedron",value:function(e){return this.geometryIcoSphere(e)}},{key:"geometryPrism",value:function(e){}},{key:"geometryPyramid",value:function(e){}},{key:"geometryIcoDome",value:function(e){return this.geometryTopIcoDome(e)}},{key:"geometryTopIcoDome",value:function(e){return this.geometryIcoSphere(e,this.directions.TOP)}},{key:"geometrySkyIcoDome",value:function(e){return e.visibleFrom=this.INSIDE,this.geometryIcoSphere(e,this.directions.TOP,e.visibleFrom)}},{key:"geometryBottomIcoDome",value:function(e){return this.geometryIcoSphere(e,this.directions.BOTTOM)}},{key:"geometryOctahedron",value:function(e){return this.geometryIcoSphere(e)}},{key:"geometryDodecahedron",value:function(e){var t=this.glMatrix.vec3,r=this.util.flatten,i=(e.geometry,[]),n=[],a=[],o=[],s=[],u=e.dimensions[0],l=e.dimensions[1],c=e.dimensions[2],h=(e.divisions[0]||.5,(1+Math.sqrt(5))/2),M=.5,d=.5/h,f=.5*(2-h),m=[[f,0,M],[-f,0,M],[-d,d,d],[0,M,f],[d,d,d],[d,-d,d],[0,-M,f],[-d,-d,d],[f,0,-M],[-f,0,-M],[-d,-d,-d],[0,-M,-f],[d,-d,-d],[d,d,-d],[0,M,-f],[-d,d,-d],[M,f,0],[-M,f,0],[-M,-f,0],[M,-f,0]],g=[[4,3,2,1,0],[7,6,5,0,1],[12,11,10,9,8],[15,14,13,8,9],[14,3,4,16,13],[3,14,15,17,2],[11,6,7,18,10],[6,11,12,19,5],[4,0,5,19,16],[12,8,13,16,19],[15,9,10,18,17],[7,1,2,17,18]];if(e.applyTexToFace)for(var y=0;y<g.length;y++){var L=i.length,v=this.computeFan(m,g[y]);i=i.concat(v.vertices);for(var I=0;I<v.indices.length;I++)v.indices[I]+=L;n=n.concat(v.indices),o=o.concat(v.texCoords),a=a.concat(v.normals)}else for(var x=0;x<g.length;x++){for(var T=g[x],p=[],w=T.length,S=0;S<T.length;S++)p.push(m[T[S]]);for(var D=this.geometry.computeCentroid(p),b=1;b<=w;b++){var N=b-1,E=b;b===w&&(N=E-1,E=0);var j=p[N],A=p[E];i.push(t.copy([0,0,0],j),t.copy([0,0,0],A),t.copy([0,0,0],D));var z=i.length-1;n.push(z-2,z-1,z),a.push(t.copy([0,0,0],j),t.copy([0,0,0],A),t.copy([0,0,0],D)),o.push(this.computeSphericalCoords(j),this.computeSphericalCoords(A),this.computeSphericalCoords(D))}}for(var P=0;P<i.length;P++){var C=i[P];C[0]*=u,C[1]*=l,C[2]*=c}return i=r(i),o=r(o),a=r(a),{vertices:i,indices:n,normals:a,texCoords:o,tangents:s}}},{key:"geometryTorus",value:function(e){for(var t=this.glMatrix.vec3,r=(e.geometry,[]),i=[],n=[],a=[],o=[],s=e.dimensions[0]/2,u=e.dimensions[2]/2,l=e.divisions[0],c=e.divisions[1],h=c+1,M=l+1,d=this.TWO_PI/l,f=this.TWO_PI/c,m=0,g=0,y=void 0,L=void 0,v=void 0,I=0;I<M;I++){m=d*I;for(var x=0;x<h;x++){g=f*x,y=Math.cos(m)*(s+u*Math.cos(g)),L=Math.sin(m)*(s+u*Math.cos(g)),v=u*Math.sin(g),r.push(y,L,v);var T=t.normalize([0,0,0],[y,L,v]);n.push(T[0],T[1],T[2]);var p=x/h,w=I/M;a.push(p,w)}}for(var S=0;S<l;S++)for(var D=0;D<c;D++){var b=D+S*h,N=D+1+S*h,E=D+(S+1)*h,j=D+1+(S+1)*h;i.push(E,j,N,E,N,b)}return{vertices:r,indices:i,normals:n,texCoords:a,tangents:o}}},{key:"geometryTunnel",value:function(e){}},{key:"geometrySpring",value:function(e){}},{key:"geometryMesh",value:function(e,t){this.modelPool.getModels(e,e.models,!0)}},{key:"addGeometry",value:function(e,t,r){if(e===this.typeList.MESH)this.geometryMesh(t);else{var i=this[e](t);i.colors=[],this.util.emitter.emit(this.util.emitter.events.GEOMETRY_READY,t,r,i)}}},{key:"getGeometries",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t&&e.type===this.typeList.MESH)for(var r=0;r<t.length;r++){var i=t[r];if(i){var n=this.modelPool.pathInList(i);n?(console.log("GeometryPool::getGeometries(): model file "+i+" already in the pool for:"+e.name),e.models.push(n)):(console.log("GeometryPool::getGeometries(): new model file "+i+" for "+e.name),this.modelPool.getModels(e,t,!0))}else console.warn("GeometryPool::getTextures(): no path supplied for position "+r)}else{console.log("GeometryPool::getGeometries() new procedural geometry for:"+e.name);var a=this.modelPool.addAsset(this[e.type](e));window.modelPool=this.modelPool,a.type=e.type,a.path=a.key,a.material=this.util.DEFAULT_KEY,a.emits=this.util.emitter.events.GEOMETRY_READY,this.util.emitter.emit(a.emits,e,a.key,0)}}}]),e}());t.default=d},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),u=r(10),l=i(u),c=function(e){function t(e){n(this,t),console.log("in Map2d");var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.type={PLANE:"initPlane",RANDOM:"initRandom",DIAMOND:"initDiamond",IMAGE:"initImage"},r.edgeType={NONE:0,WRAP:1,TOZERO:2},r.width=0,r.depth=0,r.low=0,r.high=0,r.map=null,r.squareSize=0,r.max=0,r.canvas=r.ctx=r.imgData=null,r}return o(t,e),s(t,[{key:"checkParams",value:function(e,t,r,i){return e<1||t<1?(console.error("invalid map width or height, was:"+e+", "+t),!1):r<0||r>1?(console.error("invalid Map roughness (0-1), was:"+r),!1):!(i<0||i>1)||(console.error("invalid Map flatten (0-1.0), was:"+i),!1)}},{key:"getPixel",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(e<0||e>this.width||t<0||t>this.depth)switch(r){case this.edgeType.WRAP:e<0&&(e=this.width-e),e>this.width-1&&(e-=this.width),t<0&&(t=this.depth-t),t>this.depth-1&&(t-=this.depth);break;case this.edgeType.TOZERO:var i=e,n=t;return e<0&&(e=0),e>this.width-1&&(e=this.width-1),t<0&&(t=0),t>this.depth-1&&(t=this.depth-1),this.map[e+this.squareSize*t]/(Math.abs(i-e)+Math.abs(n-t));default:return console.error("getPixel out of range x:"+e+" z:"+t+" width:"+w+" height:"+h+" max:"+this.max),-1}return this.map[e+this.width*t]}},{key:"setPixel",value:function(e,t,r){return e<0||e>this.max||t<0||t>this.max?(console.error("setPixel out of range x:"+e+" z:"+t+" max:"+this.max),-1):(this.low>r&&(this.low=r),this.high<r&&(this.high=r),void(this.map[e+this.width*t]=r))}},{key:"initPlane",value:function(e,t){this.checkParams(e,t,0,0)?(this.img=this.map=null,this.map=new Float32Array(e*t),this.width=e,this.depth=t,this.squareSize=Math.min(e*t)):console.error("error creating Map2d using "+this.type.PLANE)}},{key:"initRandom",value:function(e,t,r){if(this.checkParams(e,t,r,0)){this.map=new Float32Array(e*t),this.width=e,this.depth=t,this.squareSize=Math.min(e,t),this.max=this.squareSize-1;for(var i=this.util,n=0,a=this.map.length;n<a;n++)this.map[n]=i.getRand()*r}else console.error("error creating Map using "+this.type.RANDOM)}},{key:"initDiamond",value:function(e,t,r,i){if(this.checkParams(e,t,r,i)){this.img=this.map=null,console.log("starting width:"+e+" height:"+t+" roughness:"+r);var n=Math.pow(2,Math.ceil(Math.log((e+t)/2)/Math.log(2)));console.warn("random map, selecting nearest power of 2 ("+n+" x "+n+")"),this.squareSize=n+1,this.width=this.depth=n,this.map=new Float32Array(this.squareSize*this.squareSize),this.max=this.squareSize-1,this.setPixel(0,0,this.max),this.setPixel(this.max,0,this.max/2),this.setPixel(this.max,this.max,0),this.setPixel(0,this.max,this.max/2),this.divide(this.max,r),this.setPixel(0,0,(this.getPixel(0,1)+this.getPixel(1,0))/2),this.flatten(i/this.squareSize)}else console.error("error creating Map using "+this.type.DIAMOND)}},{key:"initImage",value:function(e,t,r,i){var n=this;this.checkParams(e,t,roughness,flatten),this.canvas||(this.canvas=document.createElement("canvas")),this.ctx||(this.ctx=this.canvas.getContext("2d"));var a=new Image;a.style.display="none",a.onload=function(){n.ctx.drawImage(a,0,0),n.imgData=n.ctx.getImageData(0,0,a.width,a.height),n.width=a.width,n.depth=a.height,n.squareSize=Math.min(e,h),n.max=n.squareSize-1,n.map=new Float32Array(n.squareSize);for(var t=0,r=n.imgData,i=0,o=n.data.length;i<o;i++)n.map[t++]=r[i]+r[i+1]+r[i+2]/3},a.onerror=function(){console.error("image could not be loaded:"+r)},a.src=r,i(this.data)}},{key:"divide",value:function(e,t){var r=void 0,i=void 0,n=e/2,a=t*e,o=this.util;if(!(n<1)){for(i=n;i<this.max;i+=e)for(r=n;r<this.max;r+=e)this.square(r,i,n,o.getRand()*a*2-a);for(i=0;i<=this.max;i+=n)for(r=(i+n)%e;r<=this.max;r+=e)this.diamond(r,i,n,o.getRand()*a*2-a);this.divide(e/2,t)}}},{key:"average",value:function(e){var t=e.filter(function(e){return e!==-1}),r=t.reduce(function(e,t){return e+t},0);return r/t.length}},{key:"square",value:function(e,t,r,i){var n=this.average([this.getPixel(e-r,t-r),this.getPixel(e+r,t-r),this.getPixel(e+r,t+r),this.getPixel(e-r,t+r)]);this.setPixel(e,t,n+i)}},{key:"diamond",value:function(e,t,r,i){var n=this.average([this.getPixel(e,t-r),this.getPixel(e+r,t),this.getPixel(e,t+r),this.getPixel(e-r,t)]);this.setPixel(e,t,n+i)}},{key:"flatten",value:function(e){var t=void 0;if(this.map&&this.map.length)for(var r=this.map,i=0,n=r.length;i<n;i++)r[i]*=e,t=r[i],this.high<t&&(this.high=t),this.low>t&&(this.low=t)}},{key:"roughen",value:function(e){this.map&&this.map.length}},{key:"scale",value:function(e,t){if(this.checkParams(e,t,0,0)){var r=new Float32Array(e*t),i=this.width/e,n=this.depth/t;console.log("original width:"+this.width+" new:"+e+"original height:"+this.depth+" new:"+t),console.log("xScale:"+i+" zScale:"+n);for(var a=0;a<t;a++)for(var o=0;o<e;o++)r[e*a+o]=this.biCubic(o*i,a*n);console.log("WIDTH:"+e+" HEIGHT:"+t),this.map=r,this.width=e,this.depth=t,this.squareSize=Math.min(e,t),this.max=this.squareSize-1}}},{key:"biLinear",value:function(e,t){if(e<0||e>1||t<0||t>1)return console.error("heightmap x index out of range, x:"+e+" z:"+t),null;e*=this.width,t*=this.depth;var r=Math.min(e),i=Math.max(e),n=Math.min(t),a=Math.max(t),o=this.getPixel(r,n)*(e-r)+this.getPixel(r,a)*(1-e-r),s=this.getPixel(n,a)*(e-r)+this.getPixel(i,a)*(1-e-r),u=o*(t-n)+s*(1-t-n);return u}},{key:"biCubicPoint",value:function(e,t,r,i,n,a,o,s,u,l,c,h,M,d,f,m,g,y){var L=t*t,v=e*e,I=e*v,x=a-n-r+i,T=r-i-x,p=n-r,w=x*I+T*v+p*e+i,S=l-u-o+s,D=o-s-S,b=u-o,N=S*I+D*v+b*e+s,E=d-M-c+h,j=c-h-E,A=M-c,z=E*I+j*v+A*e+h,P=y-g-f+m,C=f-m-P,O=g-f,R=P*I+C*v+O*e+m,F=R-z-w+N,k=w-N-F,_=z-w;return F*t*L+k*L+_*t+N}},{key:"biCubic",value:function(e,t){var r=Math.floor(e),i=Math.floor(t),n=r+1,a=i+1,o=this.getPixel(r-1,i-1),s=this.getPixel(r-1,i),u=this.getPixel(r-1,a),l=this.getPixel(r-1,a+1),c=this.getPixel(r,i-1),h=this.getPixel(r,i),M=this.getPixel(r,a),d=this.getPixel(r,a+1),f=this.getPixel(n,i-1),m=this.getPixel(n,i),g=this.getPixel(n,a),y=this.getPixel(n,a+1),L=this.getPixel(n+1,i-1),v=this.getPixel(n+1,i),I=this.getPixel(n+1,a),x=this.getPixel(n+1,a+1);return this.biCubicPoint(e-r,t-i,o,c,f,L,s,h,m,v,u,M,g,I,l,d,y,x)}}]),t}(l.default);t.default=c},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),u=r(10),l=i(u),c=function(e){function t(e){n(this,t),console.log("in Map3d");var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.type={CLOUD:"initPlane",SPHERE:"initRandom"},r.width=0,r.depth=0,r.low=0,r.high=0,r.map=null,r}return o(t,e),s(t,[{key:"checkParams",value:function(e,t,r,i,n){return!1}},{key:"getPoint",value:function(e,t,r){}},{key:"setPoint",value:function(e,t,r,i){}},{key:"initRandom",value:function(e,t,r,i){if(this.checkParams(e,r,roughness,0)){this.type=this.CLOUD,this.map=new Float32Array(i),this.mapColors=new Float32Array(i),this.width=e,this.height=t,this.depth=r;for(var n=this.util,a=0;a<this.map.length;a++)this.map.push(n.getRand()*e,n.getRand()*t,n.getRand()*r),this.mapColors.push(n.getRand(0,255),n.getRand(0,255),n.getRand(0,255),1)}else console.error("error creating Map3d using "+this.type.RANDOM)}},{key:"initSphere",value:function(e,t,r,i){}},{key:"initFromData",value:function(e){}}]),t}(l.default);t.default=c},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(t){r(this,e),this.util=t};t.default=i},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;r(this,e),this.x=t,this.y=i,this.z=n}return i(e,[{key:"isValid",value:function(){return Number.isFinite(this.x)&&Number.isFinite(this.y)&&Number.isFinite(this.z)}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}},{key:"subtract",value:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}},{key:"scale",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"distance",value:function(e,t){var r=this.x-e.x,i=this.y-e.y,n=this.z-e.z;return t?(Math.abs(r)+Math.abs(i)+Math.abs(n))/3:Math.sqrt(r*r+i*i+n*n)}},{key:"clone",value:function(){return new e(this.x,this.y,this.z)}}]),e}(),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[];r(this,e),this.coords=new n(t,i,a),this.texCoords={u:o,v:s},this.idx=u,this.e=[],this.s=[],this.vertexArr=l}return i(e,[{key:"isValid",value:function(){var e=this.texCoords;return this.idx===-1?(console.error("Vertex::isValid(): index never set!"),!1):!!(this.coords.isValid()&&Number.isFinite(parseFloat(e.u))&&e.u>=0&&Number.isFinite(parseFloat(e.v))&&e.v>=0)||(console.error("Vertex::isValid(): undefined coordinates for:"+this.idx),!1)}},{key:"distance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.coords.distance(e.coords,t)}},{key:"set",value:function(e,t,r,i,n){return this.coords.x=e,this.coords.y=t,this.coords.z=r,void 0!==i&&(this.texCoords.u=i),void 0!==n&&(this.texCoords.v=n),this}},{key:"add",value:function(e){return this.coords.add(e.coords),this}},{key:"subtract",value:function(e){return this.coords.subtract(e.coords),this}},{key:"scale",value:function(e){return this.coords.scale(e),this}},{key:"clone",value:function(t){for(var r=new e(this.coords.x,this.coords.y,this.coords.z,this.texCoords.u,this.texCoords.v,this.idx,t),i=0;i<this.e.length;i++)r.e.push(this.e[i]);for(var n=0;n<this.s.length;n++)r.s.push(this.s[n]);return r}}]),e}(),o=function(){function e(t,i,n,a){r(this,e),this.v=new Array(2),this.ov=new Array(2),this.f=new Array(2),this.v[0]=t,this.v[1]=i,this.f[0]=a,this.f[1]=4294967295,this.ov[0]=n,this.ov[1]=n}return i(e,[{key:"isValid",value:function(){return!(!this.v[0].isValid()||!this.v[1].isValid)}},{key:"getOpposite",value:function(e){return e.idx===this.v[0]?this.v[1]:e.idx===this.v[1]?this.v[0]:void console.error("Edge::getOpposite(): invalid Vertex:"+e.idx+" supplied, our Edge:"+this.v[0]+", "+this.v[1])}}]),e}(),s=function e(t,i,n){r(this,e),this.e=new Array(3),this.e[0]=t,this.e[1]=i,this.e[2]=n},u=function(){function e(t){r(this,e),this.prim=t,this.util=t.util,this.geo=t.geometry,this.type=this.geo.type,this.vertexArr=[],this.indexArr=[],this.edgeArr=[],this.edgeMap=[],this.faceArr=[],this.valenceArr=[],this.oldVertexArr=[],this.avDistance=0,this.width=0,this.height=0,this.depth=0,this.centroid=null,this.iterations=0,this.epsilon=1e-9,this.fw=3/8,this.ow=1/8,this.f0w=.5,this.badIndex32=4294967294,this.NOT_IN_LIST=-1,this.computeValencyWeights(100),this.geometryToVertex(this.geo.vertices.data,this.geo.indices.data,this.geo.texCoords.data)}return i(e,[{key:"computeValencyWeights",value:function(e){this.valenceArr=new Array(e),this.valenceArr[0]=0,this.valenceArr[1]=0,this.valenceArr[2]=1/8,this.valenceArr[3]=3/16;for(var t=4;t<e;t++)this.valenceArr[t]=1/t*(5/8-Math.pow(3/8+.25*Math.cos(2*Math.PI/t),2))}},{key:"computeCentroid",value:function(){var e=arguments.length,t=0,r=0,i=0,n=0,o=0;for(var s in arguments){var u=arguments[s];t+=u.coords.x,r+=u.coords.y,i+=u.coords.z,n+=u.texCoords.u,o+=u.texCoords.v}return t/=e,r/=e,i/=e,n/=e,o/=e,new a(t,r,i,n,o,0,null)}},{key:"computeVertices",value:function(e,t){var r=0,i=0,o=0,s=new n,u=new n,l=new n,c=e.length/3,h=new Array(c);for(r=0;r<c;r++){h[r]=new a(e[i++],e[i++],e[i++],t[o++],t[o++],r,h);var M=h[r];if(r>0){var d=M.coords;s.x=Math.min(s.x,d.x),u.x=Math.max(u.x,d.x),s.y=Math.min(s.y,d.y),u.y=Math.min(s.y,d.y),s.z=Math.min(s.z,d.z),u.z=Math.min(u.z,d.z),l.add(d)}this.centroid=l.scale(1/c)}return this.width=u.x-s.x,this.height=u.y-s.y,this.depth=u.z-s.z,h}},{key:"computeEdge",value:function(e,t,r,i){var n=this.vertexArr,a=this.edgeArr,s=-1,u=Math.min(e,t),l=Math.max(e,t),c=u+"-"+l;if(c in this.edgeMap){s=this.edgeMap[c];var h=a[s];h.f[1]=i,h.ov[1]=r}else{s=a.length,this.edgeMap[c]=s;var M=new o(u,l,r,i);a.push(M),n[u].e.push(s),n[l].e.push(s)}return s}},{key:"computeFaces",value:function(){for(var e=(this.vertexArr,this.indexArr),t=e.length,r=this.faceArr,i=0;i<t;i+=3){var n=e[i],a=e[i+1],o=e[i+2],u=i/3,l=new s(this.computeEdge(n,a,o,u),this.computeEdge(a,o,n,u),this.computeEdge(o,n,a,u),u);r.push(l)}}},{key:"computeEven",value:function(e,t){var r=this.edgeArr,i=e.e.length;e.e;if(i<6)return!1;for(var n=this.valenceArr[i],a=1-i*n,o=e.coords,s=e.texCoords,u=a*o.x,l=a*o.y,c=a*o.z,h=a*s.u,M=a*s.v,d=0;d<i;d++){var f=t[r[e.e[d]].getOpposite(e)];o=f.coords,s=f.texCoords,u+=n*o.x,l+=n*o.y,c+=n*o.z,h+=n*s.u,M+=n*s.v}return e.set(u,l,c,h,M),!0}},{key:"computeOdd",value:function(e,t,r,i){var n=this.fw,a=this.ow,o=this.f0w,s=this.edgeArr,u=s[this.edgeMap[r]];if(u||(u=s[this.edgeMap[i]]),u){var l=t[u.v[0]],c=t[u.v[1]],h=t[u.ov[0]],M=t[u.ov[1]],d=void 0,f=void 0,m=void 0,g=void 0,y=void 0;return h!==M?(d=n*(l.coords.x+c.coords.x),f=n*(l.coords.y+c.coords.y),m=n*(l.coords.z+c.coords.z),g=n*(l.texCoords.u+c.texCoords.u),y=n*(l.texCoords.v+c.texCoords.v),d+=a*(h.coords.x+M.coords.x),f+=a*(h.coords.y+M.coords.y),m+=a*(h.coords.z+M.coords.z),g+=a*(h.texCoords.u+M.texCoords.u),y+=a*(h.texCoords.v+M.texCoords.v),e.set(d,f,m,g,y),!0):(d=o*(l.coords.x+c.coords.x),f=o*(l.coords.y+c.coords.y),m=o*(l.coords.z+c.coords.z),g=o*(l.texCoords.u+c.texCoords.u),y=o*(l.texCoords.v+c.texCoords.v),e.set(d,f,m,g,y),!0)}return console.error("Mesh::computeEven(): invalid keys:"+r+","+i+" edge is undefined"),!1}},{key:"subdivide",value:function(e){if(this.geo.vertices.data.length/3>this.geo.MAX_DRAWELEMENTS)return console.warn("subdivision of "+geo.type+" would exceed ability of device to render indexed meshes, aborting..."),this;this.geometryToVertex(this.geo.vertices.data,this.geo.indices.data,this.geo.texCoords.data,this.geo.colors.data),this.isValid();var t=this.vertexArr,r=this.indexArr;this.oldVertexArr=this.vertexArr.slice(),this.oldIndexArr=this.indexArr.slice();var i=[],n=[],a=[],o=[];this.edgeMap=[],this.midMap=[],this.faceArr=[],this.edgeArr=[];var s=(this.edgeArr,this.NOT_IN_LIST),u=void 0,l=void 0,c=void 0;console.log("Mesh::subdivide(): "+this.prim.name+" beginning subdivision, "+this.iterations+", starting size:"+this.oldVertexArr.length),this.computeFaces();for(var h=0;h<r.length;h+=3){var M=r[h+0],d=r[h+1],f=r[h+2];u=a[M]?i[a[M]]:t[M].clone(i),l=a[d]?i[a[d]]:t[d].clone(i),c=a[f]?i[a[f]]:t[f].clone(i);var m=i.indexOf(u);m===s&&(i.push(u),m=i.length-1,a[M]=m);var g=i.indexOf(l);g===s&&(i.push(l),g=i.length-1,a[d]=g);var y=i.indexOf(c);y===s&&(i.push(c),y=i.length-1,a[f]=y);var L=void 0,v=void 0,I=void 0,x=void 0,T=void 0,p=void 0;e&&(this.computeEven(u,t),this.computeEven(l,t),this.computeEven(c,t));var w=m+"-"+g,S=g+"-"+m;o[w]?x=o[w]:o[S]?x=midhash[S]:(L=this.computeCentroid(u,l),L.vertexArr=i,L.idx=i.length,e&&this.computeOdd(L,t,M+"-"+d,d+"-"+M),i.push(L),x=i.length-1,o[w]=x,o[S]=x),w=g+"-"+y,S=y+"-"+g,o[w]?T=o[w]:o[S]?T=midhash[S]:(v=this.computeCentroid(l,c),v.vertexArr=i,v.idx=i.length,e&&this.computeOdd(v,t,d+"-"+f,f+"-"+d),i.push(v),T=i.length-1,o[w]=T,o[S]=T),w=y+"-"+m,S=m+"-"+y,o[w]?p=o[w]:o[S]?p=midhash[S]:(I=this.computeCentroid(c,u),I.vertexArr=i,I.idx=i.length,e&&this.computeOdd(I,t,f+"-"+M,M+"-"+f),i.push(I),p=i.length-1,o[w]=p,o[S]=p),n.push(x,g,T,T,p,x,p,T,y,p,m,x)}return this.iterations++,this.vertexArr=i,this.indexArr=n,this.vertexToGeometry(),console.log("Mesh::subdivde(): "+this.prim.name+" subdivided from "+this.oldVertexArr.length+" to:"+this.vertexArr.length+" index length:"+this.indexArr.length),this}},{key:"simplify",value:function(){this.NOT_IN_LIST;console.log("Simplifying mesh... type:"+this.geo.type);var e=this.vertexArr,t=this.indexArr,r=[],i=[];this.oldIndexArr=t,this.oldVertexArr=e,this.vertexArr=r,this.indexArr=i,console.log("Mesh::simplify(): oldVertexArr:"+e.length+", newVertexArr simplified to:"+r.length),this.vertexToGeometry()}},{key:"geometryToVertex",value:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return this.indexArr=t.slice(),this.vertexArr=this.computeVertices(e,r,i),console.log("Mesh::geometryToVertex(): numVertices:"+this.vertexArr.length+" numIndices:"+this.indexArr.length),this}},{key:"vertexToGeometry",value:function(){var e=this.prim,t=this.geo;console.log("Mesh::vertexToGeometry()");var r=this.vertexArr,i=r.length,n=(this.indexArr,this.indexArr.slice());t.vertices.data=new Array(3*r.length),t.texCoords.data=new Array(2*r.length);for(var a=t.vertices.data,o=t.texCoords.data,s=0;s<i;s++){var u=3*s,l=2*s,c=r[s];if(!c){console.warn("Mesh::vertexToGeometry(): no vertex in vertexArr at pos:"+s),a=a.slice(s);break}var h=c.coords,M=c.texCoords;a[u]=h.x,a[u+1]=h.y,a[u+2]=h.z,o[l]=M.u,o[l+1]=M.v}return console.log("Mesh::vertexToGeometry(): vertices:"+a.length/3+" indices:"+n.length+" texCoords:"+o.length/2),t.setVertices(a),t.setIndices(n),t.setTexCoords(o),e.updateNormals(),e.updateTangents(),e.updateColors(),t}},{key:"isValid",value:function(){var e=this.vertexArr;if(!(e.length>0))return console.error("Mesh::isValid(): vertex array empty, vertex:"+e.length),!1;var t=this.indexArr;if(!(t.length>0))return console.error("Mesh::isValid(): index array empty, vertex:"+e.length+" index:"+t.length),!1;if(!(e.length>0))return console.error("Mesh::isValid(): no vertex and/or index array defined"),!1;for(var r=0;r<e.length;r++)if(!e[r].isValid())return console.error("Mesh::isValid(): invalid supplied vertex at:"+r),!1;return!0}}]),e}();t.default=u},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=r(8),s=(i(o),r(9)),u=(i(s),r(11)),l=i(u),c=r(4),h=i(c),M=r(7),d=(i(M),r(13)),f=(i(d),r(5)),m=(i(f),r(6)),g=(i(m),r(20)),y=i(g),L=function(){function e(t,r){var i=this;n(this,e),console.log("in PrimFactory class"),this.util=r.util,this.webgl=r.webgl,this.glMatrix=r.glMatrix,this.texturePool=r.texturePool,this.modelPool=r.modelPool,this.geometryPool=r.geometryPool,this.materialPool=r.materialPool,this.prims=[],this.util.emitter.on(this.util.emitter.events.GEOMETRY_READY,function(e,t,r,n){i.initPrimGeometry(e,i.modelPool.keyList[t],r),e.shader.addPrim(e,n)}),this.util.emitter.on(this.util.emitter.events.MATERIAL_READY,function(e,t,r){i.initPrimMaterial(e,i.materialPool.keyList[t],r),e.shader.addPrim(e)}),this.util.emitter.on(this.util.emitter.events.TEXTURE_2D_READY,function(e,t,r){i.initPrim2dTexture(e,i.texturePool.keyList[t],r),e.shader.addPrim(e)}),this.util.emitter.on(this.util.emitter.events.TEXTURE_2D_ARRAY_READY,function(e,t){e.shader.addPrim(e)}),this.util.emitter.on(this.util.emitter.events.TEXTURE_3D_READY,function(e,t){e.shader.addPrim(e)}),this.util.emitter.on(this.util.emitter.events.TEXTURE_CUBE_MAP_READY,function(e,t){e.shader.addPrim(e)}),this.util.emitter.on(this.util.emitter.events.PRIM_ADDED_TO_SHADER,function(e){e.materials.length<1&&e.setMaterial(i.util.DEFAULT_KEY)})}return a(e,[{key:"setVertexData",value:function(e){e=[];for(var t in this.prims)e=e.concat(this.prims[t].geometry.vertices.data);return e}},{key:"setIndexData",value:function(e){e=[];for(var t in this.prims)e=e.concat(this.prims[t].geometry.indices.data);return e}},{key:"initPrim2dTexture",value:function(e,t,r){e.textures[r]=t}},{key:"initPrimGeometry",value:function(e,t,r){if(t.usemtl!==this.util.DEFAULT_KEY){var i=this.materialPool.nameInList(t.usemtl);e.materials.length>0&&e.materials[0].name===this.util.DEFAULT_KEY?e.materials[0]=i:e.materials.push(i)}e.updateVertices(t.vertices),e.boundingBox=e.computeBoundingBox(e.geometry.vertices.data),e.updateIndices(t.indices),e.updateNormals(t.normals),e.updateTexCoords(t.texCoords),e.updateTangents(),e.updateColors();new l.default(e);console.log("checking buffer data for "+e.name)}},{key:"initPrimMaterial",value:function(e,t,r){e.materials.length>0&&e.materials[0].name===this.util.DEFAULT_KEY?e.materials[0]=t:e.materials.push(t)}},{key:"createPrim",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unknown",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1,0,0],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1,1,0,0],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.glMatrix.vec3.create(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this.glMatrix.vec3.create(),s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:this.glMatrix.vec3.create(),u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:this.glMatrix.vec3.create(),l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[],c=(arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,this),M=arguments.length>11&&void 0!==arguments[11]&&arguments[11],d=arguments.length>12&&void 0!==arguments[12]?arguments[12]:[],f=this.glMatrix.vec3,m=this.glMatrix.mat4;if(!this.geometryPool.checkType(t))return console.error("Prim::createPrim(): unsupported Prim type:"+t),null;var g={},L=g;return g.setMV=function(e){
var t=-5;return f.add(L.position,L.position,L.acceleration),m.translate(e,e,[L.position[0],L.position[1],t+L.position[2]]),f.add(L.rotation,L.rotation,L.angular),m.rotate(e,e,L.rotation[0],[1,0,0]),m.rotate(e,e,L.rotation[1],[0,1,0]),m.rotate(e,e,L.rotation[2],[0,0,1]),e},g.setLight=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[1,1,1],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[255,255,255];L.light.direction=e,L.light.color=t},g.setMaterial=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[.1,.1,.1],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0,0],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1,1,1],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:250,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;L.materials.push({colorMult:t,ambient:r,diffuse:i,specular:n,shininess:a,specularFactor:o,transparency:s,illum:u,name:e,texture:null})},g.updateVertices=function(e){var t=L.geometry;e&&e.length&&t.setVertices(e)},g.updateIndices=function(e){var t=L.geometry;e&&e.length&&t.setIndices(e)},g.updateNormals=function(e){var t=L.geometry;e&&e.length?t.setNormals(e):(console.log("Prim::updateNormals():"+L.name+" recalculating normal coordinates"),t.setNormals(c.geometryPool.computeNormals(t.vertices.data,t.indices.data,[],L.useFaceNormals)))},g.updateTexCoords=function(e){var t=L.geometry;e&&e.length>0?t.setTexCoords(e):t.numTexCoords()!==t.numVertices()&&(console.log("Prim::updateTexCoords():"+L.name+" recalculating texture coordinates"),t.setTexCoords(c.geometryPool.computeTexCoords(t.vertices.data)))},g.updateTangents=function(e){var t=L.geometry;e&&e.length?t.setTangents(e):(console.log("Prim::updateTangents():"+L.name+" recalculating tangent coordinates"),t.setTangents(c.geometryPool.computeTangents(t.vertices.data,t.indices.data,t.normals.data,t.texCoords.data,[])))},g.updateColors=function(e){var t=L.geometry;e&&e.length?t.setColors(e):(console.log("Prim::updateColors():"+L.name+" recalculating color coordinates"),t.setColors(c.geometryPool.computeColors(t.normals.data,[])))},g.computeBoundingBox=function(){c.geometryPool.computeBoundingBox(g.geometry.vertices)},g.computeBoundingSphere=function(){c.geometryPool.computeBoundingSphere(g.geometry.vertices)},g.scale=function(e){c.geometryPool.scale(e,g.geometry.vertices)},g.move=function(e){c.geometryPool.computeMove(scale,g.geometry.vertices)},g.moveTo=function(e){c.geometryPool.move([c.position[0]-e[0],c.position[1]-e[1],c.position[2]-e[2]])},g.id=this.util.computeId(),g.shader=g.defaultShader=e,g.name=r,g.type=t,g.dimensions=i||this.vec5(1,1,1,0,0,0,0),g.divisions=n||this.vec5(1,1,1,0,0,0),g.position=a||f.create(),g.acceleration=o||f.create(),g.rotation=s||f.create(),g.angular=u||f.create(),g.orbitRadius=0,g.orbitAngular=0,g.scale=1,g.light=new h.default(this.glMatrix),g.visibleFrom=this.geometryPool.OUTSIDE,g.applyTexToFace=M,g.useFaceNormals=!1,g.useTangents=!0,g.waypoints=[],g.materials=[],g.textures=[],g.audio=[],g.video=[],g.parentNode=null,g.children=[],console.log("Generating Prim:"+g.name+"("+g.type+")"),g.geometry=new y.default(g.name,this.util,this.webgl),this.geometryPool.getGeometries(g,d),this.texturePool.getTextures(g,l,!0,!1),"capsule"===g.name&&(window.capsule=g),"TORUS1"===g.name&&(window.torus=g),"objfile"===g.name&&(window.objfile=g),this.prims.push(g),g}},{key:"toJSON",value:function(e){return JSON.stringify(e)}}]),e}();t.default=L},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),u=r(2),l=i(u),c=function(e){function t(e,r,i){n(this,t),console.log("in TexturePool");var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r));return o.util=r,o.webgl=i,o.textureMimeTypes={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif"},o.greyPixel=new Uint8Array([.5,.5,.5,1]),o}return o(t,e),s(t,[{key:"setDefaultTexturePixel",value:function(e,t){var r=this.webgl.getContext(),i=this.greyPixel;if(t===r.GL_TEXTURE_CUBE_MAP)for(var n=0;n<6;++n)r.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,i);else t===r.TEXTURE_3D?r.texImage3D(t,0,r.RGBA,1,1,1,0,r.RGBA,r.UNSIGNED_BYTE,i):r.texImage2D(t,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,i)}},{key:"create2dTexture",value:function(e,t,r){var i=this.webgl.getContext(),n=i.createTexture();return i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0),i.bindTexture(i.TEXTURE_2D,n),e?i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e):(console.warn("TexturePool::create2DTexture(): no image ("+e.src+"), using default pixel texture"),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,this.greyPixel)),this.util.isPowerOfTwo(e.width)&&this.util.isPowerOfTwo(e.height)?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR_MIPMAP_NEAREST),i.generateMipmap(i.TEXTURE_2D)):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR)),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.bindTexture(i.TEXTURE_2D,null),n}},{key:"create3dTexture",value:function(e,t,r,i){console.log("creating 3D texture");var n=this.webgl.getContext(),a=n.createTexture();return n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0),n.bindTexture(n.TEXTURE_3D,a),image?(n.texParameteri(n.TEXTURE_3D,n.TEXTURE_BASE_LEVEL,0),n.texParameteri(n.TEXTURE_3D,n.TEXTURE_MAX_LEVEL,Math.log2(i)),n.texParameteri(n.TEXTURE_3D,n.TEXTURE_MIN_FILTER,n.LINEAR_MIPMAP_LINEAR),n.texParameteri(n.TEXTURE_3D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage3D(n.TEXTURE_3D,0,n.R8,e.width,e.height,e.depth,0,n.RED,n.UNSIGNED_BYTE,e)):console.error("TexturePool::create2DTexture(): no data ("+e+"), for 3d, giving up"),n.generateMipmap(n.TEXTURE_3D),n.bindTexture(n.TEXTURE_3D,null),a}},{key:"createCubeMapTexture",value:function(e,t,r){console.log("creating cubemap texture");var i=this.webgl.getContext(),n=i.createTexture();return i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0),i.bindTexture(i.TEXTURE_CUBE_MAP,n),e?(i.bindTexture(i.TEXTURE_CUBE_MAP,n),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X,0,format,format,type,e.pos.x),i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_Y,0,format,format,type,e.pos.y),i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_Z,0,format,format,type,e.pos.z),i.texImage2D(i.TEXTURE_CUBE_MAP_NEGATIVE_X,0,format,format,type,e.neg.x),i.texImage2D(i.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,format,format,type,e.neg.y),i.texImage2D(i.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,format,format,type,e.neg.z)):console.error("TextureObj::create2DTexture(): no data ("+e+"), for cubemap, giving up"),i.bindTexture(i.TEXTURE_CUBE_MAP,null),n}},{key:"addTexture",value:function(e,t,r,i,n,a){if(void 0===i)return console.error("TextureObj::addTexture(): undefined pos"),null;var o=this.webgl.getContext();a||(a=o.TEXTURE_2D);var s=null,u="";switch(a){case o.TEXTURE_2D:s=this.create2dTexture(t,i),u=this.util.emitter.events.TEXTURE_2D_READY;break;case o.TEXTURE_2D_ARRAY:s=this.create2DArrayTexture(t,i),u=this.util.emitter.events.TEXTURE_2D_ARRAY_MEMBER_READY;break;case o.TEXTURE_3D:s=this.create3dTexture(t,i),u=this.util.emitter.events.TEXTURE_3D_READY;break;case o.TEXTURE_CUBE_MAP:s=this.createCubeMapTexture(t,i),u=this.util.emitter.events.TEXTURE_CUBE_MAP_MEMBER_READY;break;default:console.warn("TexturePool::addTexture() for prim:"+e.name+" unsupported texture requested")}return s?this.addAsset({image:t,mimeType:n,type:a,path:r,texture:s,emits:u}):(console.warn("TexturePool::addTexture(): no texture returned by createXXTexture() function"),null)}},{key:"getTextures",value:function(e,t){for(var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.util.DEFAULT_KEY,a=this,o=arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},u=function(u){var l=t[u];if(null===l&&console.log("NULL AT: "+u),l){var c=a.pathInList(l);if(c)console.log(")))))))))))))) found pre-existing texture "+c.id+" at path:"+l),e.textures.push(c);else{var h=a.textureMimeTypes[a.util.getFileExtension(l)];h?a.doRequest(l,u,function(t){var r=new Image;r.onload=function(){var u=a.addTexture(e,r,t.path,t.pos,h,o);u?(i||(window.URL.revokeObjectURL(r.src),u.image=null),u.use=n,u.options=s,a.util.emitter.emit(u.emits,e,u.key,t.pos)):console.error("TexturePool::getTextures(): file:"+l+" could not be parsed")},r.src=window.URL.createObjectURL(t.data)},r,h,0):console.error('TexturePool::getTextures(): file type "'+a.util.getFileExtension(l)+'" in:'+l+" not supported, not loading")}}else console.warn("TexturePool::getTextures(): no path supplied for position "+u)},l=0;l<t.length;l++)u(l)}}]),t}(l.default);t.default=c},function(e,t,r){var i=r(1),n={};n.create=function(){var e=new i.ARRAY_TYPE(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},n.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},n.clone=function(e){var t=new i.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},n.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},n.fromValues=function(e,t,r,n,a,o,s,u,l){var c=new i.ARRAY_TYPE(9);return c[0]=e,c[1]=t,c[2]=r,c[3]=n,c[4]=a,c[5]=o,c[6]=s,c[7]=u,c[8]=l,c},n.set=function(e,t,r,i,n,a,o,s,u,l){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=a,e[5]=o,e[6]=s,e[7]=u,e[8]=l,e},n.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},n.transpose=function(e,t){if(e===t){var r=t[1],i=t[2],n=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=i,e[7]=n}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},n.invert=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],h=c*o-s*l,M=-c*a+s*u,d=l*a-o*u,f=r*h+i*M+n*d;return f?(f=1/f,e[0]=h*f,e[1]=(-c*i+n*l)*f,e[2]=(s*i-n*o)*f,e[3]=M*f,e[4]=(c*r-n*u)*f,e[5]=(-s*r+n*a)*f,e[6]=d*f,e[7]=(-l*r+i*u)*f,e[8]=(o*r-i*a)*f,e):null},n.adjoint=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8];return e[0]=o*c-s*l,e[1]=n*l-i*c,e[2]=i*s-n*o,e[3]=s*u-a*c,e[4]=r*c-n*u,e[5]=n*a-r*s,e[6]=a*l-o*u,e[7]=i*u-r*l,e[8]=r*o-i*a,e},n.determinant=function(e){var t=e[0],r=e[1],i=e[2],n=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8];return t*(l*a-o*u)+r*(-l*n+o*s)+i*(u*n-a*s)},n.multiply=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],M=r[0],d=r[1],f=r[2],m=r[3],g=r[4],y=r[5],L=r[6],v=r[7],I=r[8];return e[0]=M*i+d*o+f*l,e[1]=M*n+d*s+f*c,e[2]=M*a+d*u+f*h,e[3]=m*i+g*o+y*l,e[4]=m*n+g*s+y*c,e[5]=m*a+g*u+y*h,e[6]=L*i+v*o+I*l,e[7]=L*n+v*s+I*c,e[8]=L*a+v*u+I*h,e},n.mul=n.multiply,n.translate=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],M=r[0],d=r[1];return e[0]=i,e[1]=n,e[2]=a,e[3]=o,e[4]=s,e[5]=u,e[6]=M*i+d*o+l,e[7]=M*n+d*s+c,e[8]=M*a+d*u+h,e},n.rotate=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],M=Math.sin(r),d=Math.cos(r);return e[0]=d*i+M*o,e[1]=d*n+M*s,e[2]=d*a+M*u,e[3]=d*o-M*i,e[4]=d*s-M*n,e[5]=d*u-M*a,e[6]=l,e[7]=c,e[8]=h,e},n.scale=function(e,t,r){var i=r[0],n=r[1];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},n.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},n.fromRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=-r,e[4]=i,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},n.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},n.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},n.fromQuat=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=r+r,s=i+i,u=n+n,l=r*o,c=i*o,h=i*s,M=n*o,d=n*s,f=n*u,m=a*o,g=a*s,y=a*u;return e[0]=1-h-f,e[3]=c-y,e[6]=M+g,e[1]=c+y,e[4]=1-l-f,e[7]=d-m,e[2]=M-g,e[5]=d+m,e[8]=1-l-h,e},n.normalFromMat4=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],h=t[9],M=t[10],d=t[11],f=t[12],m=t[13],g=t[14],y=t[15],L=r*s-i*o,v=r*u-n*o,I=r*l-a*o,x=i*u-n*s,T=i*l-a*s,p=n*l-a*u,w=c*m-h*f,S=c*g-M*f,D=c*y-d*f,b=h*g-M*m,N=h*y-d*m,E=M*y-d*g,j=L*E-v*N+I*b+x*D-T*S+p*w;return j?(j=1/j,e[0]=(s*E-u*N+l*b)*j,e[1]=(u*D-o*E-l*S)*j,e[2]=(o*N-s*D+l*w)*j,e[3]=(n*N-i*E-a*b)*j,e[4]=(r*E-n*D+a*S)*j,e[5]=(i*D-r*N-a*w)*j,e[6]=(m*p-g*T+y*x)*j,e[7]=(g*I-f*p-y*v)*j,e[8]=(f*T-m*I+y*L)*j,e):null},n.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},n.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},n.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e},n.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e},n.sub=n.subtract,n.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e},n.multiplyScalarAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e[6]=t[6]+r[6]*i,e[7]=t[7]+r[7]*i,e[8]=t[8]+r[8]*i,e},n.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},n.equals=function(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],M=t[0],d=t[1],f=t[2],m=t[3],g=t[4],y=t[5],L=e[6],v=t[7],I=t[8];return Math.abs(r-M)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(n-d)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(a-f)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(o-m)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(s-g)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(u-y)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(l-L)<=i.EPSILON*Math.max(1,Math.abs(l),Math.abs(L))&&Math.abs(c-v)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(h-I)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(I))},e.exports=n},function(e,t,r){var i=r(1),n={};n.create=function(){var e=new i.ARRAY_TYPE(3);return e[0]=0,e[1]=0,e[2]=0,e},n.clone=function(e){var t=new i.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},n.fromValues=function(e,t,r){var n=new i.ARRAY_TYPE(3);return n[0]=e,n[1]=t,n[2]=r,n},n.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},n.set=function(e,t,r,i){return e[0]=t,e[1]=r,e[2]=i,e},n.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},n.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},n.sub=n.subtract,n.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e},n.mul=n.multiply,n.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e},n.div=n.divide,n.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},n.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},n.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e},n.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e},n.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},n.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},n.scaleAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e},n.distance=function(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return Math.sqrt(r*r+i*i+n*n)},n.dist=n.distance,n.squaredDistance=function(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return r*r+i*i+n*n},n.sqrDist=n.squaredDistance,n.length=function(e){var t=e[0],r=e[1],i=e[2];return Math.sqrt(t*t+r*r+i*i)},n.len=n.length,n.squaredLength=function(e){var t=e[0],r=e[1],i=e[2];return t*t+r*r+i*i},n.sqrLen=n.squaredLength,n.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},n.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},n.normalize=function(e,t){var r=t[0],i=t[1],n=t[2],a=r*r+i*i+n*n;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e},n.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},n.cross=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=r[0],s=r[1],u=r[2];return e[0]=n*u-a*s,e[1]=a*o-i*u,e[2]=i*s-n*o,e},n.lerp=function(e,t,r,i){var n=t[0],a=t[1],o=t[2];return e[0]=n+i*(r[0]-n),e[1]=a+i*(r[1]-a),e[2]=o+i*(r[2]-o),e},n.hermite=function(e,t,r,i,n,a){var o=a*a,s=o*(2*a-3)+1,u=o*(a-2)+a,l=o*(a-1),c=o*(3-2*a);return e[0]=t[0]*s+r[0]*u+i[0]*l+n[0]*c,e[1]=t[1]*s+r[1]*u+i[1]*l+n[1]*c,e[2]=t[2]*s+r[2]*u+i[2]*l+n[2]*c,e},n.bezier=function(e,t,r,i,n,a){var o=1-a,s=o*o,u=a*a,l=s*o,c=3*a*s,h=3*u*o,M=u*a;return e[0]=t[0]*l+r[0]*c+i[0]*h+n[0]*M,e[1]=t[1]*l+r[1]*c+i[1]*h+n[1]*M,e[2]=t[2]*l+r[2]*c+i[2]*h+n[2]*M,e},n.random=function(e,t){t=t||1;var r=2*i.RANDOM()*Math.PI,n=2*i.RANDOM()-1,a=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*a,e[1]=Math.sin(r)*a,e[2]=n*t,e},n.transformMat4=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=r[3]*i+r[7]*n+r[11]*a+r[15];return o=o||1,e[0]=(r[0]*i+r[4]*n+r[8]*a+r[12])/o,e[1]=(r[1]*i+r[5]*n+r[9]*a+r[13])/o,e[2]=(r[2]*i+r[6]*n+r[10]*a+r[14])/o,e},n.transformMat3=function(e,t,r){var i=t[0],n=t[1],a=t[2];return e[0]=i*r[0]+n*r[3]+a*r[6],e[1]=i*r[1]+n*r[4]+a*r[7],e[2]=i*r[2]+n*r[5]+a*r[8],e},n.transformQuat=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=r[0],s=r[1],u=r[2],l=r[3],c=l*i+s*a-u*n,h=l*n+u*i-o*a,M=l*a+o*n-s*i,d=-o*i-s*n-u*a;return e[0]=c*l+d*-o+h*-u-M*-s,e[1]=h*l+d*-s+M*-o-c*-u,e[2]=M*l+d*-u+c*-s-h*-o,e},n.rotateX=function(e,t,r,i){var n=[],a=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],a[0]=n[0],a[1]=n[1]*Math.cos(i)-n[2]*Math.sin(i),a[2]=n[1]*Math.sin(i)+n[2]*Math.cos(i),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},n.rotateY=function(e,t,r,i){var n=[],a=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],a[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i),a[1]=n[1],a[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},n.rotateZ=function(e,t,r,i){var n=[],a=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],a[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),a[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),a[2]=n[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},n.forEach=function(){var e=n.create();return function(t,r,i,n,a,o){var s,u;for(r||(r=3),i||(i=0),u=n?Math.min(n*r+i,t.length):t.length,s=i;s<u;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],a(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}(),n.angle=function(e,t){var r=n.fromValues(e[0],e[1],e[2]),i=n.fromValues(t[0],t[1],t[2]);n.normalize(r,r),n.normalize(i,i);var a=n.dot(r,i);return a>1?0:Math.acos(a)},n.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},n.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},n.equals=function(e,t){var r=e[0],n=e[1],a=e[2],o=t[0],s=t[1],u=t[2];return Math.abs(r-o)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-u)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))},e.exports=n},function(e,t,r){var i=r(1),n={};n.create=function(){var e=new i.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},n.clone=function(e){var t=new i.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},n.fromValues=function(e,t,r,n){var a=new i.ARRAY_TYPE(4);return a[0]=e,a[1]=t,a[2]=r,a[3]=n,a},n.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},n.set=function(e,t,r,i,n){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e},n.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},n.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e},n.sub=n.subtract,n.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e},n.mul=n.multiply,n.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e},n.div=n.divide,n.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},n.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},n.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},n.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},n.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},n.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},n.scaleAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e},n.distance=function(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],a=t[3]-e[3];return Math.sqrt(r*r+i*i+n*n+a*a)},n.dist=n.distance,n.squaredDistance=function(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],a=t[3]-e[3];return r*r+i*i+n*n+a*a},n.sqrDist=n.squaredDistance,n.length=function(e){var t=e[0],r=e[1],i=e[2],n=e[3];return Math.sqrt(t*t+r*r+i*i+n*n)},n.len=n.length,n.squaredLength=function(e){var t=e[0],r=e[1],i=e[2],n=e[3];return t*t+r*r+i*i+n*n},n.sqrLen=n.squaredLength,n.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},n.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},n.normalize=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=r*r+i*i+n*n+a*a;return o>0&&(o=1/Math.sqrt(o),e[0]=r*o,e[1]=i*o,e[2]=n*o,e[3]=a*o),e},n.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},n.lerp=function(e,t,r,i){var n=t[0],a=t[1],o=t[2],s=t[3];return e[0]=n+i*(r[0]-n),e[1]=a+i*(r[1]-a),e[2]=o+i*(r[2]-o),e[3]=s+i*(r[3]-s),e},n.random=function(e,t){return t=t||1,e[0]=i.RANDOM(),e[1]=i.RANDOM(),e[2]=i.RANDOM(),e[3]=i.RANDOM(),n.normalize(e,e),n.scale(e,e,t),e},n.transformMat4=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3];return e[0]=r[0]*i+r[4]*n+r[8]*a+r[12]*o,e[1]=r[1]*i+r[5]*n+r[9]*a+r[13]*o,e[2]=r[2]*i+r[6]*n+r[10]*a+r[14]*o,e[3]=r[3]*i+r[7]*n+r[11]*a+r[15]*o,e},n.transformQuat=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=r[0],s=r[1],u=r[2],l=r[3],c=l*i+s*a-u*n,h=l*n+u*i-o*a,M=l*a+o*n-s*i,d=-o*i-s*n-u*a;return e[0]=c*l+d*-o+h*-u-M*-s,e[1]=h*l+d*-s+M*-o-c*-u,e[2]=M*l+d*-u+c*-s-h*-o,e[3]=t[3],e},n.forEach=function(){var e=n.create();return function(t,r,i,n,a,o){var s,u;for(r||(r=4),i||(i=0),u=n?Math.min(n*r+i,t.length):t.length,s=i;s<u;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],a(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}(),n.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},n.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},n.equals=function(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=t[0],u=t[1],l=t[2],c=t[3];return Math.abs(r-s)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-u)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(a-l)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(o-c)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))},e.exports=n},function(e,t,r){(function(e){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.world=t.webvr=t.webgl=t.util=void 0;var n=r(29),a=i(n),o=r(19),s=(i(o),r(30)),u=i(s),l=r(31),c=i(l),h=r(28),M=i(h),d=r(26),f=i(d),m=r(22),g=i(m),y=r(23),L=i(y),v=r(27),I=(i(v),r(24)),x=(i(I),r(4)),T=i(x),p=r(25),w=i(p),S=r(12),D=(i(S),r(32)),b=i(D);console.log("in es6");var N=(e.env.WEBPACK_ENV,r(33));N?console.log("loaded gl-matrix"):console.error("gl-matrix could'nt be loaded...");var E=new a.default,j=null;console.log("app.es6: in development mode");var A=r(40);t.webgl=j=new u.default(!1,N,E,A),A?console.log("Loading webgl-debug"):console.log("Error loading webgl-debug");var z=void 0,P=void 0,C=void 0,O=void 0,R=void 0;new Promise(function(e,r){j.init("webvr-mini-canvas")?(t.webvr=z=new c.default(!0,E,N,j),P=new M.default(!1,E,j,z),O=new T.default(N),C=new w.default(!0,E,N,j),C.addShader(new f.default(!0,E,N,j,z,"shaderTexture")),C.addShader(new g.default(!0,E,N,j,z,"shaderColor")),C.addShader(new L.default(!0,E,N,j,z,"shaderDirLightTexture",O)),t.world=R=new b.default(!0,N,j,z,C,O),P.init(),e("Stuff worked!")):r(Error("It broke"))}).then(function(e){R.init()});window.vrmin=R,t.util=E,t.webgl=j,t.webvr=z,t.world=R}).call(t,r(39))},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=function(){function e(){r(this,e),this.callbacks={},this.events={GEOMETRY_READY:"grdy",MATERIAL_READY:"mrdy",TEXTURE_2D_READY:"trdy",TEXTURE_2D_ARRAY_MEMBER_READY:"tr2darmbrdy",TEXTURE_2D_ARRAY_READY:"trarrdy",TEXTURE_3D_READY:"t3drdy",TEXTURE_CUBEMAP_MEMBER_READY:"trcmpmbrdy",TEXTURE_CUBEMAP_READY:"tcmprdy",TEXTURE_REMOVE:"trm",PRIM_ADDED_TO_SHADER:"prdy",PRIM_REMOVED_FROM_SHADER:"prms",PRIM_FAIL:"prmfl",VR_DISPLAY_READY:"vrdispready"}}return i(e,[{key:"emit",value:function(e){var t=this.callbacks[e];if(t){var r=[].slice.call(arguments);r.shift();for(var i=0;i<t.length;i++)t[i].apply(this,r)}}},{key:"on",value:function(e,t){e in this.callbacks?this.callbacks[e].push(t):this.callbacks[e]=[t]}}]),e}();t.default=n},function(t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();(function(){function t(e,r,n,a){i(this,t),console.log("in gamepad constructor"),this.util=r,this.stats={},e===!0&&this.init()}return n(t,[{key:"init",value:function(){var t=this;window.addEventListener("gamepadconnected",function(r){t.gpad=navigator.getGamepads()[e.gamepad.index],console.log("found gamepad: "+t.gpad.id)}),window.addEventListener("gamepaddisconnected",function(e){console.log("gamepad disconnected")})}}]),t})()},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=function(){function e(t,i,n,a){r(this,e),this.primName=t,this.webgl=n,this.util=i,this.FLOAT32="float32",this.UINT="uint",this.UINT32="uint32",this.UINT16="uint16",this.makeBuffers=!0,this.vertices={data:[],buffer:null,itemSize:3,numItems:0},this.indices={data:[],buffer:null,itemSize:1,numItems:0},this.sides={data:[],buffer:null,itemSize:3,numItems:0},this.normals={data:[],buffer:null,itemSize:3,numItems:0},this.tangents={data:[],buffer:null,itemSize:4,numItems:0},this.texCoords={data:[],buffer:null,itemSize:2,numItems:0},this.texCoords1={data:[],buffer:null,itemSize:2,numItems:0},this.texCoords2={data:[],buffer:null,itemSize:2,numItems:0},this.texCoords3={data:[],buffer:null,itemSize:2,numItems:0},this.texCoords4={data:[],buffer:null,itemSize:2,numItems:0},this.texCoords5={data:[],buffer:null,itemSize:2,numItems:0},this.colors={data:[],buffer:null,itemSize:4,numItems:0},this.valid=!1,this.MAX_DRAWELEMENTS=this.webgl.MAX_DRAWELEMENTS,this.mName=this.primName+" GeometryBuffer::"}return i(e,[{key:"confirmNumericalData",value:function(e,t,r){for(var i=e.length,n=0;n<i;n++){var a=e[n];switch(t){case this.FLOAT32:if(!Number.isFinite(parseFloat(a)))return console.error(this.mName+"confirmNumericalData(): invalid float32 in "+r+" at pos:"+n+" = "+a),!1;break;case this.UINT16:case this.UINT32:case this.UINT:if(!Number.isFinite(parseInt(a)))return console.error(this.mName+"confirmNumericalData(): invalid Uint in "+r+" at pos:"+n+" = "+a),!1;break;default:return console.error(this.mName+" confirmNumericalData(): unknown data type "+t+" for:"+r),!1}}return!0}},{key:"checkVertexData",value:function(e){var t=this.mName+" checkVertexData():",r=this.vertices.data.length,i=this.numVertices();return r<this.vertices.itemSize||0!==this.util.frac(i)?(console.error(t+" invalid vertex size, "+i),!1):r>this.MAX_DRAWELEMENTS?(console.error(t+" vertex size exceeds 64k on hardware not supporting it"),!1):!(e&&!this.confirmNumericalData(this.vertices.data,this.FLOAT32,"vertices"))&&i}},{key:"checkIndexData",value:function(e){var t=this.mName+" checkIndexData():",r=this.numIndices(),i=this.numVertices();if(r<this.indices.itemSize)return console.error(t+" invalid index size, "+r),!1;if(e){if(!this.confirmNumericalData(this.indices.data,this.UINT,"indices"))return!1;for(var n=this.indices.data,a=0;a<r;a++){var o=n[a];if(o<0||o>i)return console.error(t+" index at "+a+" points to invalid postion in vertices "+o+", max:"+i),!1}}return r}},{key:"checkFacesData",value:function(e){var t=this.numFaces();return t?t:(console.error(fnName+" number of sides (triangles) is invalid"),!1)}},{key:"checkNormalsData",value:function(e){var t=this.mName+" checkNormalsData():",r=this.numVertices(),i=this.numNormals();return i<this.normals.itemSize||0!==this.util.frac(i)?(console.error(t+" invalid normals size, "+i),!1):i!==r?(console.error(t+" normals length: "+this.numNormals()+" does not match vertices length: "+this.numVertices()),!1):!(e&&!this.confirmNumericalData(this.normals.data,this.FLOAT32,"normals"))&&i}},{key:"checkTexCoordsData",value:function(e,t){var r=this.mName+" checkTexCoordsData():",i=this.numVertices(),n=t||this.texCoords,a=this.numTexCoords(n);if(a>0){if(a<n.itemSize||0!==this.util.frac(a))return console.error(r+" invalid texCoords size, "+n.data.length),!1;if(a!==i)return console.error(r+" texCoords length: "+this.numTexCoords(n)+" does not match vertices length: "+this.numVertices()),
!1}else console.warn(r+" no texCoords data defined.");return!(e&&!this.confirmNumericalData(n.data,this.FLOAT32,"texCoords"))&&a}},{key:"checkTangentsData",value:function(e){var t=this.mName+" checkTangentsData():",r=this.numVertices(),i=this.numTangents();if(i>0){if(i<this.tangents.itemSize||0!==this.util.frac(i))return console.error(t+" invalid tangents size, "+i),!1;if(i!==r)return console.error(t+" tangents length "+this.numTangents()+" does not match vertices length: "+this.numVertices()),!1}else console.warn(t+" no tangents data defined.");return!(e&&!this.confirmNumericalData(this.tangents.data,this.FLOAT32,"tangents"))&&i}},{key:"checkColorsData",value:function(e){var t=this.mName+" checkColorssData():",r=this.numVertices(),i=this.numColors();if(i>0){if(i<this.colors.itemSize||0!==this.util.frac(i))return console.error(t+" invalid colors size, "+this.colors.data.length),!1;if(i!==r)return console.error(t+" colors length: "+this.numColors()+" does not match vertices length:"+this.numVertices()),!1}else console.warn(t+" no colors data defined.");if(e&&!this.confirmNumericalData(this.colors.data,this.FLOAT32,"colors"))return!1}},{key:"checkBufferData",value:function(e){this.valid=!0,this.vertices.data.length,this.mName+" checkBufferData():";return!!(this.checkVertexData(!0)&&this.checkIndexData(!0)&&this.checkNormalsData(!0)&&this.checkTexCoordsData(!0)&&this.checkTangentsData(!0)&&this.checkColorsData(!0))||(console.warn(this.mName+"checkBufferData() buffers not ok"),!1)}},{key:"numVertices",value:function(){return this.vertices.data.length/this.vertices.itemSize}},{key:"numIndices",value:function(){return this.indices.data.length}},{key:"numNormals",value:function(){return this.normals.data.length/this.normals.itemSize}},{key:"numTexCoords",value:function(e){var t=e||this.texCoords;return t.data.length/t.itemSize}},{key:"numTangents",value:function(){return this.tangents.data.length/this.tangents.itemSize}},{key:"numColors",value:function(){return this.colors.data.length/this.colors.itemSize}},{key:"numFaces",value:function(){var e=this.indices.length/3;return this.util.frac(e/this.tangents.itemSize!==0)&&console.error(this.mName+"numFaces(): fractional number of faces"),e}},{key:"numSides",value:function(){return console.warn(this.mName+"numSides(): sides not implemented yet"),0}},{key:"numCoords",value:function(){return this.numVertices()+this.numIndices()+this.numNormals()+this.numTangents()+this.numColors()}},{key:"setVertices",value:function(e){var t=this.vertices;this.util.isArray(e)?(t.data=new Float32Array(e),t.numItems=e.length/t.itemSize,this.bindGLBuffer(t,this.FLOAT32)):console.warn(this.mName+"setVertices() invalid input, not Array, nothing set")}},{key:"setIndices",value:function(e){var t=this.indices;this.util.isArray(e)?this.webgl.stats.uint32?(t.data=new Uint32Array(e),this.bindGLBuffer(t,this.UINT32)):(t.data=new Uint16Array(e),this.bindGLBuffer(t,this.UINT16)):console.warn(this.mName+"setIndices() invalid input, not Array, nothing set")}},{key:"setNormals",value:function(e){var t=this.normals;this.util.isArray(e)?(t.data=new Float32Array(e),t.numItems=e.length/t.itemSize,this.bindGLBuffer(t,this.FLOAT32)):console.error(this.mName+"setNormals() invalid input, not Array")}},{key:"setTexCoords",value:function(e){var t=this.texCoords;this.util.isArray(e)?(t.data=new Float32Array(e),t.numItems=e.length/t.itemSize,this.bindGLBuffer(t,this.FLOAT32)):console.error(this.mName+"setTexCoords() invalid input, not Array")}},{key:"setColors",value:function(e){var t=this.colors;this.util.isArray(e)?(t.data=new Float32Array(e),t.numItems=e.length/t.itemSize,this.bindGLBuffer(t,this.FLOAT32)):console.error(this.mName+"setTangents() invalid input, not Array")}},{key:"setTangents",value:function(e){var t=this.tangents;this.util.isArray(e)?(t.data=new Float32Array(e),t.numItems=e.length/t.itemSize,this.bindGLBuffer(t,this.FLOAT32)):console.error(this.mName+"setTangents() invalid input, not Array")}},{key:"setBufferData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];e.length>0&&(this.setVertices(e),console.log("numVertices is now:"+this.numVertices())),t.length>0&&(this.setIndices(t),console.log("numIndices is now:"+this.numIndices())),r.length>0&&(this.setNormals(r),console.log("numNormals is now:"+this.numNormals())),i.length>0&&(this.setTexCoords(i),console.log("numTexCoords is now:"+this.numTexCoords())),n.length>0&&(this.setTangents(n),console.log("numTangents is now:"+this.numTangents())),a.length>0&&(this.setColors(a),console.log("numColors is now:"+this.numColors())),this.vertices.data.length>this.webgl.MAX_DRAWELEMENTS?this.ssz=!0:this.ssz=!1}},{key:"addBufferData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=arguments[6],s=this.util.concatArr,u=this.numCoords();return this.vertices.data=s(this.vertices.data,e),this.indices.data=s(this.indices.data,t),this.normals.data=s(this.normals.data,r),this.texCoords.data=s(this.texCoords.data,i),this.tangents.data=s(this.tangents.data,n),this.colors.data=s(this.colors.data,a),this.vertices.data.length>this.webgl.MAX_DRAWELEMENTS?this.ssz=!0:this.ssz=!1,u!==this.numCoords()&&this.createGLBuffers(),!o||this.checkBufferData()}},{key:"clearData",value:function(e){e.data=[]}},{key:"clearBuffer",value:function(e){this.clearData(e),e.buffer=null,e.numItems=0}},{key:"clear",value:function(){this.clearBuffer(this.vertices),this.clearBuffer(this.indices),this.clearBuffer(this.normals),this.clearBuffer(this.texCoords),this.clearBuffer(this.texCoords1),this.clearBuffer(this.texCoords2),this.clearBuffer(this.texCoords3),this.clearBuffer(this.colors)}},{key:"bindGLBuffer",value:function(e,t){var r=this.webgl.getContext();switch(e.buffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,e.buffer),t){case this.FLOAT32:e.data instanceof Float32Array?r.bufferData(r.ARRAY_BUFFER,e.data,r.STATIC_DRAW):r.bufferData(r.ARRAY_BUFFER,new Float32Array(e.data),r.STATIC_DRAW),e.numItems=e.data.length/e.itemSize;break;case this.UINT32:e.buffer=r.createBuffer(),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint32Array(e.data),r.STATIC_DRAW),e.numItems=e.data.length/e.itemSize;break;case this.UINT16:e.buffer=r.createBuffer(),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint16Array(e.data),r.STATIC_DRAW),e.numItems=e.data.length/e.itemSize;break;default:console.error(this.mName+"bindGLBuffer(): invalid WebGL buffer type "+t)}}},{key:"createGLBuffers",value:function(){var e=(this.webgl.getContext(),this.mName+"createGLBuffers():",this.vertices);return e.data.length||(e.data=new Float32Array),this.bindGLBuffer(e,this.FLOAT32),e=this.indices,this.webgl.stats.uint32?(e.data.length||(e.data=new Uint32Array),this.bindGLBuffer(e,this.UINT32)):(e.data.length||(e.data=new Uint16Array),this.bindGLBuffer(e,this.UINT16)),e=this.sides,e.data.length||(e.data=new Uint16Array),this.bindGLBuffer(e,this.UINT16),e=this.normals,e.data.length||(e.data=new Float32Array),this.bindGLBuffer(e,this.FLOAT32),e=this.texCoords,e.data.length||(e.data=new Float32Array),this.bindGLBuffer(e,this.FLOAT32),e=this.tangents,e.data.length||(e.data=new Float32Array),this.bindGLBuffer(e,this.FLOAT32),e=this.colors,(!e.data.length||e.data.length<4*this.vertices.length/3)&&(e.data=new Float32Array),this.bindGLBuffer(e,this.FLOAT32),this.makeBuffers=!1,this}}]),e}();t.default=n},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),u=r(2),l=i(u),c=function(e){function t(e,r,i,o){n(this,t),console.log("in MaterialPool");var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r));return s.util=r,s.webgl=i,s.texturePool=o,s.materialMimeTypes={mtl:"text/plain"},s}return o(t,e),s(t,[{key:"computeTextureMapOptions",value:function(e){var t={};if(e.length<4)return t;for(var r=0;r<e.length-1;r+=2){var i=e[r].substr(1),n=e[r+1];switch(i){case"blenu":case"blenv":case"cc":case"clamp":"off"===n?t[i]=!1:t[i]=!0;break;case"bm":this.util.isFinite(parseFloat(n))&&(t.bm=n);break;case"boost":n=parseFloat(n),n>=0&&(t.boost=n);break;case"imfchan":t.infchan=n;break;case"mm":this.util.isFinite(parseFloat(n))&&(t.mm=n);break;case"o":r+3<e.length-1&&(t.o=[],this.util.isFinite(parseFloat(n))&&(t.o[0]=n),this.util.isFinite(parseFloat(e[r+2]))&&(t.o[1]=e[r+2]),this.util.isFinite(parseFloat(e[r+3]))&&(t.o[2]=e[r+3]));break;case"s":r+3<e.length-1&&(t.s=[],this.util.isFinite(parseFloat(n))&&(t.s[0]=n),this.util.isFinite(parseFloat(e[r+2]))&&(t.s[1]=e[r+2]),this.util.isFinite(parseFloat(e[r+3]))&&(t.s[2]=e[r+3]));break;case"t":r+3<e.length-1&&(t.t=[],this.util.isFinite(parseFloat(n))&&(t.t[0]=n),this.util.isFinite(parseFloat(e[r+2]))&&(t.t[1]=e[r+2]),this.util.isFinite(parseFloat(e[r+3]))&&(t.t[2]=e[r+3]));break;case"texres":t.texres=n;break;default:console.error("unknown texture map option: "+e)}}return t}},{key:"computeObjMaterials",value:function(e,t,r){var i=this;console.log("MaterialPool::computeObjMaterials(): loading model:"+r+" for:"+t.name);var n=0,a=[],o=null,s=this.util.getFilePath(r),u=e.split("\n");return u.forEach(function(e){e=e.trim();var r=e.split(" ")[0].trim(),u=e.substr(r.length).trim().split(" ");switch(r){case"newmtl":o=u[0].trim(),a[o]={name:o};break;case"Ka":u.length<3?console.error("MaterialPool::computeObjMaterials(): error in ambient material array at line:"+n):(u[0]=parseFloat(u[0]),u[1]=parseFloat(u[1]),u[2]=parseFloat(u[2]),o&&Number.isFinite(u[0])&&Number.isFinite(u[1])&&Number.isFinite(u[2])?a[o].ambient=[u[0],u[1],u[2]]:console.error("MaterialPool::computerObjMaterials(): invalid ambient data at line:"+n));break;case"Kd":u.length<3?console.error("MaterialPool::computeObjMaterials(): error in diffuse material array at line:"+n):(u[0]=parseFloat(u[0]),u[1]=parseFloat(u[1]),u[2]=parseFloat(u[2]),o&&Number.isFinite(u[0])&&Number.isFinite(u[1])&&Number.isFinite(u[2])?a[o].diffuse=[u[0],u[1],u[2]]:console.error("MaterialPool::computeObjMaterials(): invalid diffuse array at line:"+n));break;case"Ks":u.length<3?console.error("MaterialPool::computeObjMaterials(): error in specular array at line:"+n):(u[0]=parseFloat(u[0]),u[1]=parseFloat(u[1]),u[2]=parseFloat(u[2]),o&&Number.isFinite(u[0])&&Number.isFinite(u[1])&&Number.isFinite(u[2])?a[o].specular=[u[0],u[1],u[2]]:console.error("MaterialPool::computeObjMaterials(): invalid specular array at line:"+n));break;case"Ns":u.length<1?console.error("MaterialPool::computeObjMaterials(): error in specular exponent array at line:"+n):(u[0]=parseFloat(u[0]),o&&Number.isFinite(u[0])?a[o].specularFactor=u[0]:console.error("MaterialPool::computeObjMaterials(): invalid specular exponent array at line:"+n));break;case"d":case"Tr":u.length<1?console.error("MaterialPool::computeObjMaterials(): error in transparency value at line:"+n):(u[0]=parseFloat(u[0]),o&&Number.isFinite(u[0])?a[o].transparency=parseFloat(u[0]):console.error("MaterialPool::computeObjMaterials(): invalid transparency value at line:"+n));break;case"illum":u.length<1?console.error("MaterialPool::computeObjMaterials(): error in illumination value at line:"+n):(u[0]=parseInt(u[0]),o&&Number.isFinite(u[0])&&u[0]>0&&u[0]<11&&(a[o].illum=u[0]));break;case"map_Kd":case"map_Ks":case"map_Ka":case"map_d":case"bump":case"map_bump":case"disp":var l=u[0].trim();if(o){var c=i.computeTextureMapOptions(u);i.texturePool.getTextures(t,[s+l],!0,!1,r,null,c)}}n++}),a}},{key:"addMaterial",value:function(e,t,r,i,n,a){if(void 0===i)return console.error("TextureObj::addTexture(): undefined pos"),null;var o=void 0,s=this.util.getFileExtension(r);switch(s){case"mtl":console.log("MTL file for prim:"+e.name+" loaded, parsing...."),o=this.computeObjMaterials(t,e,r);break;default:console.warn("MaterialPool::addModel(): unknown material file:"+r+" MIME type:"+n)}if(o)for(var u in o){var l=o[u];l.type=a,l.path=r,l.emits=this.util.emitter.events.MATERIAL_READY,console.log("MaterialPool::addMaterial(): adding:"+l.name+" to Prim:"+e.name),this.addAsset(l)}return o}},{key:"getMaterials",value:function(e,t){for(var r=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=0;n<t.length;n++){var a=t[n];if(a){var o=this.pathInList(a);o?e.materials.push(o):!function(){var t=r.materialMimeTypes[r.util.getFileExtension(a)];t?r.doRequest(a,n,function(i){if(i.data){var n=r.addMaterial(e,i.data,i.path,i.pos,t,e.type);if(n)for(var a in n)console.log("MaterialPool sending:"+n[a].emits+" key:"+n[a].key+" i:"+a),r.util.emitter.emit(n[a].emits,e,n[a].key,a)}else console.error("MaterialPool::getMaterials(): no data found for:"+i.path)},i,t,0):console.error('MaterialPool::getModels(): file type "'+r.util.getFileExtension(a)+" not supported, not loading")}()}else console.warn("MaterialPool::getMaterials(): no path supplied for position "+n)}}}]),t}(l.default);t.default=c},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),u=r(3),l=i(u),c=function(e){function t(e,r,i,o,s,u){n(this,t);var l=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,i,o,s,u));return l.required.buffer.indices=!0,l.required.buffer.colors=!0,l.required.textures=0,console.log("In ShaderColor class"),l}return o(t,e),s(t,[{key:"vsSrc",value:function(){var e=["attribute vec3 aVertexPosition;","attribute vec4 aVertexColor;","uniform mat4 uMVMatrix;","uniform mat4 uPMatrix;","varying lowp vec4 vColor;","void main(void) {","    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);","    vColor = aVertexColor;","}"];return{code:e.join("\n"),varList:this.webgl.createVarList(e)}}},{key:"fsSrc",value:function(){var e=["varying lowp vec4 vColor;","void main(void) {","gl_FragColor = vColor;","}"];return{code:e.join("\n"),varList:this.webgl.createVarList(e)}}},{key:"init",value:function(e){var t=this.setup(),r=t[0],i=(t[1],t[2]),n=(t[3],t[4],t[5],t[6],t[7]),a=t[8],o=(t[9],t[10]),s=(t[11],t[12],t[13],n.shaderProgram);return e&&(n.renderList=this.util.concatArr(n.renderList,e)),n.isReady=function(e){return!(e.geometry.checkBuffers()||!e.geometry.colors.buffer)},n.update=function(e,t){e.setMV(t)},n.render=function(e,t){r.useProgram(s);for(var u=i.clone(t),l=0,c=n.renderList.length;l<c;l++){var h=n.renderList[l];n.update(h,t),r.bindBuffer(r.ARRAY_BUFFER,h.geometry.vertices.buffer),r.enableVertexAttribArray(a.attribute.vec3.aVertexPosition),r.vertexAttribPointer(a.attribute.vec3.aVertexPosition,h.geometry.vertices.itemSize,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,h.geometry.colors.buffer),r.enableVertexAttribArray(a.attribute.vec4.aVertexColor),r.vertexAttribPointer(a.attribute.vec4.aVertexColor,h.geometry.colors.itemSize,r.FLOAT,!1,0,0),r.uniformMatrix4fv(a.uniform.mat4.uPMatrix,!1,e),r.uniformMatrix4fv(a.uniform.mat4.uMVMatrix,!1,t),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,h.geometry.indices.buffer),o.uint32?r.drawElements(r.TRIANGLES,h.geometry.indices.numItems,r.UNSIGNED_INT,0):r.drawElements(r.TRIANGLES,h.geometry.indices.numItems,r.UNSIGNED_SHORT,0),i.copy(t,u,t)}},n}}]),t}(l.default);t.default=c},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),u=r(3),l=i(u),c=function(e){function t(e,r,i,o,s,u,l){n(this,t);var c=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,i,o,s,u,l));return c.required.buffer.indices=!0,c.required.buffer.texCoords=!0,c.required.buffer.normals=!0,c.required.textures=1,c.required.lights=1,console.log("In ShaderDirLightTexture class"),c}return o(t,e),s(t,[{key:"vsSrc",value:function(){var e=["attribute vec3 aVertexPosition;","attribute vec3 aVertexNormal;","attribute vec2 aTextureCoord;","uniform mat4 uMVMatrix;","uniform mat4 uPMatrix;","uniform mat3 uNMatrix;","uniform vec3 uAmbientColor;","uniform vec3 uLightingDirection;","uniform vec3 uDirectionalColor;","uniform bool uUseLighting;","varying vec2 vTextureCoord;","varying vec3 vLightWeighting;","void main(void) {","    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);","    vTextureCoord = aTextureCoord;","   if(!uUseLighting) {","       vLightWeighting = vec3(1.0, 1.0, 1.0);","   } else {","       vec3 transformedNormal = uNMatrix * aVertexNormal;","       float directionalLightWeighting = max(dot(transformedNormal, uLightingDirection), 0.0);","       vLightWeighting = uAmbientColor + uDirectionalColor * directionalLightWeighting;","   }","}"];return{code:e.join("\n"),varList:this.webgl.createVarList(e)}}},{key:"fsSrc",value:function(){var e=[this.floatp,"varying vec2 vTextureCoord;","varying vec3 vLightWeighting;","uniform sampler2D uSampler;","void main(void) {","    vec4 textureColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));","    gl_FragColor = vec4(textureColor.rgb * vLightWeighting, textureColor.a);","}"];return{code:e.join("\n"),varList:this.webgl.createVarList(e)}}},{key:"init",value:function(e){var t=this.setup(),r=t[0],i=(t[1],t[2]),n=t[3],a=t[4],o=(t[5],t[6],t[7]),s=t[8],u=t[9],l=t[10],c=(t[11],t[12],t[13],o.shaderProgram);e&&(o.renderList=this.util.concatArr(o.renderList,e));var h=!0,M=this.lights.getLight(this.lights.lightTypes.LIGHT_0),d=M.ambient,f=M.lightingDirection,m=M.directionalColor,g=n.create(),y=a.create();return o.isReady=function(e){return!(e.geometry.checkBuffers()||!e.textures[0].texture)},o.update=function(e,t){e.setMV(t),a.normalize(y,f),a.scale(y,y,-1),n.normalFromMat4(g,t)},o.render=function(e,t){r.useProgram(c);for(var n=i.clone(t),a=0,M=o.renderList.length;a<M;a++){var f=o.renderList[a];f.textures[0]&&f.textures[0].texture&&(o.update(f,t),r.bindBuffer(r.ARRAY_BUFFER,f.geometry.vertices.buffer),r.enableVertexAttribArray(s.attribute.vec3.aVertexPosition),r.vertexAttribPointer(s.attribute.vec3.aVertexPosition,f.geometry.vertices.itemSize,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,f.geometry.normals.buffer),r.enableVertexAttribArray(s.attribute.vec3.aVertexNormal),r.vertexAttribPointer(s.attribute.vec3.aVertexNormal,f.geometry.normals.itemSize,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,f.geometry.texCoords.buffer),r.enableVertexAttribArray(s.attribute.vec2.aTextureCoord),r.vertexAttribPointer(s.attribute.vec2.aTextureCoord,f.geometry.texCoords.itemSize,r.FLOAT,!1,0,0),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,null),r.bindTexture(r.TEXTURE_2D,f.textures[0].texture),r.uniform1i(u.uniform.sampler2D.uSampler,0),r.uniform1i(s.uniform.bool.uUseLighting,h),h&&(r.uniform3f(s.uniform.vec3.uAmbientColor,d[0],d[1],d[2]),r.uniform3fv(s.uniform.vec3.uLightingDirection,y),r.uniform3f(s.uniform.vec3.uDirectionalColor,m[0],m[1],m[2])),r.uniformMatrix3fv(s.uniform.mat3.uNMatrix,!1,g),r.uniformMatrix4fv(s.uniform.mat4.uPMatrix,!1,e),r.uniformMatrix4fv(s.uniform.mat4.uMVMatrix,!1,t),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,f.geometry.indices.buffer),l.uint32?r.drawElements(r.TRIANGLES,f.geometry.indices.numItems,r.UNSIGNED_INT,0):r.drawElements(r.TRIANGLES,f.geometry.indices.numItems,r.UNSIGNED_SHORT,0),i.copy(t,n,t))}},o}}]),t}(l.default);t.default=c},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),u=r(3),l=i(u),c=function(e){function t(e,r,i,o,s,u){n(this,t);var l=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,i,o,s,u));return console.log("In ShaderMetal class"),l.required.buffer.indices=!0,l.required.buffer.texCoords=!0,l.required.buffer.colors=!0,l.required.buffer.normals=!0,l.required.lights=1,l.required.textures=0,l}return o(t,e),s(t,[{key:"vsSrc",value:function(){var e=[];return{code:e.join("\n"),varList:this.webgl.createVarList(e)}}},{key:"fsSrc",value:function(){var e=[];return{code:e.join("\n"),varList:this.webgl.createVarList(e)}}},{key:"init",value:function(e){var t=this.setup(),r=t[0],i=(t[1],t[2]),n=t[3],a=t[4],o=(t[5],t[6]),s=t[7],u=(t[8],t[9],t[10],t[11],t[12],t[13],s.shaderProgram);e&&(s.renderList=this.util.concatArr(s.renderList,e)),s.isReady=function(e){return!0},s.update=function(e,t){e.setMV(o),a.normalize(adjustedLD,lightingDirection),a.scale(adjustedLD,adjustedLD,-1),n.normalFromMat4(nMatrix,o)},s.render=function(e,t){r.useProgram(u);for(var n=i.clone(t),a=0,o=s.renderList.length;a<o;a++){var l=s.renderList[a];l.textures[0]&&l.textures[0].texture&&(s.update(l,t),i.copy(t,n,t))}}}}]),t}(l.default);t.default=c},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=function(){function e(t,i,n,a){r(this,e),console.log("In ShaderPool class"),this.webgl=a,this.util=a.util,this.glmatrix=n,this.shaderList=[],this.NOT_IN_LIST=i.NOT_IN_LIST,this.init}return i(e,[{key:"shaderInList",value:function(e){return this.shaderList[e]?this.shaderList[e]:(console.warn("ShaderPool::shaderInList(): shader "+e+" not found in list"),!1)}},{key:"getShader",value:function(e){return this.shaderList[e]?this.shaderList[e]:(console.error("ShaderPool::getShader(): shader "+e+" not found"),!1)}},{key:"addShader",value:function(e){return this.shaderList[e.name]?(console.error("ShaderPool::addShader(): already added shader:"+e.name+" to Renderer"),!1):(console.log("ShaderPool::addShader(): adding "+e.name+" to rendering list"),this.shaderList[e.name]=e,!0)}},{key:"removeShader",value:function(e){return this.shaderList[e]&&delete this.shaderList[e],console.warn("Renderer::removeShader(): shader "+e+" not in list"),!1}},{key:"initShaders",value:function(){for(var e in this.shaderList)this.shaderList[e].init()}},{key:"renderMono",value:function(){for(var e in this.shaderList)this.shaderList[e].program.render()}},{key:"renderVR",value:function(e,t,r){for(var i in this.shaderList)this.shaderList[i].renderVR(e,t,r)}}]),e}();t.default=n},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),u=r(3),l=i(u),c=function(e){function t(e,r,i,o,s,u){n(this,t);var l=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,i,o,s,u));return l.required.buffer.indices=!0,l.required.buffer.colors=!0,l.required.buffer.normals=!0,l.required.lights=0,l.required.textures=1,console.log("In ShaderTexture class"),l}return o(t,e),s(t,[{key:"vsSrc",value:function(){var e=["attribute vec3 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat4 uMVMatrix;","uniform mat4 uPMatrix;","varying vec2 vTextureCoord;","void main(void) {","    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);","    vTextureCoord = aTextureCoord;","}"];return{code:e.join("\n"),varList:this.webgl.createVarList(e)}}},{key:"fsSrc",value:function(){var e=[this.floatp,"varying vec2 vTextureCoord;","uniform sampler2D uSampler;","void main(void) {","    gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));","}"];return{code:e.join("\n"),varList:this.webgl.createVarList(e)}}},{key:"init",value:function(e){var t=this.setup(),r=t[0],i=(t[1],t[2]),n=(t[3],t[4],t[5],t[6],t[7]),a=t[8],o=t[9],s=t[10],u=(t[11],t[12],t[13],n.shaderProgram);return e&&(n.renderList=this.util.concatArr(n.renderList,e)),n.isReady=function(e){return!(e.geometry.checkBuffers()||!e.textures[0].texture)},n.update=function(e,t){e.setMV(t)},n.render=function(e,t){r.useProgram(u);for(var l=i.clone(t),c=0,h=n.renderList.length;c<h;c++){var M=n.renderList[c];M.textures[0]&&M.textures[0].texture&&(n.update(M,t),r.bindBuffer(r.ARRAY_BUFFER,M.geometry.vertices.buffer),r.enableVertexAttribArray(a.attribute.vec3.aVertexPosition),r.vertexAttribPointer(a.attribute.vec3.aVertexPosition,M.geometry.vertices.itemSize,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,M.geometry.texCoords.buffer),r.enableVertexAttribArray(a.attribute.vec2.aTextureCoord),r.vertexAttribPointer(a.attribute.vec2.aTextureCoord,M.geometry.texCoords.itemSize,r.FLOAT,!1,0,0),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,null),r.bindTexture(r.TEXTURE_2D,M.textures[0].texture),r.uniform1i(o.uniform.sampler2D.uSampler,0),r.uniformMatrix4fv(a.uniform.mat4.uPMatrix,!1,e),r.uniformMatrix4fv(a.uniform.mat4.uMVMatrix,!1,t),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,M.geometry.indices.buffer),s.uint32?r.drawElements(r.TRIANGLES,M.geometry.indices.numItems,r.UNSIGNED_INT,0):r.drawElements(r.TRIANGLES,M.geometry.indices.numItems,r.UNSIGNED_SHORT,0),i.copy(t,l,t))}},n}}]),t}(l.default);t.default=c},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),u=r(3),l=i(u),c=function(e){function t(e,r,i,o,s,u){n(this,t);var l=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,i,o,s,u));return console.log("In ShaderWater class"),l.required.buffer.indices=!0,l.required.buffer.texCoords=!0,l.required.buffer.colors=!0,l.required.buffer.normals=!0,l.required.buffer.tangents=!0,l.required.lights=1,l.required.textures=5,l}return o(t,e),s(t,[{key:"vsSrc",value:function(){var e=[];return{code:e.join("\n"),varList:this.webgl.createVarList(e)}}},{key:"fsSrc",value:function(){var e=[];return{code:e.join("\n"),varList:this.webgl.createVarList(e)}}},{key:"init",value:function(e){var t=this.setup(),r=t[0],i=(t[1],t[2]),n=t[3],a=t[4],o=(t[5],t[6]),s=t[7],u=(t[8],t[9],t[10],t[11],t[12],t[13],s.shaderProgram);e&&(s.renderList=this.util.concatArr(s.renderList,e)),s.isReady=function(e){return!0},s.update=function(e,t){e.setMV(o),a.normalize(adjustedLD,lightingDirection),a.scale(adjustedLD,adjustedLD,-1),n.normalFromMat4(nMatrix,o)},s.render=function(e,t){r.useProgram(u);for(var n=i.clone(t),a=0,o=s.renderList.length;a<o;a++){var l=s.renderList[a];l.textures[0]&&l.textures[0].texture&&(s.update(l,t),i.copy(t,n,t))}}}}]),t}(l.default);t.default=c},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments[1],n=arguments[2],a=arguments[3];
r(this,e),console.log("in Ui"),this.UI_DOM="uidom",this.UI_VR="uivr",this.UI_FULLSCREEN="fullscreen",this.mode=this.UI_DOM,this.icons={vr:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgOTAgMTEyLjUiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDkwIDkwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNODEuNjcxLDIxLjMyM2MtMi4wODUtMi4wODQtNzIuNTAzLTEuNTUzLTc0LjA1NCwwYy0xLjY3OCwxLjY3OC0xLjY4NCw0Ni4wMzMsMCw0Ny43MTMgIGMwLjU1OCwwLjU1OSwxMi4xNTEsMC44OTYsMjYuMDA3LDEuMDEybDMuMDY4LTguNDg2YzAsMCwxLjk4Ny04LjA0LDcuOTItOC4wNGM2LjI1NywwLDguOTksOS42NzUsOC45OSw5LjY3NWwyLjU1NSw2Ljg0OCAgYzEzLjYzMy0wLjExNiwyNC45NTctMC40NTMsMjUuNTE0LTEuMDA4QzgzLjIyNCw2Ny40ODMsODMuNjcyLDIzLjMyNCw4MS42NzEsMjEuMzIzeiBNMjQuNTcyLDU0LjU4MiAgYy02LjA2MywwLTEwLjk3OC00LjkxNC0xMC45NzgtMTAuOTc5YzAtNi4wNjMsNC45MTUtMTAuOTc4LDEwLjk3OC0xMC45NzhzMTAuOTc5LDQuOTE1LDEwLjk3OSwxMC45NzggIEMzNS41NTEsNDkuNjY4LDMwLjYzNSw1NC41ODIsMjQuNTcyLDU0LjU4MnogTTY0LjMzNCw1NC41ODJjLTYuMDYzLDAtMTAuOTc5LTQuOTE0LTEwLjk3OS0xMC45NzkgIGMwLTYuMDYzLDQuOTE2LTEwLjk3OCwxMC45NzktMTAuOTc4YzYuMDYyLDAsMTAuOTc4LDQuOTE1LDEwLjk3OCwxMC45NzhDNzUuMzEyLDQ5LjY2OCw3MC4zOTYsNTQuNTgyLDY0LjMzNCw1NC41ODJ6Ii8+PC9zdmc+",htcvive:"data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDkwIDExMi41IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA5MCAxMTIuNTsiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+LnN0MHtmaWxsOiMyODI4Mjc7fS5zdDF7ZmlsbDpub25lO3N0cm9rZTojRkZGRkZGO3N0cm9rZS13aWR0aDo3O3N0cm9rZS1taXRlcmxpbWl0OjEwO30uc3Qye2ZpbGw6IzI4MjgyNztzdHJva2U6I0EwQTBBMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbWl0ZXJsaW1pdDoxMDt9LnN0M3tmaWxsOm5vbmU7c3Ryb2tlOiNGRkZGRkY7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLW1pdGVybGltaXQ6MTA7fS5zdDR7ZmlsbDojRkZGRkZGO30uc3Q1e2ZpbGw6bm9uZTtzdHJva2U6I0EwQTBBMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbWl0ZXJsaW1pdDoxMDt9PC9zdHlsZT48cG9seWdvbiBjbGFzcz0ic3QwIiBwb2ludHM9IjE2LDQxLjkgMTYsMzguNyAyMCwzMS40IDI1LjMsMjUgMzAuMywyMS4zIDM1LjYsMTguNSAzNS42LDMwLjkgMzEuNywzMy40IDI4LjYsMzYuMSAyOC43LDM4LjkgIi8+PHBvbHlnb24gY2xhc3M9InN0MCIgcG9pbnRzPSI3Niw0Mi45IDc2LDM5LjQgNzEuOSwzMS43IDY2LjUsMjQuOSA2MS40LDIxIDU2LDE4IDU2LDMxLjEgNTkuOSwzMy44IDYyLjgsMzUuNSA2My4xLDM3LjIgNjMuNCwzOS41ICIvPjxpbWFnZSBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDpuZXcgICAgOyIgd2lkdGg9IjE5MjAiIGhlaWdodD0iMTIwMSIgeGxpbms6aHJlZj0iQ0FDNjFEQjcuanBnIiAgdHJhbnNmb3JtPSJtYXRyaXgoMC45OTk4IDAgMCAwLjk5OTggLTQ5NzYuNzc1NCAtNDc2Ni4zNTk0KSI+PC9pbWFnZT48aW1hZ2Ugc3R5bGU9Im92ZXJmbG93OnZpc2libGU7ZW5hYmxlLWJhY2tncm91bmQ6bmV3OyIgd2lkdGg9IjE5MjEiIGhlaWdodD0iMTIwMSIgeGxpbms6aHJlZj0iQ0FDNjFEQjUuanBnIiAgdHJhbnNmb3JtPSJtYXRyaXgoMC45OTk0IDAgMCAwLjk5OTQgMzE0Ni4xNzgyIDM2NzkuNDY4OCkiPjwvaW1hZ2U+PHBhdGggY2xhc3M9InN0MCIgZD0iTTMzNjEuOCwzNjI5LjFoLTMyMi41Yy01MC43LDAtOTIuMi00MS41LTkyLjItOTIuMnYtMTMzLjVjMC00Ny40LDM4LjgtODYuMiw4Ni4yLTg2LjJoMzI4LjVjNTAuNywwLDkyLjIsNDEuNSw5Mi4yLDkyLjJ2MTI3LjVDMzQ1NC4xLDM1ODcuNiwzNDEyLjYsMzYyOS4xLDMzNjEuOCwzNjI5LjF6Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTMyNDMuNiwzMzI3LjFoLTg1LjVjLTYuNiwwLTEyLTUuNC0xMi0xMnYtMTM5LjVjMC02LjYsNS40LTEyLDEyLTEyaDg1LjVjNi42LDAsMTIsNS40LDEyLDEydjEzOS41QzMyNTUuNiwzMzIxLjcsMzI1MC4yLDMzMjcuMSwzMjQzLjYsMzMyNy4xeiIvPjxjaXJjbGUgY2xhc3M9InN0MSIgY3g9IjMwNDYuOCIgY3k9IjMzODMuNSIgcj0iMzIuNSIvPjxjaXJjbGUgY2xhc3M9InN0MSIgY3g9IjMzNjMuNiIgY3k9IjMzODMuNSIgcj0iMzIuNSIvPjxjaXJjbGUgY2xhc3M9InN0MSIgY3g9IjMyMDAuOCIgY3k9IjM1NzUuOCIgcj0iMzIuNSIvPjxjaXJjbGUgY2xhc3M9InN0MSIgY3g9IjMwMTQuMyIgY3k9IjM0OTAuNCIgcj0iMzIuNSIvPjxjaXJjbGUgY2xhc3M9InN0MSIgY3g9IjMzOTAuNiIgY3k9IjM0OTAuNCIgcj0iMzIuNSIvPjxjaXJjbGUgY2xhc3M9InN0MSIgY3g9IjMyMDAuOCIgY3k9IjM1NzYuOCIgcj0iMTcuNiIvPjxwb2x5bGluZSBjbGFzcz0ic3QxIiBwb2ludHM9IjMzMTAuOCwzMzE0LjEgMzI3OC43LDMzNTYuMyAzMjUxLjMsMzM3Ni4zIDMyMDQsMzM3Ni4zIDMxNDYuMSwzMzc2LjMgMzEyMS4zLDMzNTkuNyAzMDg5LjEsMzMxNy4xIi8+PHBvbHlnb24gY2xhc3M9InN0MCIgcG9pbnRzPSIzMDA0LjUsMzMzOS4xIDMwMDQuNSwzMzIxLjEgMzAzMSwzMjgwLjEgMzA2NiwzMjQ0LjUgMzA5OS41LDMyMjMuNiAzMTM0LjUsMzIwOC4xIDMxMzQuNSwzMjc3LjEgMzEwOSwzMjkxLjEgMzA5MC40LDMzMDYuOSAzMDg4LjUsMzMyMiAiLz48cG9seWdvbiBjbGFzcz0ic3QwIiBwb2ludHM9IjMzOTQsMzMzNi4xIDMzOTQsMzMxOC4xIDMzNjcuNSwzMjc3LjEgMzMzMi41LDMyNDEuNSAzMjk5LDMyMjAuNiAzMjY0LDMyMDUuMSAzMjY0LDMyNzQuMSAzMjg5LjUsMzI4OC4xIDMzMTAsMzMwNi41IDMzMTIuMywzMzE4LjQgIi8+PGxpbmUgY2xhc3M9InN0MSIgeDE9IjMyMDAuOCIgeTE9IjMzNzYuMyIgeDI9IjMyMDAuOCIgeTI9IjM1NDMuMyIvPjxwYXRoIGNsYXNzPSJzdDIiIGQ9Ik02OCw4OC41SDIyQzEwLjMsODguNSwwLjgsNzksMC44LDY3LjNWNTZjMC0xMC43LDguOC0xOS41LDE5LjUtMTkuNUg2OGMxMS43LDAsMjEuMiw5LjUsMjEuMiwyMS4ydjkuNkM4OS4zLDc5LDc5LjcsODguNSw2OCw4OC41eiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik00NS41LDM4LjVMNDUuNSwzOC41Yy00LjcsMC04LjUtMy44LTguNS04LjVWMjBjMC00LjcsMy44LTguNSw4LjUtOC41aDAuMWM0LjcsMCw4LjUsMy44LDguNSw4LjV2MTBDNTQsMzQuNyw1MC4yLDM4LjUsNDUuNSwzOC41eiIvPjxlbGxpcHNlIHRyYW5zZm9ybT0ibWF0cml4KDAuOTIyOCAtMC4zODUzIDAuMzg1MyAwLjkyMjggLTE3LjgwMjUgMTAuOTM5MSkiIGNsYXNzPSJzdDMiIGN4PSIxOC40IiBjeT0iNDkuOSIgcng9IjMuOSIgcnk9IjUuNSIvPjxlbGxpcHNlIHRyYW5zZm9ybT0ibWF0cml4KDAuMzY1NSAtMC45MzA4IDAuOTMwOCAwLjM2NTUgLTAuMTc4NSA5OC42NDUxKSIgY2xhc3M9InN0MyIgY3g9IjcyLjMiIGN5PSI0OS41IiByeD0iNS41IiByeT0iNC4zIi8+PGVsbGlwc2UgY2xhc3M9InN0MyIgY3g9IjExLjUiIGN5PSI2NS4zIiByeD0iNSIgcnk9IjQuMyIvPjxlbGxpcHNlIGNsYXNzPSJzdDMiIGN4PSI3OC41IiBjeT0iNjUuMyIgcng9IjUiIHJ5PSI0LjMiLz48Y2lyY2xlIGNsYXNzPSJzdDQiIGN4PSI0NS41IiBjeT0iODAiIHI9IjEuNSIvPjxwb2x5bGluZSBjbGFzcz0ic3Q1IiBwb2ludHM9IjYzLjgsMzcuMiA1OC42LDQzLjUgNTQuMSw0Ni41IDQ2LjQsNDYuNSAzNi45LDQ2LjUgMzIuOSw0NCAyNy42LDM3LjYgIi8+PGxpbmUgY2xhc3M9InN0NSIgeDE9IjQ1LjUiIHkxPSI0Ni41IiB4Mj0iNDUuNSIgeTI9Ijc0LjUiLz48ZWxsaXBzZSB0cmFuc2Zvcm09Im1hdHJpeCgwLjU3NzMgLTAuODE2NiAwLjgxNjYgMC41NzczIC0zNy4yMDk2IDg3LjU2NjMpIiBjbGFzcz0ic3QzIiBjeD0iNjYiIGN5PSI3OS43IiByeD0iMy45IiByeT0iNSIvPjxlbGxpcHNlIHRyYW5zZm9ybT0ibWF0cml4KDAuNzA3MSAtMC43MDcxIDAuNzA3MSAwLjcwNzEgLTQ5LjY1NzQgMzkuNTA1KSIgY2xhc3M9InN0MyIgY3g9IjIyLjkiIGN5PSI3OS43IiByeD0iNSIgcnk9IjMuOSIvPjxlbGxpcHNlIGNsYXNzPSJzdDMiIGN4PSI0NS41IiBjeT0iODAiIHJ4PSI1IiByeT0iNS41Ii8+PC9zdmc+",oculusrift:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgOTAgMTEyLjUiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDkwIDExMi41OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHN0eWxlIHR5cGU9InRleHQvY3NzIj4uc3Qwe2ZpbGw6IzJEMkQyRDt9LnN0MXtmaWxsOiMyODI4Mjc7fS5zdDJ7ZmlsbDpub25lO3N0cm9rZTojRkZGRkZGO3N0cm9rZS13aWR0aDo3O3N0cm9rZS1taXRlcmxpbWl0OjEwO30uc3Qze2ZpbGw6bm9uZTtzdHJva2U6I0EwQTBBMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbWl0ZXJsaW1pdDoxMDt9LnN0NHtmaWxsOiMyODI4Mjc7c3Ryb2tlOiNBMEEwQTA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLW1pdGVybGltaXQ6MTA7fTwvc3R5bGU+PHBhdGggY2xhc3M9InN0MCIgZD0iTTcxLjUsNzYuN2wtNS43LTIuN2MtMS43LTAuOC0yLjUtMi45LTEuNy00LjdsNC42LTkuOGMwLjgtMS43LDIuOS0yLjUsNC43LTEuN2w1LjcsMi43YzEuNywwLjgsMi41LDIuOSwxLjcsNC43bC00LjYsOS44Qzc1LjQsNzYuOCw3My4zLDc3LjYsNzEuNSw3Ni43eiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0yMy40LDc0LjVsLTUuNywyLjRjLTEuOCwwLjctMy44LTAuMS00LjYtMS45TDksNjVjLTAuNy0xLjgsMC4xLTMuOCwxLjktNC42bDUuNy0yLjRjMS44LTAuNywzLjgsMC4xLDQuNiwxLjlsNC4xLDEwQzI2LjEsNzEuNywyNS4yLDczLjgsMjMuNCw3NC41eiIvPjxpbWFnZSBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZTsiIHdpZHRoPSIxOTIwIiBoZWlnaHQ9IjEyMDAiIHhsaW5rOmhyZWY9IkNCMUE2Mjg5LmpwZyIgIHRyYW5zZm9ybT0ibWF0cml4KDEgMCAwIDEgLTQ5NzcgLTQ3NjYpIj48L2ltYWdlPjxpbWFnZSBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZTsiIHdpZHRoPSIxOTIwIiBoZWlnaHQ9IjEyMDAiIHhsaW5rOmhyZWY9IkNCMUE2MjhGLmpwZyIgIHRyYW5zZm9ybT0ibWF0cml4KDEgMCAwIDEgMzE0Ni4wOTQgMzY3OS42MDM1KSI+PC9pbWFnZT48cGF0aCBjbGFzcz0ic3QxIiBkPSJNMzM2MS44LDM2MjkuMWgtMzIyLjVjLTUwLjcsMC05Mi4yLTQxLjUtOTIuMi05Mi4ydi0xMzMuNWMwLTQ3LjQsMzguOC04Ni4yLDg2LjItODYuMmgzMjguNWM1MC43LDAsOTIuMiw0MS41LDkyLjIsOTIuMnYxMjcuNUMzNDU0LjEsMzU4Ny42LDM0MTIuNiwzNjI5LjEsMzM2MS44LDM2MjkuMXoiLz48cGF0aCBjbGFzcz0ic3QxIiBkPSJNMzI0My42LDMzMjcuMWgtODUuNWMtNi42LDAtMTItNS40LTEyLTEydi0xMzkuNWMwLTYuNiw1LjQtMTIsMTItMTJoODUuNWM2LjYsMCwxMiw1LjQsMTIsMTJ2MTM5LjVDMzI1NS42LDMzMjEuNywzMjUwLjIsMzMyNy4xLDMyNDMuNiwzMzI3LjF6Ii8+PGNpcmNsZSBjbGFzcz0ic3QyIiBjeD0iMzA0Ni44IiBjeT0iMzM4My41IiByPSIzMi41Ii8+PGNpcmNsZSBjbGFzcz0ic3QyIiBjeD0iMzM2My42IiBjeT0iMzM4My41IiByPSIzMi41Ii8+PGNpcmNsZSBjbGFzcz0ic3QyIiBjeD0iMzIwMC44IiBjeT0iMzU3NS44IiByPSIzMi41Ii8+PGNpcmNsZSBjbGFzcz0ic3QyIiBjeD0iMzAxNC4zIiBjeT0iMzQ5MC40IiByPSIzMi41Ii8+PGNpcmNsZSBjbGFzcz0ic3QyIiBjeD0iMzM5MC42IiBjeT0iMzQ5MC40IiByPSIzMi41Ii8+PGNpcmNsZSBjbGFzcz0ic3QyIiBjeD0iMzIwMC44IiBjeT0iMzU3Ni44IiByPSIxNy42Ii8+PHBvbHlsaW5lIGNsYXNzPSJzdDIiIHBvaW50cz0iMzMxMC44LDMzMTQuMSAzMjc4LjcsMzM1Ni4zIDMyNTEuMywzMzc2LjMgMzIwNCwzMzc2LjMgMzE0Ni4xLDMzNzYuMyAzMTIxLjMsMzM1OS43IDMwODkuMSwzMzE3LjEgIi8+PHBvbHlnb24gY2xhc3M9InN0MSIgcG9pbnRzPSIzMDA0LjUsMzMzOS4xIDMwMDQuNSwzMzIxLjEgMzAzMSwzMjgwLjEgMzA2NiwzMjQ0LjUgMzA5OS41LDMyMjMuNiAzMTM0LjUsMzIwOC4xIDMxMzQuNSwzMjc3LjEgMzEwOSwzMjkxLjEgMzA5MC40LDMzMDYuOSAzMDg4LjUsMzMyMiAiLz48cG9seWdvbiBjbGFzcz0ic3QxIiBwb2ludHM9IjMzOTQsMzMzNi4xIDMzOTQsMzMxOC4xIDMzNjcuNSwzMjc3LjEgMzMzMi41LDMyNDEuNSAzMjk5LDMyMjAuNiAzMjY0LDMyMDUuMSAzMjY0LDMyNzQuMSAzMjg5LjUsMzI4OC4xIDMzMTAsMzMwNi41IDMzMTIuMywzMzE4LjQgIi8+PGxpbmUgY2xhc3M9InN0MiIgeDE9IjMyMDAuOCIgeTE9IjMzNzYuMyIgeDI9IjMyMDAuOCIgeTI9IjM1NDMuMyIvPjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik00OC45LDMyLjVoLTQuOGMtMS43LDAtMy4xLTEuNC0zLjEtMy4xVjguNmMwLTEuNywxLjQtMy4xLDMuMS0zLjFoNC44YzEuNywwLDMuMSwxLjQsMy4xLDMuMXYyMC44QzUyLDMxLjEsNTAuNiwzMi41LDQ4LjksMzIuNXoiLz48bGluZSBjbGFzcz0ic3QzIiB4MT0iNTIiIHkxPSIxMy41IiB4Mj0iNDEiIHkyPSIxMy41Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTkuMiw2Ni44TDkuMiw2Ni44Yy0xLjQsMC4yLTIuNy0wLjctMi45LTJMMC45LDM1LjZjLTAuMi0xLjQsMC43LTIuNywyLTIuOWgwYzEuNC0wLjIsMi43LDAuNywyLjksMmw1LjQsMjkuMUMxMS40LDY1LjIsMTAuNSw2Ni41LDkuMiw2Ni44eiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik04MS40LDY3TDgxLjQsNjdjLTEuNC0wLjItMi4zLTEuNS0yLTIuOWw1LTI5LjZjMC4yLTEuNCwxLjUtMi4zLDIuOS0yaDBjMS40LDAuMiwyLjMsMS41LDIsMi45bC01LDI5LjZDODQuMSw2Ni4zLDgyLjgsNjcuMiw4MS40LDY3eiIvPjxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik02Ni4yLDcwLjVIMjMuOGMtNy42LDAtMTMuOC02LjItMTMuOC0xMy44VjM5LjZjMC02LjYsNS40LTEyLjEsMTIuMS0xMi4xaDQ0LjJjNy42LDAsMTMuOCw2LjIsMTMuOCwxMy44djE1LjVDODAsNjQuMyw3My44LDcwLjUsNjYuMiw3MC41eiIvPjwvc3ZnPg==",emulated:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwIDEyNSIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMTAwIDEyNTsiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+LnN0MHtmaWxsOiNGRjczNzM7fTwvc3R5bGU+PHBhdGggY2xhc3M9InN0MCIgZD0iTTQ4LjgsMTA5LjlIMzIuNmMwLjEsMS40LDAuNCwyLjYsMSwzLjRjMC44LDEuMSwxLjgsMS42LDMsMS42YzAuOCwwLDEuNi0wLjMsMi4yLTAuN2MwLjQtMC4zLDAuOS0wLjgsMS4zLTEuNmw3LjgsMC45Yy0xLjIsMi41LTIuNyw0LjItNC4zLDUuM2MtMS43LDEuMS00LjEsMS42LTcuMywxLjZjLTIuOCwwLTQuOS0wLjQtNi41LTEuM2MtMS42LTAuOS0yLjktMi40LTMuOS00LjNjLTEtMi0xLjYtNC4zLTEuNi03LjFjMC0zLjgsMS03LDMuMS05LjNjMi4xLTIuNCw1LTMuNiw4LjYtMy42YzMsMCw1LjMsMC41LDcsMS42YzEuNywxLjEsMywyLjYsMy45LDQuNmMwLjksMiwxLjMsNC42LDEuMyw3Ljl2MS4xSDQ4Ljh6IE00MC40LDEwNS40Yy0wLjEtMS44LTAuNi0zLjItMS4yLTMuOWMtMC43LTAuOC0xLjYtMS4yLTIuNy0xLjJjLTEuMiwwLTIuMiwwLjctMywxLjhjLTAuNCwwLjgtMC44LDEuOC0wLjksMy4zSDQwLjR6Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTUxLjYsMTAxLjhsNC41LTAuNWwzLjcsMC41bDMuMiwxMS4xbDMuMi0xMS4xbDQuMy0wLjVsMy45LDAuNVYxMjBoLTVMNjkuMSwxMDhMNjUuMywxMjBoLTQuNmwtMy41LTExLjlMNTYuOSwxMjBoLTVMNTEuNiwxMDEuOEw1MS42LDEwMS44eiIvPjwvc3ZnPg==",inactiveVR:"data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgOTAgMTEyLjUiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDkwIDExMi41OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHN0eWxlIHR5cGU9InRleHQvY3NzIj4uc3Qwe2ZpbGw6IzYwNjA2MDt9LnN0MXtmaWxsOm5vbmU7c3Ryb2tlOiNGRjczNzM7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLW1pdGVybGltaXQ6MTA7fTwvc3R5bGU+PHBhdGggY2xhc3M9InN0MCIgZD0iTTgxLjcsMjEuM2MtMi4xLTIuMS03Mi41LTEuNi03NC4xLDBjLTEuNywxLjctMS43LDQ2LDAsNDcuN2MwLjYsMC42LDEyLjIsMC45LDI2LDFsMy4xLTguNWMwLDAsMi04LDcuOS04YzYuMywwLDksOS43LDksOS43bDIuNiw2LjhjMTMuNi0wLjEsMjUtMC41LDI1LjUtMUM4My4yLDY3LjUsODMuNywyMy4zLDgxLjcsMjEuM3ogTTI0LjYsNTQuNmMtNi4xLDAtMTEtNC45LTExLTExYzAtNi4xLDQuOS0xMSwxMS0xMXMxMSw0LjksMTEsMTFDMzUuNiw0OS43LDMwLjYsNTQuNiwyNC42LDU0LjZ6IE02NC4zLDU0LjZjLTYuMSwwLTExLTQuOS0xMS0xMWMwLTYuMSw0LjktMTEsMTEtMTFjNi4xLDAsMTEsNC45LDExLDExQzc1LjMsNDkuNyw3MC40LDU0LjYsNjQuMyw1NC42eiIvPjxsaW5lIGNsYXNzPSJzdDEiIHgxPSI4NCIgeTE9IjYiIHgyPSIxOSIgeTI9Ijg5Ii8+PC9zdmc+",viveControl:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwIDEyNSIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMTAwIDEyNTsiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+LnN0MHtmaWxsOiMyODI4Mjg7fS5zdDF7ZmlsbDojQTBBMEEwO308L3N0eWxlPjxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iNDkuNiwzLjggNTcuMiw0LjYgNjUuNSw3LjMgNzEuNywxMS4yIDg0LjIsMjQgODUsMjYuNCA4NSwyOS42IDg0LDMxLjUgNzkuNywzNSA3Ny4yLDM1IDcxLjgsMzAuNiA2OC44LDMyLjYgNjcuMywzNSA2NS44LDM3LjcgNjUsNDMgNjEuNSwxMDkuNiA2MC45LDExMy42IDU5LjYsMTE2LjYgNTcuMiwxMTkuMyA1NC4zLDEyMS4xIDUwLjcsMTIxLjggNDYuNiwxMjEuMSA0My41LDExOS4zIDQxLjQsMTE2LjggNDAuMiwxMTMuMiAzNiw0MS44IDM0LjcsMzYuOCAzMy4yLDMyLjkgMjkuMywzMC41IDI0LjMsMzQuNyAyMS44LDM0LjYgMTYuOCwzMC45IDE2LDI3LjMgMTcuMywyNC42IDI5LjUsMTEuMiAzNy4zLDYuOCA0Myw0LjggIi8+PGVsbGlwc2UgY2xhc3M9InN0MSIgY3g9IjUwLjUiIGN5PSI1My4zIiByeD0iMTAuMiIgcnk9IjguOSIvPjxlbGxpcHNlIGNsYXNzPSJzdDEiIGN4PSI1MC45IiBjeT0iMTcuNSIgcng9IjE3LjYiIHJ5PSI4LjIiLz48L3N2Zz4=",riftControl:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwIDEyNSIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMTAwIDEyNTsiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+LnN0MHtmaWxsOiMyODI4Mjg7fS5zdDF7ZmlsbDojQTBBMEEwO30uc3Qye2ZpbGw6IzQ5NDk0OTt9PC9zdHlsZT48cGF0aCBjbGFzcz0ic3QwIiBkPSJNOTUuOSw0Ni4ybC0yLjEtOC45bC0zLjgtNi43bC03LjUtNi42bC02LjQtMy40bC02LjgtMi40TDU3LDE2bC05LjUtOGwtNy4yLTEuM0wzMC45LDlsLTcuNSwzLjJMMTIuNiwyMi43bC00LDYuM0w2LDM5Ljl2OC43bDEuMyw5LjJsNC4zLDExLjZsNi42LDExbDYuNCw1LjZsMjMuOSwxNC42bDkuOCwxLjFsMTEuMS0xLjNsOC45LTQuNWw3LTYuM2w3LjItMTAuNUw5NS45LDY5bDEuMS0xMy45TDk1LjksNDYuMnogTTg1LDY5LjNsLTIuMSwxMS42bC02LjQsNy43TDY3LDkyLjhsLTEzLjgtMmwtMTMuNi03LjZMMjcuOSw3MS41bC0zLjQtNS4ybC0yLjgtNi43TDE5LDUxLjhWNDEuNWwyLjEtOS4ybDMuNC03LjJsMy0xLjFoMS4zbDYuNCw4LjNsNS4xLDQuOUw3Myw1NmwxMC45LDMuNmwxLjEsMS44VjY5LjN6Ii8+PHBvbHlnb24gY2xhc3M9InN0MCIgcG9pbnRzPSI0MS42LDI1LjEgMjkuOSw2Ni4xIDI1LjIsODIgMjIuOSwxMDAuNCAyNS44LDExMC4yIDMwLjEsMTE0LjUgMzUuNCwxMTQuNSA0MC4xLDExMy40IDQ1LjQsMTA2LjkgNTAuNiw5NC44IDU0LjEsODUuNiA1OC42LDY2LjEgNjQuNCw1OC43IDc3LjIsNTcuNiA4Ny4yLDQ5LjEgIi8+PHBhdGggY2xhc3M9InN0MSIgZD0iTTkxLjYsNDMuM2MtMi40LDguMy0xNS43LDExLjUtMjkuOCw3UzM4LjQsMzUuNSw0MC43LDI3LjJzMTUuNy0xMS41LDI5LjgtN1M5NCwzNSw5MS42LDQzLjN6Ii8+PHBhdGggY2xhc3M9InN0MiIgZD0iTTY5LjIsMjkuOGMtMC42LDMuMi01LjEsNC45LTEwLDMuOXMtOC40LTQuNS03LjgtNy43czUuMS00LjksMTAtMy45UzY5LjgsMjYuNiw2OS4yLDI5Ljh6Ii8+PHBhdGggY2xhc3M9InN0MiIgZD0iTTYyLjIsNDIuMWMtMC41LDEuNC0yLjcsMS45LTQuOSwxYy0yLjItMC45LTMuNi0yLjctMy4xLTQuMnMyLjctMS45LDQuOS0xUzYyLjcsNDAuNyw2Mi4yLDQyLjF6Ii8+PHBhdGggY2xhc3M9InN0MiIgZD0iTTc0LjMsNDIuMWMtMC41LDEuNC0yLjcsMS45LTQuOSwxYy0yLjItMC45LTMuNi0yLjctMy4xLTQuMnMyLjctMS45LDQuOS0xUzc0LjgsNDAuNyw3NC4zLDQyLjF6Ii8+PHBhdGggY2xhc3M9InN0MiIgZD0iTTgyLDM2LjhjLTAuNSwxLjQtMi43LDEuOS00LjksMWMtMi4yLTAuOS0zLjYtMi43LTMuMS00LjJjMC41LTEuNCwyLjctMS45LDQuOS0xQzgxLjEsMzMuNiw4Mi41LDM1LjQsODIsMzYuOHoiLz48L3N2Zz4=",daydreamControl:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwIDEyNSIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMTAwIDEyNTsiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+LnN0MHtmaWxsOiMyODI4Mjg7fS5zdDF7ZmlsbDojQTBBMEEwO308L3N0eWxlPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik01MC42LDExOWgtMC4yYy0xMC4xLDAtMTguNC04LjMtMTguNC0xOC40VjI2LjRDMzIsMTYuMyw0MC4zLDgsNTAuNCw4aDBDNjAuNiw4LDY5LDE2LjQsNjksMjYuNnY3NEM2OSwxMTAuNyw2MC43LDExOSw1MC42LDExOXoiLz48ZWxsaXBzZSBjbGFzcz0ic3QxIiBjeD0iNTAuNyIgY3k9Ijc5LjkiIHJ4PSI4LjQiIHJ5PSI4LjUiLz48ZWxsaXBzZSBjbGFzcz0ic3QxIiBjeD0iNTAuOCIgY3k9IjU4IiByeD0iOC40IiByeT0iOC41Ii8+PGVsbGlwc2UgY2xhc3M9InN0MSIgY3g9IjUwLjQiIGN5PSIyNy41IiByeD0iMTYuMSIgcnk9IjE2Ii8+PC9zdmc+",gamepadControl:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwIDEyNSIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTAwIDEwMCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZmlsbD0iIzAwMDAwMCIgZD0iTTg3LjMsMzcuM2MtMS4xLTctNy4xLTEyLjMtMTQuNC0xMi4zYy00LDAtNy42LDEuNi0xMC4yLDQuMkgzNy4zYy0yLjYtMi42LTYuMi00LjItMTAuMi00LjIgIGMtNy4zLDAtMTMuMyw1LjQtMTQuNCwxMi4zYy0wLjUsMi40LTQuNCwyOC00LjQsMjkuM2MwLDQuNiwzLjcsOC4zLDguMyw4LjNjMy4xLDAsNS43LTEuNyw3LjItNC4xYzEuMy0xLjgsNi4yLTkuMyw3LjUtMTEuMiAgYzEuNSwxLjcsMy43LDIuOSw2LjIsMi45YzQuNiwwLDguMy0zLjcsOC4zLTguM2g4LjNjMCw0LjYsMy43LDguMyw4LjMsOC4zYzIuNSwwLDQuNy0xLjEsNi4yLTIuOWMxLjIsMS45LDYuMSw5LjUsNy41LDExLjIgIGMxLjUsMi41LDQuMSw0LjEsNy4yLDQuMWM0LjYsMCw4LjMtMy43LDguMy04LjNDOTEuNyw2Ni4xLDg3LjgsMzkuNSw4Ny4zLDM3LjNDODYuMiwzMC40LDg3LjgsMzkuNSw4Ny4zLDM3LjN6IE0yOS4yLDQxLjd2NC4ySDI1ICB2LTQuMmgtNC4ydi00LjJIMjV2LTQuMmg0LjJ2NC4yaDQuMnY0LjJIMjkuMnogTTM3LjUsNTguM2MtMi4zLDAtNC4yLTEuOS00LjItNC4yYzAtMi4zLDEuOS00LjIsNC4yLTQuMnM0LjIsMS45LDQuMiw0LjIgIEM0MS43LDU2LjUsMzkuOCw1OC4zLDM3LjUsNTguM3ogTTcyLjksMzAuMmMxLjcsMCwzLjEsMS40LDMuMSwzLjFjMCwxLjctMS40LDMuMS0zLjEsMy4xcy0zLjEtMS40LTMuMS0zLjEgIEM2OS44LDMxLjYsNzEuMiwzMC4yLDcyLjksMzAuMnogTTYyLjUsNTguM2MtMi4zLDAtNC4yLTEuOS00LjItNC4yYzAtMi4zLDEuOS00LjIsNC4yLTQuMnM0LjIsMS45LDQuMiw0LjIgIEM2Ni43LDU2LjUsNjQuOCw1OC4zLDYyLjUsNTguM3ogTTY2LjcsNDIuN2MtMS43LDAtMy4xLTEuNC0zLjEtMy4xYzAtMS43LDEuNC0zLjEsMy4xLTMuMXMzLjEsMS40LDMuMSwzLjEgIEM2OS44LDQxLjMsNjguNCw0Mi43LDY2LjcsNDIuN3ogTTcyLjksNDljLTEuNywwLTMuMS0xLjQtMy4xLTMuMWMwLTEuNywxLjQtMy4xLDMuMS0zLjFzMy4xLDEuNCwzLjEsMy4xQzc2LDQ3LjYsNzQuNiw0OSw3Mi45LDQ5eiAgIE03OS4yLDQyLjdjLTEuNywwLTMuMS0xLjQtMy4xLTMuMWMwLTEuNywxLjQtMy4xLDMuMS0zLjFzMy4xLDEuNCwzLjEsMy4xQzgyLjMsNDEuMyw4MC45LDQyLjcsNzkuMiw0Mi43eiIvPjx0ZXh0IHg9IjAiIHk9IjExNSIgZmlsbD0iIzAwMDAwMCIgZm9udC1zaXplPSI1cHgiIGZvbnQtd2VpZ2h0PSJib2xkIiBmb250LWZhbWlseT0iJ0hlbHZldGljYSBOZXVlJywgSGVsdmV0aWNhLCBBcmlhbC1Vbmljb2RlLCBBcmlhbCwgU2Fucy1zZXJpZiI+Q3JlYXRlZCBieSBBcnRodXIgU2hsYWluPC90ZXh0Pjx0ZXh0IHg9IjAiIHk9IjEyMCIgZmlsbD0iIzAwMDAwMCIgZm9udC1zaXplPSI1cHgiIGZvbnQtd2VpZ2h0PSJib2xkIiBmb250LWZhbWlseT0iJ0hlbHZldGljYSBOZXVlJywgSGVsdmV0aWNhLCBBcmlhbC1Vbmljb2RlLCBBcmlhbCwgU2Fucy1zZXJpZiI+ZnJvbSB0aGUgTm91biBQcm9qZWN0PC90ZXh0Pjwvc3ZnPg==",fullscreen:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwIDEyNSIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTAwIDEwMCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PGc+PGc+PHBhdGggZmlsbD0iIzAwMDAwMCIgZD0iTTc3LjE3MSw3OS44ODdINjEuODE0Yy0xLjUsMC0yLjcxNS0xLjIxNi0yLjcxNS0yLjcxNWMwLTEuNSwxLjIxNi0yLjcxNSwyLjcxNS0yLjcxNWgxMi42NDJWNjEuODE1ICAgIGMwLTEuNSwxLjIxNi0yLjcxNSwyLjcxNS0yLjcxNXMyLjcxNSwxLjIxNiwyLjcxNSwyLjcxNXYxNS4zNTdDNzkuODg3LDc4LjY3MSw3OC42NzEsNzkuODg3LDc3LjE3MSw3OS44ODd6Ii8+PC9nPjxnPjxwYXRoIGZpbGw9IiMwMDAwMDAiIGQ9Ik0zOC4yNTQsNzkuODg3SDIyLjg5N2MtMS41LDAtMi43MTUtMS4yMTYtMi43MTUtMi43MTVWNjEuODE1YzAtMS41LDEuMjE2LTIuNzE1LDIuNzE1LTIuNzE1ICAgIHMyLjcxNSwxLjIxNiwyLjcxNSwyLjcxNXYxMi42NDFoMTIuNjQyYzEuNSwwLDIuNzE1LDEuMjE2LDIuNzE1LDIuNzE1QzQwLjk2OSw3OC42NzEsMzkuNzU0LDc5Ljg4NywzOC4yNTQsNzkuODg3eiIvPjwvZz48L2c+PGc+PGc+PHBhdGggZmlsbD0iIzAwMDAwMCIgZD0iTTIyLjg5Nyw0MC45N2MtMS41LDAtMi43MTUtMS4yMTYtMi43MTUtMi43MTVWMjIuODk4YzAtMS41LDEuMjE2LTIuNzE1LDIuNzE1LTIuNzE1aDE1LjM1NyAgICBjMS41LDAsMi43MTUsMS4yMTYsMi43MTUsMi43MTVzLTEuMjE2LDIuNzE1LTIuNzE1LDIuNzE1SDI1LjYxMnYxMi42NDFDMjUuNjEyLDM5Ljc1NSwyNC4zOTcsNDAuOTcsMjIuODk3LDQwLjk3eiIvPjwvZz48Zz48cGF0aCBmaWxsPSIjMDAwMDAwIiBkPSJNNzcuMTcxLDQwLjk3Yy0xLjUsMC0yLjcxNS0xLjIxNi0yLjcxNS0yLjcxNVYyNS42MTNINjEuODE0Yy0xLjUsMC0yLjcxNS0xLjIxNi0yLjcxNS0yLjcxNSAgICBzMS4yMTYtMi43MTUsMi43MTUtMi43MTVoMTUuMzU3YzEuNSwwLDIuNzE1LDEuMjE2LDIuNzE1LDIuNzE1djE1LjM1N0M3OS44ODcsMzkuNzU1LDc4LjY3MSw0MC45Nyw3Ny4xNzEsNDAuOTd6Ii8+PC9nPjwvZz48Zz48cGF0aCBmaWxsPSIjMDAwMDAwIiBkPSJNOTIuMjg1LDk1SDcuNzE1QzYuMjE2LDk1LDUsOTMuNzg1LDUsOTIuMjg1VjcuNzE2QzUsNi4yMTYsNi4yMTYsNSw3LjcxNSw1aDg0LjU2OSAgIEM5My43ODQsNSw5NSw2LjIxNiw5NSw3LjcxNnY4NC41NjlDOTUsOTMuNzg1LDkzLjc4NCw5NSw5Mi4yODUsOTV6IE0xMC40MzEsODkuNTY5aDc5LjEzOFYxMC40MzFIMTAuNDMxVjg5LjU2OXoiLz48L2c+PC9zdmc+",inactiveFullscreen:"data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwIDEyNSIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMTAwIDEyNTsiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+LnN0MHtmaWxsOiM2MDYwNjA7fS5zdDF7ZmlsbDpub25lO3N0cm9rZTojRkY3MzczO3N0cm9rZS13aWR0aDozO3N0cm9rZS1taXRlcmxpbWl0OjEwO308L3N0eWxlPjxnPjxnPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik03Ny4yLDc5LjlINjEuOGMtMS41LDAtMi43LTEuMi0yLjctMi43YzAtMS41LDEuMi0yLjcsMi43LTIuN2gxMi42VjYxLjhjMC0xLjUsMS4yLTIuNywyLjctMi43czIuNywxLjIsMi43LDIuN3YxNS40Qzc5LjksNzguNyw3OC43LDc5LjksNzcuMiw3OS45eiIvPjwvZz48Zz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMzguMyw3OS45SDIyLjljLTEuNSwwLTIuNy0xLjItMi43LTIuN1Y2MS44YzAtMS41LDEuMi0yLjcsMi43LTIuN3MyLjcsMS4yLDIuNywyLjd2MTIuNmgxMi42YzEuNSwwLDIuNywxLjIsMi43LDIuN0M0MSw3OC43LDM5LjgsNzkuOSwzOC4zLDc5Ljl6Ii8+PC9nPjwvZz48Zz48Zz48cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjIuOSw0MWMtMS41LDAtMi43LTEuMi0yLjctMi43VjIyLjljMC0xLjUsMS4yLTIuNywyLjctMi43aDE1LjRjMS41LDAsMi43LDEuMiwyLjcsMi43cy0xLjIsMi43LTIuNywyLjdIMjUuNnYxMi42QzI1LjYsMzkuOCwyNC40LDQxLDIyLjksNDF6Ii8+PC9nPjxnPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik03Ny4yLDQxYy0xLjUsMC0yLjctMS4yLTIuNy0yLjdWMjUuNkg2MS44Yy0xLjUsMC0yLjctMS4yLTIuNy0yLjdzMS4yLTIuNywyLjctMi43aDE1LjRjMS41LDAsMi43LDEuMiwyLjcsMi43djE1LjRDNzkuOSwzOS44LDc4LjcsNDEsNzcuMiw0MXoiLz48L2c+PC9nPjxnPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik05Mi4zLDk1SDcuN0M2LjIsOTUsNSw5My44LDUsOTIuM1Y3LjdDNSw2LjIsNi4yLDUsNy43LDVoODQuNkM5My44LDUsOTUsNi4yLDk1LDcuN3Y4NC42Qzk1LDkzLjgsOTMuOCw5NSw5Mi4zLDk1eiBNMTAuNCw4OS42aDc5LjFWMTAuNEgxMC40Vjg5LjZ6Ii8+PC9nPjxsaW5lIGNsYXNzPSJzdDEiIHgxPSIxMDAiIHkxPSIwIiB4Mj0iNSIgeTI9IjEwNiIvPjwvc3ZnPg==",gear:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwIDEyNSIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTAwIDEwMCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTU5LjQsNWMwLjQsMy4xLDAuOSw2LjEsMS4zLDkuMWMwLDAuMywwLDAuNSwwLjEsMC44YzAuMywxLDUuMywyLjcsNi4yLDJjMi4yLTEuNiw0LjQtMy4yLDYuNS00LjljMC44LTAuNywxLjQtMC41LDIuMSwwICBjNC44LDMuMyw4LjgsNy40LDEyLjEsMTIuMmMwLjUsMC43LDAuNSwxLjIsMCwxLjljLTEuNywyLjEtMy4zLDQuNC00LjksNi41Yy0wLjUsMC43LTAuNywxLjMtMC4yLDIuMWMwLjMsMC41LDAuNiwxLDAuNywxLjUgIGMwLjQsMi4zLDEuOCwzLDMuOSwzLjFjMi4xLDAuMSw0LjIsMC42LDYuMiwwLjhjMC45LDAuMSwxLjIsMC40LDEuNCwxLjJjMC44LDQuMiwxLDguNSwwLjYsMTIuN2MtMC4xLDEuNi0wLjQsMy4zLTAuNyw0LjkgIGMtMC4xLDAuNC0wLjYsMC45LTEsMWMtMi43LDAuNS01LjUsMC45LTguMiwxLjJjLTAuOSwwLjEtMS40LDAuNC0xLjYsMS4zYy0wLjEsMC41LTAuMywxLjEtMC42LDEuNmMtMS40LDEuOS0wLjgsMy41LDAuNyw1LjEgIGMxLjQsMS42LDIuNiwzLjMsMy44LDVjMC4zLDAuNCwwLjMsMS4zLDAuMSwxLjdjLTMuMyw0LjktNy40LDktMTIuMywxMi40Yy0wLjcsMC41LTEuMiwwLjQtMS45LTAuMWMtMi4xLTEuNy00LjQtMy4zLTYuNS00LjkgIGMtMC42LTAuNS0xLjItMC43LTEuOS0wLjJjLTAuNSwwLjMtMS4xLDAuNi0xLjcsMC43Yy0yLjMsMC40LTIuOSwxLjktMyw0Yy0wLjEsMi4xLTAuNSw0LjMtMC45LDYuNGMtMC4xLDAuNC0wLjYsMS0xLjEsMS4xICBjLTUuOSwxLjItMTEuNywxLjItMTcuNiwwLjFjLTAuOC0wLjEtMS4xLTAuNS0xLjItMS4zYy0wLjMtMi43LTAuOC01LjQtMS4xLTguMWMtMC4xLTAuOS0wLjQtMS40LTEuMy0xLjZjLTAuNC0wLjEtMC45LTAuMy0xLjMtMC41ICBjLTItMS40LTMuNy0xLTUuNSwwLjdjLTEuNCwxLjQtMy4yLDIuNC00LjgsMy43Yy0wLjcsMC42LTEuMiwwLjYtMS45LDAuMWMtNC45LTMuNC05LTcuNS0xMi40LTEyLjRjLTAuNS0wLjctMC40LTEuMiwwLjEtMS45ICBjMS43LTIuMSwzLjMtNC40LDQuOS02LjVjMC41LTAuNiwwLjctMS4yLDAuMi0xLjljLTAuMy0wLjQtMC42LTAuOS0wLjYtMS40Yy0wLjQtMi43LTIuMi0zLjItNC42LTMuNGMtMi0wLjEtNC0wLjUtNS45LTAuOSAgYy0wLjQtMC4xLTEtMC43LTEuMS0xLjFjLTEuMi01LjktMS4yLTExLjcsMC0xNy42YzAuMS0wLjQsMC43LTEsMS4xLTFjMi44LTAuNSw1LjYtMC44LDguNC0xLjNjMC41LTAuMSwwLjktMC42LDEuMy0xICBjMC4xLTAuMSwwLjEtMC40LDAuMi0wLjZjMi0yLjgsMS4yLTUuMi0xLTcuNWMtMS4xLTEuMi0yLjEtMi42LTMtMy45Yy0wLjMtMC40LTAuMy0xLjItMC4xLTEuNmMzLjMtNSw3LjUtOS4xLDEyLjQtMTIuNSAgYzAuNy0wLjUsMS4xLTAuNCwxLjcsMC4xYzIuMSwxLjcsNC40LDMuMyw2LjUsNC45YzAuNywwLjUsMS4zLDAuNywyLDAuMmMwLjUtMC4zLDEuMS0wLjYsMS43LTAuN2MyLjMtMC40LDIuOC0xLjksMi45LTMuOSAgYzAuMS0yLjEsMC42LTQuMiwwLjgtNi4zYzAuMS0xLDAuNS0xLjMsMS40LTEuNEM0Ny4xLDMuNyw1My4yLDMuNyw1OS40LDV6IE0zMi42LDQ5LjZjLTAuMSw5LjMsNy41LDE2LjgsMTYuOCwxNi45ICBjOS4yLDAsMTYuOS03LjYsMTYuOS0xNi44YzAtOS4yLTcuNi0xNi43LTE2LjgtMTYuOEM0MC4yLDMyLjgsMzIuNiw0MC4zLDMyLjYsNDkuNnoiLz48dGV4dCB4PSIwIiB5PSIxMTUiIGZpbGw9IiMwMDAwMDAiIGZvbnQtc2l6ZT0iNXB4IiBmb250LXdlaWdodD0iYm9sZCIgZm9udC1mYW1pbHk9IidIZWx2ZXRpY2EgTmV1ZScsIEhlbHZldGljYSwgQXJpYWwtVW5pY29kZSwgQXJpYWwsIFNhbnMtc2VyaWYiPkNyZWF0ZWQgYnkgU2hhd24gRXJkZWx5IDwvdGV4dD48dGV4dCB4PSIwIiB5PSIxMjAiIGZpbGw9IiMwMDAwMDAiIGZvbnQtc2l6ZT0iNXB4IiBmb250LXdlaWdodD0iYm9sZCIgZm9udC1mYW1pbHk9IidIZWx2ZXRpY2EgTmV1ZScsIEhlbHZldGljYSwgQXJpYWwtVW5pY29kZSwgQXJpYWwsIFNhbnMtc2VyaWYiPmZyb20gdGhlIE5vdW4gUHJvamVjdDwvdGV4dD48L3N2Zz4=",inactiveGear:"data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDEwMCAxMjUiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDEwMCAxMjU7IiB4bWw6c3BhY2U9InByZXNlcnZlIj48c3R5bGUgdHlwZT0idGV4dC9jc3MiPi5zdDB7ZmlsbDojNjA2MDYwO30uc3Qxe2ZpbGw6bm9uZTtzdHJva2U6I0ZGNzM3MztzdHJva2Utd2lkdGg6MztzdHJva2UtbWl0ZXJsaW1pdDoxMDt9PC9zdHlsZT48cGF0aCBjbGFzcz0ic3QwIiBkPSJNNTkuNCw1YzAuNCwzLjEsMC45LDYuMSwxLjMsOS4xYzAsMC4zLDAsMC41LDAuMSwwLjhjMC4zLDEsNS4zLDIuNyw2LjIsMmMyLjItMS42LDQuNC0zLjIsNi41LTQuOWMwLjgtMC43LDEuNC0wLjUsMi4xLDBjNC44LDMuMyw4LjgsNy40LDEyLjEsMTIuMmMwLjUsMC43LDAuNSwxLjIsMCwxLjljLTEuNywyLjEtMy4zLDQuNC00LjksNi41Yy0wLjUsMC43LTAuNywxLjMtMC4yLDIuMWMwLjMsMC41LDAuNiwxLDAuNywxLjVjMC40LDIuMywxLjgsMywzLjksMy4xczQuMiwwLjYsNi4yLDAuOGMwLjksMC4xLDEuMiwwLjQsMS40LDEuMmMwLjgsNC4yLDEsOC41LDAuNiwxMi43Yy0wLjEsMS42LTAuNCwzLjMtMC43LDQuOWMtMC4xLDAuNC0wLjYsMC45LTEsMWMtMi43LDAuNS01LjUsMC45LTguMiwxLjJjLTAuOSwwLjEtMS40LDAuNC0xLjYsMS4zYy0wLjEsMC41LTAuMywxLjEtMC42LDEuNmMtMS40LDEuOS0wLjgsMy41LDAuNyw1LjFjMS40LDEuNiwyLjYsMy4zLDMuOCw1YzAuMywwLjQsMC4zLDEuMywwLjEsMS43Yy0zLjMsNC45LTcuNCw5LTEyLjMsMTIuNGMtMC43LDAuNS0xLjIsMC40LTEuOS0wLjFjLTIuMS0xLjctNC40LTMuMy02LjUtNC45Yy0wLjYtMC41LTEuMi0wLjctMS45LTAuMmMtMC41LDAuMy0xLjEsMC42LTEuNywwLjdjLTIuMywwLjQtMi45LDEuOS0zLDRzLTAuNSw0LjMtMC45LDYuNGMtMC4xLDAuNC0wLjYsMS0xLjEsMS4xYy01LjksMS4yLTExLjcsMS4yLTE3LjYsMC4xYy0wLjgtMC4xLTEuMS0wLjUtMS4yLTEuM2MtMC4zLTIuNy0wLjgtNS40LTEuMS04LjFjLTAuMS0wLjktMC40LTEuNC0xLjMtMS42Yy0wLjQtMC4xLTAuOS0wLjMtMS4zLTAuNWMtMi0xLjQtMy43LTEtNS41LDAuN2MtMS40LDEuNC0zLjIsMi40LTQuOCwzLjdjLTAuNywwLjYtMS4yLDAuNi0xLjksMC4xYy00LjktMy40LTktNy41LTEyLjQtMTIuNGMtMC41LTAuNy0wLjQtMS4yLDAuMS0xLjljMS43LTIuMSwzLjMtNC40LDQuOS02LjVjMC41LTAuNiwwLjctMS4yLDAuMi0xLjljLTAuMy0wLjQtMC42LTAuOS0wLjYtMS40Yy0wLjQtMi43LTIuMi0zLjItNC42LTMuNGMtMi0wLjEtNC0wLjUtNS45LTAuOWMtMC40LTAuMS0xLTAuNy0xLjEtMS4xYy0xLjItNS45LTEuMi0xMS43LDAtMTcuNmMwLjEtMC40LDAuNy0xLDEuMS0xYzIuOC0wLjUsNS42LTAuOCw4LjQtMS4zYzAuNS0wLjEsMC45LTAuNiwxLjMtMWMwLjEtMC4xLDAuMS0wLjQsMC4yLTAuNmMyLTIuOCwxLjItNS4yLTEtNy41Yy0xLjEtMS4yLTIuMS0yLjYtMy0zLjljLTAuMy0wLjQtMC4zLTEuMi0wLjEtMS42YzMuMy01LDcuNS05LjEsMTIuNC0xMi41YzAuNy0wLjUsMS4xLTAuNCwxLjcsMC4xYzIuMSwxLjcsNC40LDMuMyw2LjUsNC45YzAuNywwLjUsMS4zLDAuNywyLDAuMmMwLjUtMC4zLDEuMS0wLjYsMS43LTAuN2MyLjMtMC40LDIuOC0xLjksMi45LTMuOWMwLjEtMi4xLDAuNi00LjIsMC44LTYuM2MwLjEtMSwwLjUtMS4zLDEuNC0xLjRDNDcuMSwzLjcsNTMuMiwzLjcsNTkuNCw1eiBNMzIuNiw0OS42Yy0wLjEsOS4zLDcuNSwxNi44LDE2LjgsMTYuOWM5LjIsMCwxNi45LTcuNiwxNi45LTE2LjhTNTguNywzMyw0OS41LDMyLjlDNDAuMiwzMi44LDMyLjYsNDAuMywzMi42LDQ5LjZ6Ii8+PGxpbmUgY2xhc3M9InN0MSIgeDE9Ijk1LjYiIHkxPSI0IiB4Mj0iMTEiIHkyPSIxMTIiLz48L3N2Zz4=",backArrow:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwIDEyNSIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTAwIDEwMCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PGc+PGxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utd2lkdGg9IjMiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJiZXZlbCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiB4MT0iOTMuMSIgeTE9IjUwIiB4Mj0iNi45IiB5Mj0iNTAiLz48bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS13aWR0aD0iMyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49ImJldmVsIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHgxPSI2LjkiIHkxPSI1MCIgeDI9IjMyLjciIHkyPSI3NS45Ii8+PGxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utd2lkdGg9IjMiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJiZXZlbCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiB4MT0iNi45IiB5MT0iNTAiIHgyPSIzMi43IiB5Mj0iMjQuMSIvPjwvZz48L3N2Zz4=",inactiveBackArrow:"data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwIDEyNSIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMTAwIDEyNTsiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+LnN0MHtmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOmJldmVsO3N0cm9rZS1taXRlcmxpbWl0OjEwO30uc3Qxe2ZpbGw6bm9uZTtzdHJva2U6I0ZGNzM3MztzdHJva2Utd2lkdGg6MztzdHJva2UtbWl0ZXJsaW1pdDoxMDt9PC9zdHlsZT48Zz48bGluZSBjbGFzcz0ic3QwIiB4MT0iOTMuMSIgeTE9IjUwIiB4Mj0iNi45IiB5Mj0iNTAiLz48bGluZSBjbGFzcz0ic3QwIiB4MT0iNi45IiB5MT0iNTAiIHgyPSIzMi43IiB5Mj0iNzUuOSIvPjxsaW5lIGNsYXNzPSJzdDAiIHgxPSI2LjkiIHkxPSI1MCIgeDI9IjMyLjciIHkyPSIyNC4xIi8+PC9nPjxsaW5lIGNsYXNzPSJzdDEiIHgxPSI4OSIgeTE9IjEzIiB4Mj0iMjQiIHkyPSI5NiIvPjwvc3ZnPg=="},this.controls=[],this.util=i,this.webgl=n,this.webvr=a,this.vrButton=null,this.fullscreenButton=null,this.poseButton=null,this.exitFullscreenButton=null,this.exitVRButton=null,this.vrHandleKeys=this.vrHandleKeys.bind(this),t&&this.init(this.UI_DOM)}return i(e,[{key:"init",value:function(e){e||(console.log("no mode provided, setting default"),e=this.mode),document.addEventListener("webkitfullscreenchange",this.fullscreenChange.bind(this),!1),document.addEventListener("mozfullscreenchange",this.fullscreenChange.bind(this),!1),document.addEventListener("msfullscreenchange",this.fullscreenChange.bind(this),!1),this.createUi()}},{key:"setControlsByMode",value:function(e){switch(this.mode){case this.UI_VR:this.exitVRButton.show(),this.vrButton.hide(),this.fullscreenButton.hide();break;case this.UI_FULLSCREEN:this.vrButton.hide(),this.fullscreenButton.hide(),this.exitFullscreenButton.show();break;case this.UI_DOM:this.exitVRButton.hide(),this.exitFullscreenButton.hide(),this.vrButton.show(),this.fullscreenButton.show()}}},{key:"createUi",value:function(){var e=this;console.log("entering DOMUi");var t=this.webgl.getCanvas(),r=t.parentNode;r.style.margin="0",r.style.border="0",r.style.padding="0";var i=t.parentNode.querySelector(".webvr-mini-controls");if(i||(i=document.createElement("nav")),t){var n=this.webvr;console.log("creating DOM Ui"),this.controls=i;var a=this.createButton();a.style.top="0px",a.style.left="0px",a.zIndex="9999",a.activeSrc=this.icons.vr,a.inactiveSrc=this.icons.inactiveVR,n.hasWebVR()?a.activate():a.inactivate(),a.show(),this.vrButton=a,this.controls.vrButton=a,this.util.emitter.on("vrdisplayready",function(t){var r=t.toLowerCase();t&&(r.indexOf("vive")!==e.util.NOT_IN_LIST?(a.src=a.activeSrc=e.icons.htcvive,r.indexOf("emulat")!==e.util.NOT_IN_LIST&&a.emulated(e.icons.emulated)):r.indexOf("oculus")!==e.util.NOT_IN_LIST&&(a.src=a.activeSrc=e.icons.oculusrift)),
a.activate()});var o=this.createButton();o.style.top="4px",o.style.left="60px",o.style.width="32px",o.style.height="32px",o.activeSrc=this.icons.fullscreen,o.inactiveSrc=this.icons.inactiveFullscreen,this.hasFullscreen()?o.activate():o.inactivate(),o.show(),this.fullscreenButton=o,this.controls.fullscreenButton=o;var s=this.createButton();s.style.top="0px",s.style.left="0px",s.zIndex="9999",s.activeSrc=this.icons.backArrow,s.inactiveSrc=this.icons.inactiveBackArrow,this.hasFullscreen()?s.activate():s.inactivate(),s.hide(),this.exitFullscreenButton=s,this.controls.exitFullscreenButton=s;var u=this.createButton();u.style.top="0px",u.style.left="0px",u.zIndex="9999",u.activeSrc=this.icons.backArrow,u.inactiveSrc=this.icons.inactiveBackArrow,n.hasWebVR()?u.activate():u.inactivate(),u.hide(),this.exitVRButton=u,this.controls.exitVRButton=u,this.util.emitter.on("vrdisplayready",u.activate),a.addEventListener("click",function(t){console.log("clicked vr button..."),t.preventDefault(),e.vrButton.hide(),e.fullscreenButton.hide(),e.exitVRButton.show(),e.mode=e.UI_VR,e.fullscreenChange(t),addEventListener("keydown",e.vrHandleKeys),n.requestPresent()}),o.addEventListener("click",function(t){console.log("clicked fullscreen button..."),t.preventDefault();var i=Math.max(window.devicePixelRatio,1);e.oldWidth=r.clientWidth*i|0,e.oldHeight=r.clientHeight*i|0,r.style.width=e.util.getScreenWidth()+"px",r.style.height=e.util.getScreenHeight()+"px",e.mode=e.UI_DOM,e.requestFullscreen()}),s.addEventListener("click",function(t){console.log("clicked exit fullscreen button..."),t.preventDefault(),e.exitFullscreen()}),u.addEventListener("click",function(t){console.log("clicked exit vr button"),t.preventDefault(),e.exitVRButton.hide(),e.vrButton.show(),e.fullscreenButton.show(),n.exitPresent(function(){removeEventListener("keydown",e.vrHandleEsc),e.setControlsByMode(e.UI_DOM)})}),i.appendChild(a),i.appendChild(o),i.appendChild(s),i.appendChild(u)}else console.error("Ui::createDOMUi(): canvas not defined")}},{key:"vrHandleKeys",value:function(e){switch(e.keyCode){case 27:console.log("AN ESCAPE"),this.mode=this.UI_DOM,this.webvr.exitPresent()}}},{key:"hasFullscreen",value:function(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}},{key:"requestFullscreen",value:function(e){var t=this.webgl.getCanvas(),r=t.parentNode;r.requestFullscreen?r.requestFullscreen():r.mozRequestFullScreen?r.mozRequestFullScreen():r.webkitRequestFullscreen?r.webkitRequestFullscreen():r.msRequestFullscreen&&r.msRequestFullscreen()}},{key:"exitFullscreen",value:function(e){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}},{key:"fullscreenChange",value:function(e){var t=this.webgl.getCanvas(),r=t.parentNode,i=this.webgl.getContext();switch(this.mode){case this.UI_VR:console.log("from vr to dom..."),this.setControlsByMode(this.mode);break;case this.UI_FULLSCREEN:console.log("from fullscreen to DOM..."),r.style.width="",r.style.height="";var n=this.oldWidth,a=this.oldHeight;i.viewportWidth=n,i.viewportHeight=a,i.viewport(0,0,i.viewportWidth,i.viewportHeight),t.width=n,t.height=a,this.mode=this.UI_DOM,this.setControlsByMode(this.mode);break;default:case this.UI_DOM:console.log("from DOM to fullscreen..."),this.mode=this.UI_FULLSCREEN,this.setControlsByMode(this.mode)}}},{key:"createButton",value:function(){var e=this,t=document.createElement("img");t.className="webvr-mini-button";var r=t.style;return r.position="absolute",r.width="36px",r.height="36px",r.backgroundSize="cover",r.backgroundColor="transparent",r.border=0,r.userSelect="none",r.webkitUserSelect="none",r.MozUserSelect="none",r.cursor="pointer",r.padding="12px",r.zIndex="10",r.display="none",r.boxSizing="content-box",t.draggable=!1,t.addEventListener("dragstart",function(e){e.preventDefault()}),t.addEventListener("mouseenter",function(e){r.filter=r.webkitFilter="drop-shadow(0 0 6px rgba(255,255,255,1))"}),t.addEventListener("mouseleave",function(e){r.filter=r.webkitFilter=""}),t.show=function(){t.style.display="inline-block"},t.hide=function(){t.style.display="none"},t.emulated=function(r){var i=document.createElement("img");i.style.position="absolute",i.style.width="36px",i.style.height="56px",i.style.top="0",i.style.left=t.style.left,i.style.zIndex="1",i.style.display="inline-block",i.src=r,e.controls.appendChild(i)},t.activate=function(){t.src=t.activeSrc},t.inactivate=function(){t.src=t.inactiveSrc},t}}]),e}();t.default=n},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=r(18),s=i(o),u=function(){function e(t){n(this,e),console.log("in Util"),this.NOT_IN_LIST=-1,this.DEFAULT_KEY="default",this.emitter=new s.default,this.setTrim(),this.setPerformance(),this.setFinite(),this.setSlice()}return a(e,[{key:"setTrim",value:function(){String.trim=String.trim||function(e){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}},{key:"setFinite",value:function(){Number.isFinite=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)}}},{key:"setPerformance",value:function(){if(!1 in window&&(window.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},!1 in window.performance){var e=Date.now();performance.timing&&performance.timing.navigationStart&&(e=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-e}}}},{key:"setSlice",value:function(){Object.defineProperty&&(Uint16Array&&!Uint16Array.prototype.slice&&Object.defineProperty(Uint16Array.prototype,"slice",{value:Array.prototype.slice}),Uint32Array&&!Uint32Array.prototype.slice&&Object.defineProperty(Uint32Array.prototype,"slice",{value:Array.prototype.slice}),Float32Array&&!Float32Array.prototype.slice&&Object.defineProperty(Float32Array.prototype,"slice",{value:Array.prototype.slice}))}},{key:"isString",value:function(e){return"string"==typeof e||isObjectLike(e)&&objToString.call(e)==stringTag||!1}},{key:"reverseString",value:function(e){return e.split("").reverse().join("")}},{key:"isWhitespace",value:function(e){return!!e.match&&e.match(/^\s*$/)}},{key:"computeId",value:function(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?r:3&r|8).toString(16)});return t}},{key:"isNumber",value:function(e){return Number.isFinite(parseFloat(e))}},{key:"isPowerOfTwo",value:function(e){return 0===(e&e-1)}},{key:"isEven",value:function(e){return e%2==0}},{key:"isOdd",value:function(e){return 1==Math.abs(e%2)}},{key:"degToRad",value:function(e){return e*Math.PI/180}},{key:"frac",value:function(e){return e%1}},{key:"getRand",value:function(e,t){return void 0!==e&&void 0!==t||(t=1,e=0),e+(Math.random()+1/(1+this.getSeed()))%1*(t-e)}},{key:"getRandInt",value:function(e){return Math.floor(Math.random()*e)}},{key:"randomColor",value:function(){return[Math.abs(Math.random()),Math.abs(Math.random()),Math.abs(Math.random())]}},{key:"numKeys",value:function(e){return Object.keys(e).length}},{key:"isArray",value:function(e){var t=Object.prototype.toString.call(e);return t.indexOf("Array")>this.NOT_IN_LIST}},{key:"containsAll",value:function(e,t){return t.every(function(t){return e.includes(t)})}},{key:"compArr",value:function(e,t){return this.containsAll(e,t)&&this.containsAll(t,e)}},{key:"getArr",value:function(e,t,r){if(!e||t<0||r<1)return console.error("getArr() invalid params, arr:"+e+", index:"+t+" stride:"+r),-1;for(var i=[],n=2;n<r;n++)i.push(e[t*r+n]);return i}},{key:"setArr",value:function(e,t){var r=arguments.length;if(r<3)return console.error("setArr() no value or index specified"),-1;for(var i=r-2,n=2;n<r;n++)e[idx*i+n]-arguments[n];return idx}},{key:"copyArr",value:function(e){if(e.slice)return e.slice();for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e[r];return t}},{key:"canFlatten",value:function(e){return"undefined"!=typeof e[0][0]&&e[0].constructor===Array}},{key:"flatten",value:function(e,t){t!==!0&&t!==!1&&(t=!1);for(var r=t&&e||e.slice(),i=[],n=r.shift();void 0!==n;n=r.shift())Array.isArray(n)?r.unshift.apply(r,n):i.push(n);return i}},{key:"unFlatten",value:function(e,t){for(var r=0,i=0,n=[],a=(new Array(e.length/t),0);a<e.length;a+=t){for(var o=new Array(t),s=0;s<t;s++)o[s]=e[i++];n[r++]=o}return n}},{key:"concatArr",value:function(e,t){var r=null,i=e.length,n=t.length;if(ArrayBuffer.isView(e))e instanceof Float32Array?(r=new Float32Array(i+n),!t instanceof Float32Array&&(t=Float32Array.from(t))):e instanceof Uint32Array?(r=new Uint32Array(i+n),!t instanceof Uint32Array&&(t=Uint32Array.from(t))):e instanceof Uint16Array&&(r=new Uint16Array(i+n),!t instanceof Uint16Array&&(t=Uint16Array.from(t))),r.set(e),r.set(t,i);else if(ArrayBuffer.isView(t)){for(var a=0;a<n;a++)e.push(t[a]);r=e}else r=e.concat(t);return r}},{key:"concatUniqueArr",value:function(){for(var e=[],t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var n=0;n<r.length;n++)for(var a=r[n],o=0;o<a.length;o++)!a[o]in e&&e.push(a[o]);return e}},{key:"swap",value:function(e,t,r){var i=e[t];return e[t]=x[r],e[t]=i,e}},{key:"getSeed",value:function(){var e=void 0;try{if(Uint32Array&&window.crypto&&window.crypto.getRandomValues){var t=new Uint32Array(1);window.crypto.getRandomValues(t),e=t.length?t[0]+"":null}}catch(e){}finally{e||(e=Math.floor(1e9*Math.random()).toString()+(new Date).getTime())}return e}},{key:"getFilePath",value:function(e){return e?e.substring(0,e.lastIndexOf("/"))+"/":null}},{key:"getBaseName",value:function(e){return e?e.replace(/^(.*[\/\\])?/,"").replace(/(\.[^.]*)$/,""):null}},{key:"getFileExtension",value:function(e){return e?e.slice((e.lastIndexOf(".")-1>>>0)+2).toLowerCase():null}},{key:"isIFrame",value:function(){try{return window.self!==window.top}catch(e){return!0}return!1}},{key:"getMousePosition",value:function(e,t){var r=e.getBoundingClientRect();return{x:t.clientX-r.left,y:t.clientY-r.top}}},{key:"getScreenWidth",value:function(){return window.screen.width}},{key:"getScreenHeight",value:function(){return window.screen.height}},{key:"getWindowWidth",value:function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth}},{key:"getWindowHeight",value:function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}}]),e}();t.default=u},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=function(){function e(t,i,n,a){r(this,e),console.log("in webGL class"),this.gl=null,this.contextCount=0,this.glVers=0,this.glMatrix=i,this.util=n,this.NOT_IN_LIST=n.NOT_IN_LIST,this.near=.1,this.far=100,this.stats={},t===!0&&this.init(document.getElementById("webvr-mini-canvas")),a&&(this.debug=a)}return i(e,[{key:"init",value:function(e,t,r){var i=this;if(e)e=this.util.isString(e)?document.getElementById(e):e;else{e=document.createElement("canvas"),e.width=480,e.height=320;var n=document.createElement("div");n.className="webvr-mini-player";var a=document.createElement("div");a.className="webvr-mini-controls",n.appendChild(a),n.appendChild(e),document.body.appendChild(n)}if(e){var o=e.getBoundingClientRect();if(e.width=o.width,e.height=o.height,this.oldWidth=this.util.getWindowWidth(),this.oldHeight=this.util.getWindowHeight(),this.gl=this.createContext(e),this.gl){var s=this.gl;if(s.getParameter&&s.getShaderPrecisionFormat){var u=this.stats;u.highp=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision,u.maxTexSize=s.getParameter(s.MAX_TEXTURE_SIZE),u.maxCubeSize=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),u.maxRenderbufferSize=s.getParameter(s.MAX_RENDERBUFFER_SIZE),u.combinedUnits=s.getParameter(s.MAX_COMBINED_TEXTURE_IMAGE_UNITS),u.maxVSattribs=s.getParameter(s.MAX_VERTEX_ATTRIBS),u.maxVertexShader=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS),u.maxFragmentShader=s.getParameter(s.MAX_FRAGMENT_UNIFORM_VECTORS)}else this.stats=!1;return e.addEventListener("webglcontextlost",function(e){console.error("error: webglcontextlost event, context count:"+i.contextCount),t&&(i.gl=null,t(e)),e.preventDefault()},!1),e.addEventListener("webglcontextrestored",function(e){console.error("error: webglcontextrestored event, context count:"+i.contextCount),r&&r(e),e.preventDefault()},!1),s.viewportWidth=e.width,s.viewportHeight=e.height,window.addEventListener("resize",function(e){i.resizeCanvas(),e.preventDefault()},!1),this.clearTextures(),s.enable(s.DEPTH_TEST),s.enable(s.CULL_FACE),s.clearDepth(1),s.depthFunc(s.LEQUAL),s.enable(s.BLEND),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),s.clearColor(.1,.1,.1,1),this.clear(),this.gl}console.error("no WebGL context")}else console.error(" no WebGL canvas");return null}},{key:"hasWebGL",value:function(){return!!this.getContext()}},{key:"addVertexBufferSupport",value:function(e){var t=e.getExtension("OES_vertex_array_object");return t&&(e.createVertexArray=function(){return t.createVertexArrayOES()},e.deleteVertexArray=function(e){t.deleteVertexArrayOES(e)},e.isVertexArray=function(e){return t.isVertexArrayOES(e)},e.bindVertexArray=function(e){t.bindVertexArrayOES(e)},e.VERTEX_ARRAY_BINDING=t.VERTEX_ARRAY_BINDING_OES),t}},{key:"addIndex32Support",value:function(e){var t=e.getExtension("OES_element_index_uint");return t}},{key:"getCanvas",value:function(){return this.gl?this.gl.canvas:null}},{key:"resizeCanvas",value:function(e){if(this.ready()){console.log("resize");var t=this.util.getWindowWidth(),r=this.util.getWindowHeight();if(e||t!==this.oldWidth){var i=Math.max(window.devicePixelRatio,1),n=this.getContext(),a=this.getCanvas(),o=a.clientWidth*i|0,s=a.clientHeight*i|0;a.width=o,a.height=s,n.viewportWidth=o,n.viewportHeight=s,n.viewport(0,0,n.viewportWidth,n.viewportHeight)}this.oldWidth=t,this.oldHeight=r}return!1}},{key:"createContext",value:function(e){if(!window.WebGLRenderingContext)return console.error("this browser does not support webgl"),null;var t=null;t&&this.contextCount>0&&(console.warn("killing context"),this.killContext(),this.contextCount--,this.gl=null);for(var r=["webgl2","experimental-webgl2","webgl","experimental-webgl"],i=0;i<r.length;){try{if(this.debug){if(t=this.debug.makeDebugContext(e.getContext(r[i]))){console.warn("using debug context"),"function"!==t.getParameter&&(t=e.getContext(r[i]),console.warn("unable to use debug context, trying release:"+r[i]," getParameter:"+t.getParameter));break}}else if(t=e.getContext(r[i])){console.warn("using release context mode:"+r[i]);break}}catch(e){console.warn("failed to load context:"+r[i])}i++}if(t&&"function"==typeof t.getParameter)switch(this.contextCount++,this.gl=t,this.glVers=t.getParameter(t.VERSION).toLowerCase(),1!=i&&3!=i||console.warn("experimental context, .getParameter() may not work"),console.log("version:"+t.getParameter(t.VERSION)),i){case 0:case 1:this.glVers=2,this.stats.uint32=!0;break;case 2:case 3:this.glVers=1,this.addVertexBufferSupport(t),this.stats.uint32=this.addIndex32Support(t)}return this.stats.uint32?this.MAX_DRAWELEMENTS=2e9:this.MAX_DRAWELEMENTS=65534,this.gl}},{key:"getContext",value:function(){return this.gl||console.warn("warning webgl context not initialized"),this.gl}},{key:"killContext",value:function(){console.log("in killcontext, count:"+this.contextCount),this.contextCount&&(console.log("killing WebGL context, count before:"+this.contextCount),this.gl.getExtension("WEBGL_lose_context").loseContext(),this.contextCount--)}},{key:"ready",value:function(){this.gl;return!(!this.gl||!this.glMatrix)}},{key:"clear",value:function(){var e=this.gl;e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}},{key:"clearTextures",value:function(){for(var e=this.gl,t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),r=0;r<t;r++)e.activeTexture(e.TEXTURE0+r),e.bindTexture(e.TEXTURE_2D,null),e.bindTexture(e.TEXTURE_CUBE_MAP,null);e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null)}},{key:"createShader",value:function(e,t){var r=null;if(e&&t){if(this.ready()){var i=this.gl;t.replace(/^[ \t]*\n/,""),e===i.VERTEX_SHADER?r=i.createShader(e):e===i.FRAGMENT_SHADER?r=i.createShader(e):console.error("createShader: type not recognized:"+e),i.shaderSource(r,t),i.compileShader(r),i.getShaderParameter(r,i.COMPILE_STATUS)||(console.error("createShader:"+i.getShaderInfoLog(r)),r=null)}}else console.error("createShader: invalid params, type:"+e+" source:"+t);return r}},{key:"createVertexShader",value:function(e){return this.createShader(this.gl.VERTEX_SHADER,e)}},{key:"createFragmentShader",value:function(e){return this.createShader(this.gl.FRAGMENT_SHADER,e)}},{key:"fetchShader",value:function(e,t){var r=this;return fetch(t,{method:"POST",mode:"cors",redirect:"follow",headers:new Headers({"Content-Type":"text/plain"})}).then(function(e){return console.log(text),!!e.ok&&e.text()}).then(function(t){if(t)return r.createShader(e,t)}),null}},{key:"fetchVertexShader",value:function(e){return this.fetchShader(this.gl.VERTEX_SHADER,e)}},{key:"fetchFragmentShader",value:function(e){return this.fetchShader(this.gl.FRAGMENT_SHADER,e)}},{key:"createShaderFromTag",value:function(e){if(this.util.isString(e)&&(e=document.getElementById(e)),!e)return console.error("createShaderFromTag: not found ("+e+")"),!1;var t=null;if("x-shader/x-vertex"==e.type)t=this.gl.VERTEX_SHADER;else{if("x-shader/x-fragment"!=e.type)return console.error("createShaderFromTag: type not found:("+e.type+")"),null;t=this.gl.FRAGMENT_SHADER}for(var r="",i=e.firstChild;i;)3==i.nodeType&&(r+=i.textContent),i=i.nextSibling;return this.createShader(t,r)}},{key:"createProgram",value:function(e,t){if(!e||!t)return console.error("createProgram: parameter error, vs:"+e+" fs:"+t),null;var r={};if(this.ready()){var i=this.gl,n=this.createVertexShader(e.code),a=this.createFragmentShader(t.code),o=i.createProgram();i.attachShader(o,n),i.attachShader(o,a),i.linkProgram(o),i.getProgramParameter(o,i.LINK_STATUS)?(r.shaderProgram=o,r.vsVars=e.varList,r.fsVars=t.varList,r.renderList=[]):(console.error("createProgram:"+i.getProgramInfoLog(o)),this.checkShaders(e,t,o))}return r}},{key:"createVarList",value:function(e){var t=e.length,r=this.NOT_IN_LIST,i=" ",n={},a=["attribute","uniform","varying"];if(t)for(var o=0;o<t;o++){var s=e[o];if(s.indexOf("void main")!==r)break;for(var u=0;u<a.length;u++){var l=a[u];if(n[l]||(n[l]={}),s.indexOf(l)>r){s=s.replace(/;\s*$/,""),s=s.split(i);var c=s.shift();n[c]||(n[c]={});var h=s.shift();n[c][h]||(n[c][h]={});var M=s.shift();n[c][h][M]||(n[c][h][M]="empty")}}}return n}},{key:"setAttributeArrays",value:function(e,t){var r=this.gl;for(var i in t){var n=t[i];for(var a in n)n[a]=r.getAttribLocation(e,a)}return t}},{key:"setUniformLocations",value:function(e,t){var r=this.gl;for(var i in t){var n=t[i];for(var a in n)n[a]=r.getUniformLocation(e,a)}return t}},{key:"bindAttributeLocations",value:function(e,t){var r=this.gl;if(t)for(var i in t)console.log("binding attribute:"+i+" to:"+t[i]),r.bindAttribLocation(e,t[i],i);else console.warn("webgl.bindAttributes: no attributes supplied")}},{key:"getAttributes",value:function(e){for(var t=this.gl,r={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),n=0;n<i;n++){var a=t.getActiveAttrib(e,n);r[a.name]=t.getAttribLocation(e,a.name)}return r.count=i,r}},{key:"getUniforms",value:function(e){for(var t=this.gl,r={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),n="",a=0;a<i;a++){var o=t.getActiveUniform(e,a);n=o.name.replace("[0]",""),console.log("adding uniform:"+n),r[n]=t.getUniformLocation(e,n)}return r.count=i,r}},{key:"getVarying",value:function(e){}},{key:"checkShaders",value:function(e,t,r){var i=this.gl;return!!i.getProgramParameter(r,i.LINK_STATUS)||(e&&!i.getShaderParameter(e,i.COMPILE_STATUS)?console.error("error creating the vertex shader, "+i.getShaderInfoLog(e)):t&&!i.getShaderParameter(t,i.COMPILE_STATUS)?console.error("error creating the fragment shader, "+i.getShaderInfoLog(t)):console.error("error in gl program linking"),i.deleteProgram(r),!1)}},{key:"checkBufferObjects",value:function(e){return e&&e instanceof ArrayBuffer}},{key:"enumToString",value:function(e,t){for(var r in e)if(e[r]==t)return r;return"0x"+t.toString(16)}},{key:"stats",value:function(){return JSON.stringify(this.stats)}}]),e}();t.default=n},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=function(){function e(t,i,n,a){r(this,e),console.log("in webVR class"),this.util=i,this.glMatrix=n,this.webgl=a,this.vrVers=1,this.display=null,this.frameData=null,this.PLAYER_HEIGHT=1.75,this.stats={},t===!0&&this.init()}return i(e,[{key:"init",value:function(){var e=this,t=this.stats;navigator.getVRDisplays?navigator.getVRDisplays().then(function(r){if(console.log("WebVR::init(): webvr is available"),e.frameData=new VRFrameData,e.frameData&&(console.log("WebVR::init(): vr frame data is available"),r.length>0)){var i=r[0];e.display=i,i&&(console.log("WebVR::init(): valid vr display present"),i.isPresenting&&(console.warn("WebVR::init(): display was already presenting, exit first"),e.exitPresent()),i.depthNear?e.webgl.near=i.depthNear:i.depthNear=e.webgl.near,i.depthFar?e.webgl.far=i.depthFar:i.depthFar=e.webgl.far,t.displayName=i.displayName,e.setStageParameters(i),e.util.emitter.emit("vrdisplayready",i.displayName),window.addEventListener("vrdisplaypresentchange",e.presentChange.bind(e),!1),window.addEventListener("vrdisplayactivate",e.requestPresent.bind(e),!1),window.addEventListener("vrdisplaydeactivate",e.exitPresent.bind(e),!1))}}):console.error("WebVR::init(): webgl not present, or obsolete version")}},{key:"getFrameData",value:function(){if(this.display){var e=this.display.getFrameData(this.frameData);if(e)return this.frameData;console.error("WebVR::getFrame(): display.getFrameData returned false")}return console.error("WebVR::getFrame(): display not available to get frameData"),null}},{key:"hasWebVR",value:function(){return!(!this.frameData||!this.display)}},{key:"getDisplay",value:function(){return this.display}},{key:"setStageParameters",value:function(e){var t=e.stageParameters;t?(console.log("WebVR::setStageParameters(): vr display stageParameters present"),t.sizeX>0&&t.sizeZ>0?console.log("WebVR::setStageParameters(): vr device stageParameters sizeX:"+t.sizeX+" and sizeZ:"+t.sizeZ):console.log("WebVR::setStageParameters(): vr device reported stateParameters without a size, using defaults (3000")):console.error("vr deviced did not report stage parameters")}},{key:"getStandingViewMatrix",value:function(e,t,r){var i=this.glMatrix.mat4,n=this.display;return n.stageParameters?(i.invert(e,n.stageParameters.sittingToStandingTransform),i.multiply(e,t,e)):(i.identity(e),i.translate(e,e,[0,PLAYER_HEIGHT,0]),i.invert(e,e),i.multiply(e,t,e)),e}},{key:"vrResize",value:function(){console.log("WebVR::vrResize(): in vr resize");var e=this.display,t=this.webgl.getContext(),r=this.webgl.getCanvas(),i=r.parentNode;this.oldWidth=i.clientWidth*n|0,this.oldHeight=i.clientHeight*n|0;var n=Math.max(window.devicePixelRatio,1);if(e&&e.isPresenting){console.log("WebVR::vrResize(): display presenting");var a=e.getEyeParameters("left"),o=e.getEyeParameters("right"),s=2*Math.max(a.renderWidth,o.renderWidth),u=Math.max(a.renderHeight,o.renderHeight);r.width=s,r.height=u,t.viewportWidth=s,t.viewportHeight=u,t.viewport(0,0,t.viewportWidth,t.viewportHeight),console.log("WebVR::vrResize(): new width:"+r.width+" height:"+r.height)}else i.style.width="",i.style.height="",this.webgl.resizeCanvas(!0)}},{key:"requestPresent",value:function(){console.log("WebVR::requestPresent(): ");var e=this.display;e&&e.capabilities.canPresent?e.requestPresent([{source:this.webgl.getCanvas()}]).then(function(){console.log("WebVR::requestPresent(): present was successful")},function(){console.error("WebVR::requestPresent(): present failed")}):console.error("WebVR::requestPresent(): vrdisplay unable to present")}},{key:"exitPresent",value:function(){console.log("WebVR::exitPresent():");var e=this.display;if(e){if(!e.isPresenting)return;e.exitPresent().then(function(){console.log("WebVR::exitPresent(): exited display presentation")},function(){console.error("WebVR::exitPresent(): failed to exit display presentation")})}else console.error("WebVR::exitPresent(): no valid display found")}},{key:"presentChange",value:function(){var e=this.display;this.vrResize(),console.log("WebVR::presentChange():"),e.isPresenting?e.capabilities.hasExternalDisplay:e.capabilities.hasExternalDisplay}},{key:"stats",value:function(){return JSON.stringify(this.stats)}}]),e}();t.default=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),l=r(2),c=n(l),h=r(7),M=n(h),d=r(13),f=n(d),m=r(21),g=n(m),y=r(5),L=n(y),v=r(6),I=(n(v),r(4)),x=(n(I),r(12)),T=n(x),p=function(e){function t(e,r,i,n,s,u){a(this,t);var l=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i.util));return console.log("in World class"),l.glMatrix=r,l.webgl=i,l.util=i.util,l.vr=n,l.shaderPool=s,l.texturePool=new f.default(e,l.util,i),l.materialPool=new g.default(e,l.util,i,l.texturePool),l.modelPool=new L.default(e,l.util,i,l.texturePool,l.materialPool),l.geometryPool=new M.default(e,l.util,r,i,l.modelPool),l.primFactory=new T.default(!0,l),l.lights=u,l.canvas=i.getCanvas(),l.glMatrix=i.glMatrix,l.pMatrix=l.glMatrix.mat4.create(),l.mvMatrix=l.glMatrix.mat4.create(),l.last=performance.now(),l.counter=0,l.render=l.render.bind(l),l}return s(t,e),u(t,[{key:"resize",value:function(e,t,r){console.error("world::resize(): not implemented yet!")}},{key:"load",value:function(){console.error("world::load(): not implemented yet!")}},{key:"save",value:function(){console.error("world::save(): not implemented yet!")}},{key:"init",value:function(){var e=this.glMatrix.vec3,t=this.glMatrix.vec4,r=this.primFactory.geometryPool.vec5,i=this.primFactory.geometryPool.typeList,n=this.primFactory.geometryPool.directions,a=this.util;this.s1=this.shaderPool.getShader("shaderTexture"),this.s2=this.shaderPool.getShader("shaderColor"),this.s3=this.shaderPool.getShader("shaderDirLightTexture"),this.primFactory.createPrim(this.s1,i.SKYDOME,"skydome",r(18,18,18,0),r(10,10,10),e.fromValues(0,0,0),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(0),a.degToRad(.1),a.degToRad(0)),["img/panorama_01.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s1,i.CUBE,"first cube",r(1,1,1),r(10,10,10,0),e.fromValues(1,0,2),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(1),a.degToRad(1),a.degToRad(1)),["img/crate.png","img/webvr-logo1.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s1,i.CUBE,"toji cube",r(1,1,1,0),r(1,1,1,0),e.fromValues(5.5,1.5,-3),e.fromValues(0,0,0),e.fromValues(a.degToRad(40),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(0),a.degToRad(1),a.degToRad(0)),["img/webvr-logo2.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s1,i.TORUS,"torus2",r(1,1,.5,0),r(9,9,9,1),e.fromValues(-1.8,3,-3.5),e.fromValues(0,0,0),e.fromValues(a.degToRad(20),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(0),a.degToRad(1),a.degToRad(0)),["img/uv-test.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s1,i.CURVEDINNERPLANE,"CurvedPlaneBack",r(2,1,1,n.BACK,1),r(10,10,10),e.fromValues(-1,0,2),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(0),a.degToRad(.5),a.degToRad(0)),["img/webvr-logo2.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s1,i.CURVEDINNERPLANE,"CurvedPlaneLeft",r(2,1,1,n.LEFT,1),r(10,10,10),e.fromValues(-1,0,2),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(0),a.degToRad(.5),a.degToRad(0)),["img/webvr-logo3.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s1,i.CURVEDINNERPLANE,"CurvedPlaneRight",r(2,1,1,n.RIGHT,1),r(10,10,10),e.fromValues(-1,0,2),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(0),a.degToRad(.5),a.degToRad(0)),["img/webvr-logo4.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s1,i.CURVEDOUTERPLANE,"CurvedPlaneOut",r(2,1,1,n.RIGHT,1),e.fromValues(10,10,10),e.fromValues(-1.2,0,2),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(.2),a.degToRad(.5),a.degToRad(0)),["img/mozvr-logo2.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s1,i.ICOSPHERE,"icosphere",r(3,3,3,0),r(32,32,32),e.fromValues(4.5,3.5,-2),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(0),a.degToRad(.5),a.degToRad(0)),["img/uv-test.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s1,i.SKYICODOME,"icoSkyDome",r(3,3,3,0),r(32,32,32),e.fromValues(-4.5,.5,-2),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(0),a.degToRad(.5),a.degToRad(0)),["img/uv-test.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s1,i.BOTTOMICODOME,"bottomicodome",r(3,3,3,0),r(32,32,32),e.fromValues(4.5,.5,-2),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(0),a.degToRad(.5),a.degToRad(0)),["img/uv-test.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s1,i.CAP,"CAP",r(3,3,3,0),r(15,15,15),e.fromValues(-0,0,2),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(.2),a.degToRad(.5),a.degToRad(0)),["img/mozvr-logo1.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s1,i.CONE,"TestCone",r(1,1,1,0,0),r(10,10,10),e.fromValues(-0,-1.5,2),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(.2),a.degToRad(.5),a.degToRad(0)),["img/uv-test.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s1,i.CYLINDER,"TestCylinder",r(1,1,1,.3,.7),r(40,40,40),e.fromValues(-1.5,-1.5,2),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(.2),a.degToRad(.5),a.degToRad(0)),["img/uv-test.png"],t.fromValues(.5,1,.2,1)),
this.primFactory.createPrim(this.s1,i.CAPSULE,"TestCapsule",r(.5,1,1),r(40,40,0),e.fromValues(-2,-1.5,2),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(.2),a.degToRad(.5),a.degToRad(0)),["img/uv-test.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s1,i.TEARDROP,"TestTearDrop",r(1,2,1),r(40,40,0),e.fromValues(-2,1.5,2),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(.2),a.degToRad(.5),a.degToRad(0)),["img/uv-test.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s1,i.DODECAHEDRON,"Dodecahedron",r(1,1,1),r(40,40,0),e.fromValues(-1,.5,3),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(.2),a.degToRad(.5),a.degToRad(0)),["img/crate.png"],t.fromValues(.5,1,.2,1),!0),this.primFactory.createPrim(this.s1,i.MESH,"capsule",r(1,1,1),r(40,40,0),e.fromValues(0,0,0),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(.2),a.degToRad(.5),a.degToRad(0)),["obj/capsule/capsule1.png"],t.fromValues(.5,1,.2,1),!0,["obj/capsule/capsule.obj"]),this.primFactory.createPrim(this.s1,i.MESH,"objfile",r(1,1,1),r(40,40,0),e.fromValues(1,1,-2),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(.2),a.degToRad(.5),a.degToRad(0)),"",t.fromValues(.5,1,.2,1),!0,["obj/landscape/landscape.obj"]),this.primFactory.createPrim(this.s2,i.CUBE,"colored cube",r(1,1,1,0),r(3,3,3),e.fromValues(.2,.5,1),e.fromValues(0,0,0),e.fromValues(a.degToRad(20),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(0),a.degToRad(1),a.degToRad(0)),["img/webvr-logo3.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s2,i.MESH,"teapot",r(1,1,1),r(40,40,0),e.fromValues(0,1,2),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(.2),a.degToRad(.5),a.degToRad(0)),[],t.fromValues(.5,1,.2,1),!1,["obj/teapot/teapot.obj"]),this.primFactory.createPrim(this.s3,i.CUBE,"lit cube",r(1,1,1,0),r(1,1,1),e.fromValues(-3,-2,-3),e.fromValues(0,0,0),e.fromValues(a.degToRad(20),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(0),a.degToRad(1),a.degToRad(0)),["img/webvr-logo4.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s3,i.TERRAIN,"terrain",r(2,2,44,n.TOP,.1),r(100,100,100),e.fromValues(1.5,-1.5,2),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(1),a.degToRad(0),a.degToRad(0)),["img/mozvr-logo1.png"],t.fromValues(.5,1,.2,1),null),this.primFactory.createPrim(this.s3,i.CURVEDINNERPLANE,"CurvedPlaneFront",r(2,1,1,n.FRONT,1),r(10,10,10),e.fromValues(-1,0,2),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(0),a.degToRad(.5),a.degToRad(0)),["img/webvr-logo1.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s3,i.SPHERE,"texsphere",r(1.5,1.5,1.5,0),r(6,6,6),e.fromValues(-0,-1,3.5),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(0),a.degToRad(.5),a.degToRad(0)),["img/mozvr-logo1.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s3,i.CUBESPHERE,"cubesphere",r(3,3,3),r(10,10,10,0),e.fromValues(3,-.7,-1),e.fromValues(0,0,0),e.fromValues(a.degToRad(10),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(0),a.degToRad(.5),a.degToRad(0)),["img/mozvr-logo1.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s3,i.REGULARTETRAHEDRON,"regulartetrahedron",r(3,3,3,0),r(18,18,18),e.fromValues(6.7,1.5,-4),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(0),a.degToRad(.5),a.degToRad(0)),["img/mozvr-logo2.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s3,i.ICOSOHEDRON,"icosohedron",r(3,3,3,0),r(18,18,18),e.fromValues(.5,3.5,-2),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(0),a.degToRad(.5),a.degToRad(0)),["img/mozvr-logo2.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s3,i.BOTTOMDOME,"TestDome",r(1,1,1,0),r(10,10,10),e.fromValues(-4,.5,-.5),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(.2),a.degToRad(.5),a.degToRad(0)),["img/mozvr-logo2.png"],t.fromValues(.5,1,.2,1)),this.primFactory.createPrim(this.s3,i.TORUS,"TORUS1",r(1,1,.5,0),r(15,15,15),e.fromValues(-0,0,2),e.fromValues(0,0,0),e.fromValues(a.degToRad(0),a.degToRad(0),a.degToRad(0)),e.fromValues(a.degToRad(.2),a.degToRad(.5),a.degToRad(0)),["img/mozvr-logo1.png"],t.fromValues(.5,1,.2,1)),this.r1=this.s1.init(),this.r2=this.s2.init(),this.r3=this.s3.init(),this.render()}},{key:"initFromFile",value:function(e){if(e){var t=this.modelPool.modelMimeTypes[this.util.getFileExtension(e)];t&&this.doRequest(e,i,function(e){e.data||console.error("ModelPool::getModels(): no data found for:"+e.path)},cacheBust,t,0)}}},{key:"create",value:function(){}},{key:"update",value:function(){var e=performance.now();e-this.last;this.last=e,this.counter++,this.counter>300&&(this.counter=0)}},{key:"render",value:function(){this.update(),this.webgl.clear();var e=this.vr,t=e.getDisplay();if(t&&t.isPresenting){var r=this.vr.getFrameData();this.r3.renderVR(e,t,r),this.r2.renderVR(e,t,r),this.r1.renderVR(e,t,r),t.submitFrame(),t.requestAnimationFrame(this.render)}else this.r3.renderMono(),this.r2.renderMono(),this.r1.renderMono(),requestAnimationFrame(this.render)}}]),t}(c.default);t.default=p},function(e,t,r){t.glMatrix=r(1),t.mat2=r(34),t.mat2d=r(35),t.mat3=r(14),t.mat4=r(36),t.quat=r(37),t.vec2=r(38),t.vec3=r(15),t.vec4=r(16)},function(e,t,r){var i=r(1),n={};n.create=function(){var e=new i.ARRAY_TYPE(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},n.clone=function(e){var t=new i.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},n.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},n.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},n.fromValues=function(e,t,r,n){var a=new i.ARRAY_TYPE(4);return a[0]=e,a[1]=t,a[2]=r,a[3]=n,a},n.set=function(e,t,r,i,n){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e},n.transpose=function(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},n.invert=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=r*a-n*i;return o?(o=1/o,e[0]=a*o,e[1]=-i*o,e[2]=-n*o,e[3]=r*o,e):null},n.adjoint=function(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e},n.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},n.multiply=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=r[0],u=r[1],l=r[2],c=r[3];return e[0]=i*s+a*u,e[1]=n*s+o*u,e[2]=i*l+a*c,e[3]=n*l+o*c,e},n.mul=n.multiply,n.rotate=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=i*u+a*s,e[1]=n*u+o*s,e[2]=i*-s+a*u,e[3]=n*-s+o*u,e},n.scale=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=r[0],u=r[1];return e[0]=i*s,e[1]=n*s,e[2]=a*u,e[3]=o*u,e},n.fromRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=-r,e[3]=i,e},n.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},n.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},n.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},n.LDU=function(e,t,r,i){return e[2]=i[2]/i[0],r[0]=i[0],r[1]=i[1],r[3]=i[3]-e[2]*r[1],[e,t,r]},n.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},n.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e},n.sub=n.subtract,n.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},n.equals=function(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=t[0],u=t[1],l=t[2],c=t[3];return Math.abs(r-s)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-u)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(a-l)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(o-c)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))},n.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},n.multiplyScalarAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e},e.exports=n},function(e,t,r){var i=r(1),n={};n.create=function(){var e=new i.ARRAY_TYPE(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},n.clone=function(e){var t=new i.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},n.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},n.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},n.fromValues=function(e,t,r,n,a,o){var s=new i.ARRAY_TYPE(6);return s[0]=e,s[1]=t,s[2]=r,s[3]=n,s[4]=a,s[5]=o,s},n.set=function(e,t,r,i,n,a,o){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=a,e[5]=o,e},n.invert=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],u=r*a-i*n;return u?(u=1/u,e[0]=a*u,e[1]=-i*u,e[2]=-n*u,e[3]=r*u,e[4]=(n*s-a*o)*u,e[5]=(i*o-r*s)*u,e):null},n.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},n.multiply=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=r[0],c=r[1],h=r[2],M=r[3],d=r[4],f=r[5];return e[0]=i*l+a*c,e[1]=n*l+o*c,e[2]=i*h+a*M,e[3]=n*h+o*M,e[4]=i*d+a*f+s,e[5]=n*d+o*f+u,e},n.mul=n.multiply,n.rotate=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=Math.sin(r),c=Math.cos(r);return e[0]=i*c+a*l,e[1]=n*c+o*l,e[2]=i*-l+a*c,e[3]=n*-l+o*c,e[4]=s,e[5]=u,e},n.scale=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=r[0],c=r[1];return e[0]=i*l,e[1]=n*l,e[2]=a*c,e[3]=o*c,e[4]=s,e[5]=u,e},n.translate=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=r[0],c=r[1];return e[0]=i,e[1]=n,e[2]=a,e[3]=o,e[4]=i*l+a*c+s,e[5]=n*l+o*c+u,e},n.fromRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=-r,e[3]=i,e[4]=0,e[5]=0,e},n.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},n.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},n.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},n.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},n.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e},n.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e},n.sub=n.subtract,n.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e},n.multiplyScalarAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e},n.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},n.equals=function(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=t[0],c=t[1],h=t[2],M=t[3],d=t[4],f=t[5];return Math.abs(r-l)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(n-c)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(a-h)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(o-M)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(s-d)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(u-f)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(f))},e.exports=n},function(e,t,r){var i=r(1),n={scalar:{},SIMD:{}};n.create=function(){var e=new i.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},n.clone=function(e){var t=new i.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},n.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},n.fromValues=function(e,t,r,n,a,o,s,u,l,c,h,M,d,f,m,g){var y=new i.ARRAY_TYPE(16);return y[0]=e,y[1]=t,y[2]=r,y[3]=n,y[4]=a,y[5]=o,y[6]=s,y[7]=u,y[8]=l,y[9]=c,y[10]=h,y[11]=M,y[12]=d,y[13]=f,y[14]=m,y[15]=g,y},n.set=function(e,t,r,i,n,a,o,s,u,l,c,h,M,d,f,m,g){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=a,e[5]=o,e[6]=s,e[7]=u,e[8]=l,e[9]=c,e[10]=h,e[11]=M,e[12]=d,e[13]=f,e[14]=m,e[15]=g,e},n.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},n.scalar.transpose=function(e,t){if(e===t){var r=t[1],i=t[2],n=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=a,e[11]=t[14],e[12]=n,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},n.SIMD.transpose=function(e,t){var r,i,n,a,o,s,u,l,c,h;return r=SIMD.Float32x4.load(t,0),i=SIMD.Float32x4.load(t,4),n=SIMD.Float32x4.load(t,8),a=SIMD.Float32x4.load(t,12),o=SIMD.Float32x4.shuffle(r,i,0,1,4,5),s=SIMD.Float32x4.shuffle(n,a,0,1,4,5),u=SIMD.Float32x4.shuffle(o,s,0,2,4,6),l=SIMD.Float32x4.shuffle(o,s,1,3,5,7),SIMD.Float32x4.store(e,0,u),SIMD.Float32x4.store(e,4,l),o=SIMD.Float32x4.shuffle(r,i,2,3,6,7),s=SIMD.Float32x4.shuffle(n,a,2,3,6,7),c=SIMD.Float32x4.shuffle(o,s,0,2,4,6),h=SIMD.Float32x4.shuffle(o,s,1,3,5,7),SIMD.Float32x4.store(e,8,c),SIMD.Float32x4.store(e,12,h),e},n.transpose=i.USE_SIMD?n.SIMD.transpose:n.scalar.transpose,n.scalar.invert=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],h=t[9],M=t[10],d=t[11],f=t[12],m=t[13],g=t[14],y=t[15],L=r*s-i*o,v=r*u-n*o,I=r*l-a*o,x=i*u-n*s,T=i*l-a*s,p=n*l-a*u,w=c*m-h*f,S=c*g-M*f,D=c*y-d*f,b=h*g-M*m,N=h*y-d*m,E=M*y-d*g,j=L*E-v*N+I*b+x*D-T*S+p*w;return j?(j=1/j,e[0]=(s*E-u*N+l*b)*j,e[1]=(n*N-i*E-a*b)*j,e[2]=(m*p-g*T+y*x)*j,e[3]=(M*T-h*p-d*x)*j,e[4]=(u*D-o*E-l*S)*j,e[5]=(r*E-n*D+a*S)*j,e[6]=(g*I-f*p-y*v)*j,e[7]=(c*p-M*I+d*v)*j,e[8]=(o*N-s*D+l*w)*j,e[9]=(i*D-r*N-a*w)*j,e[10]=(f*T-m*I+y*L)*j,e[11]=(h*I-c*T-d*L)*j,e[12]=(s*S-o*b-u*w)*j,e[13]=(r*b-i*S+n*w)*j,e[14]=(m*v-f*x-g*L)*j,e[15]=(c*x-h*v+M*L)*j,e):null},n.SIMD.invert=function(e,t){var r,i,n,a,o,s,u,l,c,h,M=SIMD.Float32x4.load(t,0),d=SIMD.Float32x4.load(t,4),f=SIMD.Float32x4.load(t,8),m=SIMD.Float32x4.load(t,12);return o=SIMD.Float32x4.shuffle(M,d,0,1,4,5),i=SIMD.Float32x4.shuffle(f,m,0,1,4,5),r=SIMD.Float32x4.shuffle(o,i,0,2,4,6),i=SIMD.Float32x4.shuffle(i,o,1,3,5,7),o=SIMD.Float32x4.shuffle(M,d,2,3,6,7),a=SIMD.Float32x4.shuffle(f,m,2,3,6,7),n=SIMD.Float32x4.shuffle(o,a,0,2,4,6),a=SIMD.Float32x4.shuffle(a,o,1,3,5,7),o=SIMD.Float32x4.mul(n,a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),s=SIMD.Float32x4.mul(i,o),u=SIMD.Float32x4.mul(r,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,o),s),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),o=SIMD.Float32x4.mul(i,n),o=SIMD.Float32x4.swizzle(o,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),s),c=SIMD.Float32x4.mul(r,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(a,o)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),o=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(i,2,3,0,1),a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),n=SIMD.Float32x4.swizzle(n,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,o),s),l=SIMD.Float32x4.mul(r,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(n,o)),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),o=SIMD.Float32x4.mul(r,i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),l),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,o),c),o=SIMD.Float32x4.swizzle(o,2,3,0,1),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,o),l),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(n,o)),o=SIMD.Float32x4.mul(r,a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(n,o)),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),l),o=SIMD.Float32x4.swizzle(o,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,o),u),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(i,o)),o=SIMD.Float32x4.mul(r,n),o=SIMD.Float32x4.swizzle(o,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),u),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(i,o)),o=SIMD.Float32x4.swizzle(o,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(a,o)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),c),h=SIMD.Float32x4.mul(r,s),h=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(h,2,3,0,1),h),h=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(h,1,0,3,2),h),o=SIMD.Float32x4.reciprocalApproximation(h),h=SIMD.Float32x4.sub(SIMD.Float32x4.add(o,o),SIMD.Float32x4.mul(h,SIMD.Float32x4.mul(o,o))),(h=SIMD.Float32x4.swizzle(h,0,0,0,0))?(SIMD.Float32x4.store(e,0,SIMD.Float32x4.mul(h,s)),SIMD.Float32x4.store(e,4,SIMD.Float32x4.mul(h,u)),SIMD.Float32x4.store(e,8,SIMD.Float32x4.mul(h,l)),SIMD.Float32x4.store(e,12,SIMD.Float32x4.mul(h,c)),e):null},n.invert=i.USE_SIMD?n.SIMD.invert:n.scalar.invert,n.scalar.adjoint=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],h=t[9],M=t[10],d=t[11],f=t[12],m=t[13],g=t[14],y=t[15];return e[0]=s*(M*y-d*g)-h*(u*y-l*g)+m*(u*d-l*M),e[1]=-(i*(M*y-d*g)-h*(n*y-a*g)+m*(n*d-a*M)),e[2]=i*(u*y-l*g)-s*(n*y-a*g)+m*(n*l-a*u),e[3]=-(i*(u*d-l*M)-s*(n*d-a*M)+h*(n*l-a*u)),e[4]=-(o*(M*y-d*g)-c*(u*y-l*g)+f*(u*d-l*M)),e[5]=r*(M*y-d*g)-c*(n*y-a*g)+f*(n*d-a*M),e[6]=-(r*(u*y-l*g)-o*(n*y-a*g)+f*(n*l-a*u)),e[7]=r*(u*d-l*M)-o*(n*d-a*M)+c*(n*l-a*u),e[8]=o*(h*y-d*m)-c*(s*y-l*m)+f*(s*d-l*h),e[9]=-(r*(h*y-d*m)-c*(i*y-a*m)+f*(i*d-a*h)),e[10]=r*(s*y-l*m)-o*(i*y-a*m)+f*(i*l-a*s),e[11]=-(r*(s*d-l*h)-o*(i*d-a*h)+c*(i*l-a*s)),e[12]=-(o*(h*g-M*m)-c*(s*g-u*m)+f*(s*M-u*h)),e[13]=r*(h*g-M*m)-c*(i*g-n*m)+f*(i*M-n*h),e[14]=-(r*(s*g-u*m)-o*(i*g-n*m)+f*(i*u-n*s)),e[15]=r*(s*M-u*h)-o*(i*M-n*h)+c*(i*u-n*s),e},n.SIMD.adjoint=function(e,t){var r,i,n,a,o,s,u,l,c,h,M,d,f,r=SIMD.Float32x4.load(t,0),i=SIMD.Float32x4.load(t,4),n=SIMD.Float32x4.load(t,8),a=SIMD.Float32x4.load(t,12);return c=SIMD.Float32x4.shuffle(r,i,0,1,4,5),s=SIMD.Float32x4.shuffle(n,a,0,1,4,5),o=SIMD.Float32x4.shuffle(c,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,c,1,3,5,7),c=SIMD.Float32x4.shuffle(r,i,2,3,6,7),l=SIMD.Float32x4.shuffle(n,a,2,3,6,7),u=SIMD.Float32x4.shuffle(c,l,0,2,4,6),l=SIMD.Float32x4.shuffle(l,c,1,3,5,7),c=SIMD.Float32x4.mul(u,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.mul(s,c),M=SIMD.Float32x4.mul(o,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),h),M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,c),M),M=SIMD.Float32x4.swizzle(M,2,3,0,1),c=SIMD.Float32x4.mul(s,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),h),f=SIMD.Float32x4.mul(o,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(l,c)),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,c),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),c=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,3,0,1),l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),u=SIMD.Float32x4.swizzle(u,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),h),d=SIMD.Float32x4.mul(o,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(u,c)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,c),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),c=SIMD.Float32x4.mul(o,s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),d),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,c),f),c=SIMD.Float32x4.swizzle(c,2,3,0,1),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,c),d),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(u,c)),c=SIMD.Float32x4.mul(o,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(u,c)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),d),c=SIMD.Float32x4.swizzle(c,2,3,0,1),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),M),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(s,c)),c=SIMD.Float32x4.mul(o,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),M),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(s,c)),c=SIMD.Float32x4.swizzle(c,2,3,0,1),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(l,c)),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),f),SIMD.Float32x4.store(e,0,h),SIMD.Float32x4.store(e,4,M),SIMD.Float32x4.store(e,8,d),SIMD.Float32x4.store(e,12,f),e},n.adjoint=i.USE_SIMD?n.SIMD.adjoint:n.scalar.adjoint,n.determinant=function(e){var t=e[0],r=e[1],i=e[2],n=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8],c=e[9],h=e[10],M=e[11],d=e[12],f=e[13],m=e[14],g=e[15],y=t*o-r*a,L=t*s-i*a,v=t*u-n*a,I=r*s-i*o,x=r*u-n*o,T=i*u-n*s,p=l*f-c*d,w=l*m-h*d,S=l*g-M*d,D=c*m-h*f,b=c*g-M*f,N=h*g-M*m;return y*N-L*b+v*D+I*S-x*w+T*p},n.SIMD.multiply=function(e,t,r){var i=SIMD.Float32x4.load(t,0),n=SIMD.Float32x4.load(t,4),a=SIMD.Float32x4.load(t,8),o=SIMD.Float32x4.load(t,12),s=SIMD.Float32x4.load(r,0),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),a),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),o))));SIMD.Float32x4.store(e,0,u);var l=SIMD.Float32x4.load(r,4),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,0,0,0,0),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,2,2,2,2),a),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,3,3,3,3),o))));SIMD.Float32x4.store(e,4,c);var h=SIMD.Float32x4.load(r,8),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),a),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),o))));SIMD.Float32x4.store(e,8,M);var d=SIMD.Float32x4.load(r,12),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,0,0,0,0),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,2,2,2),a),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,3,3,3,3),o))));return SIMD.Float32x4.store(e,12,f),e},n.scalar.multiply=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],M=t[9],d=t[10],f=t[11],m=t[12],g=t[13],y=t[14],L=t[15],v=r[0],I=r[1],x=r[2],T=r[3];return e[0]=v*i+I*s+x*h+T*m,e[1]=v*n+I*u+x*M+T*g,e[2]=v*a+I*l+x*d+T*y,e[3]=v*o+I*c+x*f+T*L,v=r[4],I=r[5],x=r[6],T=r[7],e[4]=v*i+I*s+x*h+T*m,e[5]=v*n+I*u+x*M+T*g,e[6]=v*a+I*l+x*d+T*y,e[7]=v*o+I*c+x*f+T*L,v=r[8],I=r[9],x=r[10],T=r[11],e[8]=v*i+I*s+x*h+T*m,e[9]=v*n+I*u+x*M+T*g,e[10]=v*a+I*l+x*d+T*y,e[11]=v*o+I*c+x*f+T*L,v=r[12],I=r[13],x=r[14],T=r[15],e[12]=v*i+I*s+x*h+T*m,e[13]=v*n+I*u+x*M+T*g,e[14]=v*a+I*l+x*d+T*y,e[15]=v*o+I*c+x*f+T*L,e},n.multiply=i.USE_SIMD?n.SIMD.multiply:n.scalar.multiply,n.mul=n.multiply,n.scalar.translate=function(e,t,r){var i,n,a,o,s,u,l,c,h,M,d,f,m=r[0],g=r[1],y=r[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*y+t[12],e[13]=t[1]*m+t[5]*g+t[9]*y+t[13],e[14]=t[2]*m+t[6]*g+t[10]*y+t[14],e[15]=t[3]*m+t[7]*g+t[11]*y+t[15]):(i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],M=t[9],d=t[10],f=t[11],e[0]=i,e[1]=n,e[2]=a,e[3]=o,e[4]=s,e[5]=u,e[6]=l,e[7]=c,e[8]=h,e[9]=M,e[10]=d,e[11]=f,e[12]=i*m+s*g+h*y+t[12],e[13]=n*m+u*g+M*y+t[13],e[14]=a*m+l*g+d*y+t[14],e[15]=o*m+c*g+f*y+t[15]),e},n.SIMD.translate=function(e,t,r){var i=SIMD.Float32x4.load(t,0),n=SIMD.Float32x4.load(t,4),a=SIMD.Float32x4.load(t,8),o=SIMD.Float32x4.load(t,12),s=SIMD.Float32x4(r[0],r[1],r[2],0);t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11]),i=SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(s,0,0,0,0)),n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(s,1,1,1,1)),a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(s,2,2,2,2));var u=SIMD.Float32x4.add(i,SIMD.Float32x4.add(n,SIMD.Float32x4.add(a,o)));return SIMD.Float32x4.store(e,12,u),e},n.translate=i.USE_SIMD?n.SIMD.translate:n.scalar.translate,n.scalar.scale=function(e,t,r){var i=r[0],n=r[1],a=r[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},n.SIMD.scale=function(e,t,r){var i,n,a,o=SIMD.Float32x4(r[0],r[1],r[2],0);return i=SIMD.Float32x4.load(t,0),SIMD.Float32x4.store(e,0,SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(o,0,0,0,0))),n=SIMD.Float32x4.load(t,4),SIMD.Float32x4.store(e,4,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(o,1,1,1,1))),a=SIMD.Float32x4.load(t,8),SIMD.Float32x4.store(e,8,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(o,2,2,2,2))),e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},n.scale=i.USE_SIMD?n.SIMD.scale:n.scalar.scale,n.rotate=function(e,t,r,n){var a,o,s,u,l,c,h,M,d,f,m,g,y,L,v,I,x,T,p,w,S,D,b,N,E=n[0],j=n[1],A=n[2],z=Math.sqrt(E*E+j*j+A*A);return Math.abs(z)<i.EPSILON?null:(z=1/z,E*=z,j*=z,A*=z,a=Math.sin(r),o=Math.cos(r),s=1-o,u=t[0],l=t[1],c=t[2],h=t[3],M=t[4],d=t[5],f=t[6],m=t[7],g=t[8],y=t[9],L=t[10],v=t[11],I=E*E*s+o,x=j*E*s+A*a,T=A*E*s-j*a,p=E*j*s-A*a,w=j*j*s+o,S=A*j*s+E*a,D=E*A*s+j*a,b=j*A*s-E*a,N=A*A*s+o,e[0]=u*I+M*x+g*T,e[1]=l*I+d*x+y*T,e[2]=c*I+f*x+L*T,e[3]=h*I+m*x+v*T,e[4]=u*p+M*w+g*S,e[5]=l*p+d*w+y*S,e[6]=c*p+f*w+L*S,e[7]=h*p+m*w+v*S,e[8]=u*D+M*b+g*N,e[9]=l*D+d*b+y*N,e[10]=c*D+f*b+L*N,e[11]=h*D+m*b+v*N,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},n.scalar.rotateX=function(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[4],o=t[5],s=t[6],u=t[7],l=t[8],c=t[9],h=t[10],M=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*n+l*i,e[5]=o*n+c*i,e[6]=s*n+h*i,e[7]=u*n+M*i,e[8]=l*n-a*i,e[9]=c*n-o*i,e[10]=h*n-s*i,e[11]=M*n-u*i,e},n.SIMD.rotateX=function(e,t,r){var i=SIMD.Float32x4.splat(Math.sin(r)),n=SIMD.Float32x4.splat(Math.cos(r));t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var a=SIMD.Float32x4.load(t,4),o=SIMD.Float32x4.load(t,8);return SIMD.Float32x4.store(e,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(a,n),SIMD.Float32x4.mul(o,i))),SIMD.Float32x4.store(e,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(a,i))),e},n.rotateX=i.USE_SIMD?n.SIMD.rotateX:n.scalar.rotateX,n.scalar.rotateY=function(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[0],o=t[1],s=t[2],u=t[3],l=t[8],c=t[9],h=t[10],M=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*n-l*i,e[1]=o*n-c*i,e[2]=s*n-h*i,e[3]=u*n-M*i,e[8]=a*i+l*n,e[9]=o*i+c*n,e[10]=s*i+h*n,e[11]=u*i+M*n,e},n.SIMD.rotateY=function(e,t,r){var i=SIMD.Float32x4.splat(Math.sin(r)),n=SIMD.Float32x4.splat(Math.cos(r));t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var a=SIMD.Float32x4.load(t,0),o=SIMD.Float32x4.load(t,8);return SIMD.Float32x4.store(e,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,n),SIMD.Float32x4.mul(o,i))),SIMD.Float32x4.store(e,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),SIMD.Float32x4.mul(o,n))),e},n.rotateY=i.USE_SIMD?n.SIMD.rotateY:n.scalar.rotateY,n.scalar.rotateZ=function(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[0],o=t[1],s=t[2],u=t[3],l=t[4],c=t[5],h=t[6],M=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*n+l*i,e[1]=o*n+c*i,e[2]=s*n+h*i,e[3]=u*n+M*i,e[4]=l*n-a*i,e[5]=c*n-o*i,e[6]=h*n-s*i,e[7]=M*n-u*i,e},n.SIMD.rotateZ=function(e,t,r){var i=SIMD.Float32x4.splat(Math.sin(r)),n=SIMD.Float32x4.splat(Math.cos(r));t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);var a=SIMD.Float32x4.load(t,0),o=SIMD.Float32x4.load(t,4);return SIMD.Float32x4.store(e,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(a,n),SIMD.Float32x4.mul(o,i))),SIMD.Float32x4.store(e,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(a,i))),e},n.rotateZ=i.USE_SIMD?n.SIMD.rotateZ:n.scalar.rotateZ,n.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},n.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},n.fromRotation=function(e,t,r){var n,a,o,s=r[0],u=r[1],l=r[2],c=Math.sqrt(s*s+u*u+l*l);return Math.abs(c)<i.EPSILON?null:(c=1/c,s*=c,u*=c,l*=c,n=Math.sin(t),a=Math.cos(t),o=1-a,e[0]=s*s*o+a,e[1]=u*s*o+l*n,e[2]=l*s*o-u*n,e[3]=0,e[4]=s*u*o-l*n,e[5]=u*u*o+a,e[6]=l*u*o+s*n,e[7]=0,e[8]=s*l*o+u*n,e[9]=u*l*o-s*n,e[10]=l*l*o+a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},n.fromXRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},n.fromYRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},n.fromZRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},n.fromRotationTranslation=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=i+i,u=n+n,l=a+a,c=i*s,h=i*u,M=i*l,d=n*u,f=n*l,m=a*l,g=o*s,y=o*u,L=o*l;return e[0]=1-(d+m),e[1]=h+L,e[2]=M-y,e[3]=0,e[4]=h-L,e[5]=1-(c+m),e[6]=f+g,e[7]=0,e[8]=M+y,e[9]=f-g,e[10]=1-(c+d),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},n.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},n.getRotation=function(e,t){var r=t[0]+t[5]+t[10],i=0;return r>0?(i=2*Math.sqrt(r+1),e[3]=.25*i,e[0]=(t[6]-t[9])/i,e[1]=(t[8]-t[2])/i,e[2]=(t[1]-t[4])/i):t[0]>t[5]&t[0]>t[10]?(i=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/i,e[0]=.25*i,e[1]=(t[1]+t[4])/i,e[2]=(t[8]+t[2])/i):t[5]>t[10]?(i=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/i,e[0]=(t[1]+t[4])/i,e[1]=.25*i,e[2]=(t[6]+t[9])/i):(i=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/i,e[0]=(t[8]+t[2])/i,e[1]=(t[6]+t[9])/i,e[2]=.25*i),e},n.fromRotationTranslationScale=function(e,t,r,i){var n=t[0],a=t[1],o=t[2],s=t[3],u=n+n,l=a+a,c=o+o,h=n*u,M=n*l,d=n*c,f=a*l,m=a*c,g=o*c,y=s*u,L=s*l,v=s*c,I=i[0],x=i[1],T=i[2];return e[0]=(1-(f+g))*I,e[1]=(M+v)*I,e[2]=(d-L)*I,e[3]=0,e[4]=(M-v)*x,e[5]=(1-(h+g))*x,e[6]=(m+y)*x,e[7]=0,e[8]=(d+L)*T,e[9]=(m-y)*T,e[10]=(1-(h+f))*T,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},n.fromRotationTranslationScaleOrigin=function(e,t,r,i,n){var a=t[0],o=t[1],s=t[2],u=t[3],l=a+a,c=o+o,h=s+s,M=a*l,d=a*c,f=a*h,m=o*c,g=o*h,y=s*h,L=u*l,v=u*c,I=u*h,x=i[0],T=i[1],p=i[2],w=n[0],S=n[1],D=n[2];return e[0]=(1-(m+y))*x,e[1]=(d+I)*x,e[2]=(f-v)*x,e[3]=0,e[4]=(d-I)*T,e[5]=(1-(M+y))*T,e[6]=(g+L)*T,e[7]=0,e[8]=(f+v)*p,e[9]=(g-L)*p,e[10]=(1-(M+m))*p,e[11]=0,e[12]=r[0]+w-(e[0]*w+e[4]*S+e[8]*D),e[13]=r[1]+S-(e[1]*w+e[5]*S+e[9]*D),e[14]=r[2]+D-(e[2]*w+e[6]*S+e[10]*D),e[15]=1,e},n.fromQuat=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=r+r,s=i+i,u=n+n,l=r*o,c=i*o,h=i*s,M=n*o,d=n*s,f=n*u,m=a*o,g=a*s,y=a*u;return e[0]=1-h-f,e[1]=c+y,e[2]=M-g,e[3]=0,e[4]=c-y,e[5]=1-l-f,e[6]=d+m,e[7]=0,e[8]=M+g,e[9]=d-m,e[10]=1-l-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},n.frustum=function(e,t,r,i,n,a,o){var s=1/(r-t),u=1/(n-i),l=1/(a-o);return e[0]=2*a*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*u,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(n+i)*u,e[10]=(o+a)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*l,e[15]=0,e},n.perspective=function(e,t,r,i,n){var a=1/Math.tan(t/2),o=1/(i-n);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(n+i)*o,e[11]=-1,
e[12]=0,e[13]=0,e[14]=2*n*i*o,e[15]=0,e},n.perspectiveFromFieldOfView=function(e,t,r,i){var n=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(o+s),l=2/(n+a);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-((o-s)*u*.5),e[9]=(n-a)*l*.5,e[10]=i/(r-i),e[11]=-1,e[12]=0,e[13]=0,e[14]=i*r/(r-i),e[15]=0,e},n.ortho=function(e,t,r,i,n,a,o){var s=1/(t-r),u=1/(i-n),l=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+r)*s,e[13]=(n+i)*u,e[14]=(o+a)*l,e[15]=1,e},n.lookAt=function(e,t,r,a){var o,s,u,l,c,h,M,d,f,m,g=t[0],y=t[1],L=t[2],v=a[0],I=a[1],x=a[2],T=r[0],p=r[1],w=r[2];return Math.abs(g-T)<i.EPSILON&&Math.abs(y-p)<i.EPSILON&&Math.abs(L-w)<i.EPSILON?n.identity(e):(M=g-T,d=y-p,f=L-w,m=1/Math.sqrt(M*M+d*d+f*f),M*=m,d*=m,f*=m,o=I*f-x*d,s=x*M-v*f,u=v*d-I*M,m=Math.sqrt(o*o+s*s+u*u),m?(m=1/m,o*=m,s*=m,u*=m):(o=0,s=0,u=0),l=d*u-f*s,c=f*o-M*u,h=M*s-d*o,m=Math.sqrt(l*l+c*c+h*h),m?(m=1/m,l*=m,c*=m,h*=m):(l=0,c=0,h=0),e[0]=o,e[1]=l,e[2]=M,e[3]=0,e[4]=s,e[5]=c,e[6]=d,e[7]=0,e[8]=u,e[9]=h,e[10]=f,e[11]=0,e[12]=-(o*g+s*y+u*L),e[13]=-(l*g+c*y+h*L),e[14]=-(M*g+d*y+f*L),e[15]=1,e)},n.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},n.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},n.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e},n.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e},n.sub=n.subtract,n.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e},n.multiplyScalarAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e[6]=t[6]+r[6]*i,e[7]=t[7]+r[7]*i,e[8]=t[8]+r[8]*i,e[9]=t[9]+r[9]*i,e[10]=t[10]+r[10]*i,e[11]=t[11]+r[11]*i,e[12]=t[12]+r[12]*i,e[13]=t[13]+r[13]*i,e[14]=t[14]+r[14]*i,e[15]=t[15]+r[15]*i,e},n.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},n.equals=function(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],M=e[9],d=e[10],f=e[11],m=e[12],g=e[13],y=e[14],L=e[15],v=t[0],I=t[1],x=t[2],T=t[3],p=t[4],w=t[5],S=t[6],D=t[7],b=t[8],N=t[9],E=t[10],j=t[11],A=t[12],z=t[13],P=t[14],C=t[15];return Math.abs(r-v)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(n-I)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(I))&&Math.abs(a-x)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(o-T)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(s-p)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(u-w)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(l-S)<=i.EPSILON*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(c-D)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(D))&&Math.abs(h-b)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(b))&&Math.abs(M-N)<=i.EPSILON*Math.max(1,Math.abs(M),Math.abs(N))&&Math.abs(d-E)<=i.EPSILON*Math.max(1,Math.abs(d),Math.abs(E))&&Math.abs(f-j)<=i.EPSILON*Math.max(1,Math.abs(f),Math.abs(j))&&Math.abs(m-A)<=i.EPSILON*Math.max(1,Math.abs(m),Math.abs(A))&&Math.abs(g-z)<=i.EPSILON*Math.max(1,Math.abs(g),Math.abs(z))&&Math.abs(y-P)<=i.EPSILON*Math.max(1,Math.abs(y),Math.abs(P))&&Math.abs(L-C)<=i.EPSILON*Math.max(1,Math.abs(L),Math.abs(C))},e.exports=n},function(e,t,r){var i=r(1),n=r(14),a=r(15),o=r(16),s={};s.create=function(){var e=new i.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},s.rotationTo=function(){var e=a.create(),t=a.fromValues(1,0,0),r=a.fromValues(0,1,0);return function(i,n,o){var u=a.dot(n,o);return u<-.999999?(a.cross(e,t,n),a.length(e)<1e-6&&a.cross(e,r,n),a.normalize(e,e),s.setAxisAngle(i,e,Math.PI),i):u>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(a.cross(e,n,o),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=1+u,s.normalize(i,i))}}(),s.setAxes=function(){var e=n.create();return function(t,r,i,n){return e[0]=i[0],e[3]=i[1],e[6]=i[2],e[1]=n[0],e[4]=n[1],e[7]=n[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],s.normalize(t,s.fromMat3(t,e))}}(),s.clone=o.clone,s.fromValues=o.fromValues,s.copy=o.copy,s.set=o.set,s.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},s.setAxisAngle=function(e,t,r){r*=.5;var i=Math.sin(r);return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=Math.cos(r),e},s.getAxisAngle=function(e,t){var r=2*Math.acos(t[3]),i=Math.sin(r/2);return 0!=i?(e[0]=t[0]/i,e[1]=t[1]/i,e[2]=t[2]/i):(e[0]=1,e[1]=0,e[2]=0),r},s.add=o.add,s.multiply=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=r[0],u=r[1],l=r[2],c=r[3];return e[0]=i*c+o*s+n*l-a*u,e[1]=n*c+o*u+a*s-i*l,e[2]=a*c+o*l+i*u-n*s,e[3]=o*c-i*s-n*u-a*l,e},s.mul=s.multiply,s.scale=o.scale,s.rotateX=function(e,t,r){r*=.5;var i=t[0],n=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=i*u+o*s,e[1]=n*u+a*s,e[2]=a*u-n*s,e[3]=o*u-i*s,e},s.rotateY=function(e,t,r){r*=.5;var i=t[0],n=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=i*u-a*s,e[1]=n*u+o*s,e[2]=a*u+i*s,e[3]=o*u-n*s,e},s.rotateZ=function(e,t,r){r*=.5;var i=t[0],n=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=i*u+n*s,e[1]=n*u-i*s,e[2]=a*u+o*s,e[3]=o*u-a*s,e},s.calculateW=function(e,t){var r=t[0],i=t[1],n=t[2];return e[0]=r,e[1]=i,e[2]=n,e[3]=Math.sqrt(Math.abs(1-r*r-i*i-n*n)),e},s.dot=o.dot,s.lerp=o.lerp,s.slerp=function(e,t,r,i){var n,a,o,s,u,l=t[0],c=t[1],h=t[2],M=t[3],d=r[0],f=r[1],m=r[2],g=r[3];return a=l*d+c*f+h*m+M*g,a<0&&(a=-a,d=-d,f=-f,m=-m,g=-g),1-a>1e-6?(n=Math.acos(a),o=Math.sin(n),s=Math.sin((1-i)*n)/o,u=Math.sin(i*n)/o):(s=1-i,u=i),e[0]=s*l+u*d,e[1]=s*c+u*f,e[2]=s*h+u*m,e[3]=s*M+u*g,e},s.sqlerp=function(){var e=s.create(),t=s.create();return function(r,i,n,a,o,u){return s.slerp(e,i,o,u),s.slerp(t,n,a,u),s.slerp(r,e,t,2*u*(1-u)),r}}(),s.invert=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=r*r+i*i+n*n+a*a,s=o?1/o:0;return e[0]=-r*s,e[1]=-i*s,e[2]=-n*s,e[3]=a*s,e},s.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},s.length=o.length,s.len=s.length,s.squaredLength=o.squaredLength,s.sqrLen=s.squaredLength,s.normalize=o.normalize,s.fromMat3=function(e,t){var r,i=t[0]+t[4]+t[8];if(i>0)r=Math.sqrt(i+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var n=0;t[4]>t[0]&&(n=1),t[8]>t[3*n+n]&&(n=2);var a=(n+1)%3,o=(n+2)%3;r=Math.sqrt(t[3*n+n]-t[3*a+a]-t[3*o+o]+1),e[n]=.5*r,r=.5/r,e[3]=(t[3*a+o]-t[3*o+a])*r,e[a]=(t[3*a+n]+t[3*n+a])*r,e[o]=(t[3*o+n]+t[3*n+o])*r}return e},s.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},s.exactEquals=o.exactEquals,s.equals=o.equals,e.exports=s},function(e,t,r){var i=r(1),n={};n.create=function(){var e=new i.ARRAY_TYPE(2);return e[0]=0,e[1]=0,e},n.clone=function(e){var t=new i.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},n.fromValues=function(e,t){var r=new i.ARRAY_TYPE(2);return r[0]=e,r[1]=t,r},n.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},n.set=function(e,t,r){return e[0]=t,e[1]=r,e},n.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e},n.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e},n.sub=n.subtract,n.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e},n.mul=n.multiply,n.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e},n.div=n.divide,n.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},n.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},n.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e},n.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e},n.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},n.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e},n.scaleAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e},n.distance=function(e,t){var r=t[0]-e[0],i=t[1]-e[1];return Math.sqrt(r*r+i*i)},n.dist=n.distance,n.squaredDistance=function(e,t){var r=t[0]-e[0],i=t[1]-e[1];return r*r+i*i},n.sqrDist=n.squaredDistance,n.length=function(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)},n.len=n.length,n.squaredLength=function(e){var t=e[0],r=e[1];return t*t+r*r},n.sqrLen=n.squaredLength,n.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},n.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},n.normalize=function(e,t){var r=t[0],i=t[1],n=r*r+i*i;return n>0&&(n=1/Math.sqrt(n),e[0]=t[0]*n,e[1]=t[1]*n),e},n.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},n.cross=function(e,t,r){var i=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=i,e},n.lerp=function(e,t,r,i){var n=t[0],a=t[1];return e[0]=n+i*(r[0]-n),e[1]=a+i*(r[1]-a),e},n.random=function(e,t){t=t||1;var r=2*i.RANDOM()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e},n.transformMat2=function(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n,e[1]=r[1]*i+r[3]*n,e},n.transformMat2d=function(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n+r[4],e[1]=r[1]*i+r[3]*n+r[5],e},n.transformMat3=function(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[3]*n+r[6],e[1]=r[1]*i+r[4]*n+r[7],e},n.transformMat4=function(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[4]*n+r[12],e[1]=r[1]*i+r[5]*n+r[13],e},n.forEach=function(){var e=n.create();return function(t,r,i,n,a,o){var s,u;for(r||(r=2),i||(i=0),u=n?Math.min(n*r+i,t.length):t.length,s=i;s<u;s+=r)e[0]=t[s],e[1]=t[s+1],a(e,e,o),t[s]=e[0],t[s+1]=e[1];return t}}(),n.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},n.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},n.equals=function(e,t){var r=e[0],n=e[1],a=t[0],o=t[1];return Math.abs(r-a)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))},e.exports=n},function(e,t){function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function n(e){if(c===setTimeout)return setTimeout(e,0);if((c===r||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function a(e){if(h===clearTimeout)return clearTimeout(e);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function o(){m&&d&&(m=!1,d.length?f=d.concat(f):g=-1,f.length&&s())}function s(){if(!m){var e=n(o);m=!0;for(var t=f.length;t;){for(d=f,f=[];++g<t;)d&&d[g].run();g=-1,t=f.length}d=null,m=!1,a(e)}}function u(e,t){this.fun=e,this.array=t}function l(){}var c,h,M=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:r}catch(e){c=r}try{h="function"==typeof clearTimeout?clearTimeout:i}catch(e){h=i}}();var d,f=[],m=!1,g=-1;M.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];f.push(new u(e,t)),1!==f.length||m||n(s)},u.prototype.run=function(){this.fun.apply(null,this.array)},M.title="browser",M.browser=!0,M.env={},M.argv=[],M.version="",M.versions={},M.on=l,M.addListener=l,M.once=l,M.off=l,M.removeListener=l,M.removeAllListeners=l,M.emit=l,M.binding=function(e){throw new Error("process.binding is not supported")},M.cwd=function(){return"/"},M.chdir=function(e){throw new Error("process.chdir is not supported")},M.umask=function(){return 0}},function(e,t){(function(t){WebGLDebugUtils=function(){function e(e){if(null==f){f={},m={};for(var t in e)"number"==typeof e[t]&&(f[e[t]]=t,m[t]=e[t])}}function r(){if(null==f)throw"WebGLDebugUtils.init(ctx) not called"}function i(e){return r(),void 0!==f[e]}function n(e){r();var t=f[e];return void 0!==t?"gl."+t:"/*UNKNOWN WebGL ENUM*/ 0x"+e.toString(16)}function a(e,t,r,i){var a=d[e];if(void 0!==a){var a=a[t];if(void 0!==a&&a[r]){if("object"==typeof a[r]&&void 0!==a[r].enumBitwiseOr){for(var o=a[r].enumBitwiseOr,s=0,u=[],l=0;l<o.length;++l){var c=m[o[l]];0!==(i&c)&&(s|=c,u.push(n(c)))}return s===i?u.join(" | "):n(i)}return n(i)}}return null===i?"null":void 0===i?"undefined":i.toString()}function o(e,t){for(var r="",i=t.length,n=0;n<i;++n)r+=(0==n?"":", ")+a(e,i,n,t[n]);return r}function s(e,t,r){e.__defineGetter__(r,function(){return t[r]}),e.__defineSetter__(r,function(e){t[r]=e})}function u(t,r,i,o){function l(e,t){return function(){i&&i(t,arguments);var n=e[t].apply(e,arguments),a=o.getError();return 0!=a&&(c[a]=!0,r(a,t,arguments)),n}}o=o||t,e(t),r=r||function(e,t,r){for(var i="",o=r.length,s=0;s<o;++s)i+=(0==s?"":", ")+a(t,o,s,r[s]);M("WebGL error "+n(e)+" in "+t+"("+i+")")};var c={},h={};for(var d in t)if("function"==typeof t[d])if("getExtension"!=d)h[d]=l(t,d);else{var f=l(t,d);h[d]=function(){var e=f.apply(t,arguments);return u(e,r,i,o)}}else s(h,t,d);return h.getError=function(){for(var e in c)if(c.hasOwnProperty(e)&&c[e])return c[e]=!1,e;return t.NO_ERROR},h}function l(e){var t=e.getParameter(e.MAX_VERTEX_ATTRIBS),r=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,r);for(var i=0;i<t;++i)e.disableVertexAttribArray(i),e.vertexAttribPointer(i,4,e.FLOAT,!1,0,0),e.vertexAttrib1f(i,0);e.deleteBuffer(r);for(var n=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),i=0;i<n;++i)e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_CUBE_MAP,null),e.bindTexture(e.TEXTURE_2D,null);for(e.activeTexture(e.TEXTURE0),e.useProgram(null),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.DITHER),e.disable(e.SCISSOR_TEST),e.blendColor(0,0,0,0),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.clearColor(0,0,0,0),e.clearDepth(1),e.clearStencil(-1),e.colorMask(!0,!0,!0,!0),e.cullFace(e.BACK),e.depthFunc(e.LESS),e.depthMask(!0),e.depthRange(0,1),e.frontFace(e.CCW),e.hint(e.GENERATE_MIPMAP_HINT,e.DONT_CARE),e.lineWidth(1),e.pixelStorei(e.PACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.UNPACK_COLORSPACE_CONVERSION_WEBGL&&e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.BROWSER_DEFAULT_WEBGL),e.polygonOffset(0,0),e.sampleCoverage(1,!1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilMask(4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.viewport(0,0,e.canvas.width,e.canvas.height),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT);e.getError(););}function c(e){function t(e){return"function"==typeof e?e:function(t){e.handleEvent(t)}}function r(e){var t=e.addEventListener;e.addEventListener=function(r,i,n){switch(r){case"webglcontextlost":p(i);break;case"webglcontextrestored":w(i);break;default:t.apply(e,arguments)}}}function i(){for(var e=Object.keys(T),t=0;t<e.length;++t)delete T[e]}function n(){++v,g||L==v&&e.loseContext()}function a(e,t){var r=e[t];return function(){if(n(),!g){var t=r.apply(e,arguments);return t}}}function o(){for(var e=0;e<y.length;++e){var t=y[e];t instanceof WebGLBuffer?h.deleteBuffer(t):t instanceof WebGLFramebuffer?h.deleteFramebuffer(t):t instanceof WebGLProgram?h.deleteProgram(t):t instanceof WebGLRenderbuffer?h.deleteRenderbuffer(t):t instanceof WebGLShader?h.deleteShader(t):t instanceof WebGLTexture&&h.deleteTexture(t)}}function u(e){return{statusMessage:e,preventDefault:function(){I=!0}}}function c(e){for(var t in e)"function"==typeof e[t]?M[t]=a(e,t):s(M,e,t);M.getError=function(){if(n(),!g)for(var e;e=h.getError();)T[e]=!0;for(var e in T)if(T[e])return delete T[e],e;return M.NO_ERROR};for(var r=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"],i=0;i<r.length;++i){var o=r[i];M[o]=function(t){return function(){if(n(),g)return null;var r=t.apply(e,arguments);return r.__webglDebugContextLostId__=m,y.push(r),r}}(e[o])}for(var u=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"],i=0;i<u.length;++i){var o=u[i];M[o]=function(t){return function(){return n(),g?null:t.apply(e,arguments)}}(M[o])}for(var l=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"],i=0;i<l.length;++i){var o=l[i];M[o]=function(t){return function(){return n(),!g&&t.apply(e,arguments)}}(M[o])}return M.checkFramebufferStatus=function(t){return function(){return n(),g?M.FRAMEBUFFER_UNSUPPORTED:t.apply(e,arguments)}}(M.checkFramebufferStatus),M.getAttribLocation=function(t){return function(){return n(),g?-1:t.apply(e,arguments)}}(M.getAttribLocation),M.getVertexAttribOffset=function(t){return function(){return n(),g?0:t.apply(e,arguments)}}(M.getVertexAttribOffset),M.isContextLost=function(){return g},M}var h,M,d=[],f=[],M={},m=1,g=!1,y=[],L=0,v=0,I=!1,x=0,T={};e.getContext=function(t){return function(){var r=t.apply(e,arguments);if(r instanceof WebGLRenderingContext){if(r!=h){if(h)throw"got different context";h=r,M=c(h)}return M}return r}}(e.getContext);var p=function(e){d.push(t(e))},w=function(e){f.push(t(e))};return r(e),e.loseContext=function(){if(!g){for(g=!0,L=0,++m;h.getError(););i(),T[h.CONTEXT_LOST_WEBGL]=!0;var t=u("context lost"),r=d.slice();setTimeout(function(){for(var i=0;i<r.length;++i)r[i](t);x>=0&&setTimeout(function(){e.restoreContext()},x)},0)}},e.restoreContext=function(){g&&f.length&&setTimeout(function(){if(!I)throw"can not restore. webglcontestlost listener did not call event.preventDefault";o(),l(h),g=!1,v=0,I=!1;for(var e=f.slice(),t=u("context restored"),r=0;r<e.length;++r)e[r](t)},0)},e.loseContextInNCalls=function(e){if(g)throw"You can not ask a lost contet to be lost";L=v+e},e.getNumCalls=function(){return v},e.setRestoreTimeout=function(e){x=e},e}"undefined"==typeof window&&(window=t);var h=function(e){window.console&&window.console.log&&window.console.log(e)},M=function(e){window.console&&window.console.error?window.console.error(e):h(e)},d={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},f=null,m=null;return{init:e,mightBeEnum:i,glEnumToString:n,glFunctionArgToString:a,glFunctionArgsToString:o,makeDebugContext:u,makeLostContextSimulatingCanvas:c,resetToInitialState:l}}(),e.exports=WebGLDebugUtils}).call(t,function(){return this}())}]);